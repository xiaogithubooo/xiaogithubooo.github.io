<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="本资料库主要存储limou的个人学习知识文章">
<meta property="og:type" content="website">
<meta property="og:title" content="limou3434">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="limou3434">
<meta property="og:description" content="本资料库主要存储limou的个人学习知识文章">
<meta property="og:locale">
<meta property="article:author" content="limou">
<meta property="article:tag" content="C++">
<meta name="twitter:card" content="summary">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://example.com/"/>





  <title>limou3434</title>
  








<meta name="generator" content="Hexo 7.0.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">limou3434</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">个人学习资料库</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/%20" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/%20" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/12/01/002+limou+2023_07_27+C++%E7%B1%BB%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E8%BF%B0%EF%BC%88%E4%B8%8A%EF%BC%89/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="limou3434">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2023/12/01/002+limou+2023_07_27+C++%E7%B1%BB%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E8%BF%B0%EF%BC%88%E4%B8%8A%EF%BC%89/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2023-12-01T16:34:49+08:00">
                2023-12-01
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>[TOC]</p>
<h1 id="1-面向过程和对象"><a href="#1-面向过程和对象" class="headerlink" title="1.面向过程和对象"></a>1.面向过程和对象</h1><h2 id="1-1-面向过程"><a href="#1-1-面向过程" class="headerlink" title="1.1.面向过程"></a>1.1.面向过程</h2><p><code>C</code>语言就是一种面向过程的语言，如果您经常使用<code>C</code>解决问题，就会发现在编程的过程中我们非常注重细节和步骤，通过各种块级功能的函数调用逐步解决问题。</p>
<h2 id="1-2-面向对象"><a href="#1-2-面向对象" class="headerlink" title="1.2.面向对象"></a>1.2.面向对象</h2><p><code>C++</code>语言，是面向对象和面向过程的一种混编语言，在解决问题时，关注的是对象，将一件事情拆分为不同的对象，靠对象之间的交互完成。</p>
<blockquote>
<p>例子：我想煮饭，于是需要对象：我、电饭煲、菜，“我”把“菜”放入“电饭锅”，不需要了解我是通过哪一块肌肉放入菜，不需要了解菜是具有什么分子结构，不需要了解电饭煲的工作原理，煮饭都是靠“我”、“菜”、“电饭煲”三者（三个对象）交互完成的。</p>
</blockquote>
<h1 id="2-类的引入"><a href="#2-类的引入" class="headerlink" title="2.类的引入"></a>2.类的引入</h1><h2 id="2-1-类和结构"><a href="#2-1-类和结构" class="headerlink" title="2.1.类和结构"></a>2.1.类和结构</h2><p><code>C</code>语言的结构体只能定义变量，而结构体不仅可以定义变量，也可以定义函数。</p>
<p>但是对于结构体在内部加入函数的方式，<code>C++</code>更喜欢用<code>class</code>来代替<code>struct</code>。</p>
<p>使用<code>struct</code>是为了和<code>C</code>兼容使用。</p>
<h2 id="2-2-类的使用"><a href="#2-2-类的使用" class="headerlink" title="2.2.类的使用"></a>2.2.类的使用</h2><p>下面我们在<code>C++</code>代码中使用<code>struct</code>来定义一个基础的<code>C++</code>类&#x2F;结构体（在<code>C++</code>中结构体被升级了，不仅可以放入成员变量，还可以放入成员函数的定义或者声明）。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//类和对象的使用</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">str</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> a;</span><br><span class="line">    <span class="type">int</span> b;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">Xadd</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span><span class="comment">//C++的结构体是升级版本的结构体</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> a * x + b * y;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    str X;</span><br><span class="line">    X.a = <span class="number">2</span>;</span><br><span class="line">    X.b = <span class="number">5</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, X.<span class="built_in">Xadd</span>(<span class="number">1</span>, <span class="number">2</span>));<span class="comment">//调用成员变量或者成员函数，都可以使用“.”</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//而且C++的结构体名可以省略struct的写法</span></span><br></pre></td></tr></table></figure>

<p>在<code>C++</code>里最为标准的类的写法是使用<code>class</code>（也就是<code>struct</code>的升级版，功能更加强大，至于强大在哪里我们后续会提及）。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//类和对象的使用</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">str</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> a;</span><br><span class="line">    <span class="type">int</span> b;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">Xadd</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span><span class="comment">//C++的结构体是升级版本的结构体</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> a * x + b * y;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    str X;</span><br><span class="line">    X.a = <span class="number">2</span>;<span class="comment">//出错</span></span><br><span class="line">    X.b = <span class="number">5</span>;<span class="comment">//出错</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, X.<span class="built_in">Xadd</span>(<span class="number">1</span>, <span class="number">2</span>));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li><p><code>class</code>是定义类的关键字，后面跟着类的名字，即“类名”，<code>&#123;&#125;</code>中为类的成员</p>
</li>
<li><p>类中的变量称为类的属性（成员变量）</p>
</li>
<li><p>类中的函数称为类的方法（成员函数）</p>
</li>
</ol>
<p>但是这么写为什么没有办法运行呢？这是因为类还有三个限定符，分别是：<code>public</code>（公有）、<code>protected</code>（保护）、<code>private</code>（私有），在没有使用限定符的情况下，类默认其成员是私有的（不可以被外界访问），但是结构体默认其成员是公有的（这是为了兼容<code>C</code>的<code>struct</code>）。</p>
<p>在<code>C</code>中，<code>stack</code>结构体可以创建出一个结构体变量，<code>C++</code>的<code>class</code>类也同样可以，但是需要注意的是，由类创建出来的变量不是被称为“类变量”，而被称做“对象”。</p>
<p>通过对象可以像以前的结构体变量一样访问成员变量，甚至是调用成员函数（例如：上面<code>C++</code>代码中的<code>X.Xadd(1, 2)</code>就是通过<code>X</code>这个对象来调用成员函数<code>Xadd()</code>的）。</p>
<blockquote>
<p>补充：命名方法规范</p>
<p>在<code>C++</code>中，有一些常见的命名方法，我们整篇系列的命名以大小驼峰法来命名。</p>
<ol>
<li><p>函数名、类名大驼峰</p>
</li>
<li><p>普通变量小驼峰</p>
</li>
<li><p>成员变量首单词从<code>_</code>开始</p>
</li>
</ol>
</blockquote>
<h2 id="2-3-类限定符"><a href="#2-3-类限定符" class="headerlink" title="2.3.类限定符"></a>2.3.类限定符</h2><p>在了解类限定符之前，我们先来了解一下面向对象语言三大特性之一的“封装”。</p>
<h3 id="2-3-1-类封装的概念"><a href="#2-3-1-类封装的概念" class="headerlink" title="2.3.1.类封装的概念"></a>2.3.1.类封装的概念</h3><p>面向对象的三大特性：封装、继承、多态（这三个是最重要的，但是面向对象还有其他的特性，例如“抽象”）。封装的本质是以一种管理，封装将数据和操作数据的方法结合起来，隐藏对象的属性和实现细节，仅对外公开接口来和对象进行交互。</p>
<p>封装让用户更加方便使用类。而<code>C++</code>通过访问限定符来控制隐藏对象的细节，控制哪些方法可以在类外部直接使用。</p>
<h3 id="2-3-2-限定符的使用"><a href="#2-3-2-限定符的使用" class="headerlink" title="2.3.2.限定符的使用"></a>2.3.2.限定符的使用</h3><ol>
<li><p><code>public</code>（公有），<code>public</code>修饰的成员在类外可以直接被访问</p>
</li>
<li><p><code>protected</code>（保护），<code>protected</code>和<code>private</code>修饰的成员在类外不能直接被访问（此处<code>protected</code>和<code>private</code>是类似的）</p>
</li>
<li><p><code>private</code>（私有），<code>protected</code>和<code>private</code>修饰的成员在类外不能直接被访问（此处<code>protected</code>和<code>private</code>是类似的）</p>
</li>
</ol>
<blockquote>
<p>补充：</p>
<p><code>public</code>成员在类内外均可访问，<code>protected</code>成员只能在类内和派生类中访问，而<code>private</code>成员仅能在类内访问。<br>三个关键字的范围是从使用访问限定符开始，直到遇到另外一个访问限定符这类的<code>&#125;</code>结尾时结束。<br><code>protected</code>和<code>private</code>在后面讲到继承的时候才能进一步做区分。</p>
</blockquote>
<p>而访问限定符的作用范围从该访问限定符出现的位置开始直到下一个访问限定符出现为止。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//类和对象的使用</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">str</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">int</span> a;</span><br><span class="line">    <span class="type">int</span> b;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">Xadd</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span><span class="comment">//C++的结构体是升级版本的结构体</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        a = <span class="number">2</span>;</span><br><span class="line">        b = <span class="number">5</span>;</span><br><span class="line">        <span class="keyword">return</span> a * x + b * y;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    str X;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, X.<span class="built_in">Xadd</span>(<span class="number">1</span>, <span class="number">2</span>));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意：访问限定符只有在编译时有用，当数据映射到内存后，没有任何访问限定符上的区别。</p>
</blockquote>
<p>在没有见到继承等概念之前，我们的<code>C++</code>程序会出现大量的<code>public</code>和<code>private</code>这两个限定符，您只需要重点了解这两个就行。</p>
<h2 id="2-4-类作用域"><a href="#2-4-类作用域" class="headerlink" title="2.4.类作用域"></a>2.4.类作用域</h2><p>类的出现赋予了<code>C++</code>一个新得作用域：类的作用域，即“类域”。</p>
<ol>
<li><p>在类的里面，类的所有成员都在类的作用域中</p>
</li>
<li><p>在类外面定义成员时，需要使用<code>::</code>作用域操作符来指明</p>
</li>
</ol>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">PrintPersonInfo</span><span class="params">()</span></span>;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">char</span> _name[<span class="number">20</span>];</span><br><span class="line">    <span class="type">char</span> _gender[<span class="number">3</span>];</span><br><span class="line">    <span class="type">int</span>  _age;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//这里需要指定PrintPersonInfo是属于Person这个类域</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Person::PrintPersonInfo</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cout &lt;&lt; _name &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; _gender &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; _age &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>需要注意的是，哪怕有访问限定符，只要使用的是同属一个类内的函数或遍历，就不受限定符的影响。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">f1</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        _a = x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">f2</span><span class="params">(A x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        cout &lt;&lt; x._a &lt;&lt; endl;<span class="comment">//这里没有报错，说明同类的使用是不会被访问限定符限定的</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Prin</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        cout &lt;&lt; _a &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">int</span> _a;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    A x;</span><br><span class="line">    A y;</span><br><span class="line">    x.<span class="built_in">f1</span>(<span class="number">2</span>);</span><br><span class="line">    y.<span class="built_in">f1</span>(<span class="number">3</span>);</span><br><span class="line">    x.<span class="built_in">Prin</span>();</span><br><span class="line">    y.<span class="built_in">Prin</span>();</span><br><span class="line">    y.<span class="built_in">f2</span>(x);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>并且编译器在类里面会上下搜索，不是按照向上查找的方式编译代码。</p>
<h2 id="2-5-类的定义"><a href="#2-5-类的定义" class="headerlink" title="2.5.类的定义"></a>2.5.类的定义</h2><h3 id="2-5-1-类中定义函数"><a href="#2-5-1-类中定义函数" class="headerlink" title="2.5.1.类中定义函数"></a>2.5.1.类中定义函数</h3><p>声明放在类中，定义也放在类中。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> 类名</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">//某些方法（包括声明和定义）</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">//某些属性</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>需要注意的是，如果成员函数在类中直接定义，编译器可能当成内联函数处理。因此可以利用这一点，较小的函数若要做内联，则直接写到类内部。</p>
<h3 id="2-5-2-类外定义函数"><a href="#2-5-2-类外定义函数" class="headerlink" title="2.5.2.类外定义函数"></a>2.5.2.类外定义函数</h3><p>声明放在类中，定义放在类外。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//类头文件class.h中</span></span><br><span class="line"><span class="keyword">class</span> 类名</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">//某些方法基本信息（函数声明）</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">//某些属性</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//类源文件class.c中</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;class.h&quot;</span> </span></span><br><span class="line">函数返回值 类名::函数名字() </span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//某些方法定义（函数方法） </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>一般来说后者会比较规范一些（就是需要注意一些语法细节），但为了更加好演示代码，后续的文章大部分采用第一种，正式工作时能用第二种就用第二种。</p>
<p>而且可以尝试区分好方法名字和属性名字，比如在属性（类里的成员变量）前加上下划线<code>_</code>、函数名&#x2F;类名采用大驼峰命名、变量名采用小驼峰命名。</p>
<h2 id="2-6-类实例化"><a href="#2-6-类实例化" class="headerlink" title="2.6.类实例化"></a>2.6.类实例化</h2><p>使用类创建对象的过程，被称为类的实例化。简单来说：类只是一份构建对象的图纸，在创建对象的时候，编译器会根据对象对应的类结构来给对象开辟应有的空间，这个过程就是“实例化”。</p>
<ol>
<li><p>类是给对象（您可以理解为一个结构体&#x2F;类创建出来的一个变量）进行描述，是对象的一个模板，限定了类有哪些成员，定义出一个类并没有分配实际的内存空间来存储它（也就是说类的成员可以说是一种类似“声明”的存在，而不是定义）</p>
</li>
<li><p>类可以实例化（也就是类的定义）出多个对象来，实例化出的对象会占有实际的物理空间，也就是定义</p>
</li>
</ol>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//错误做法</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">PrintPersonInfo</span><span class="params">()</span></span>;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">char</span> _name[<span class="number">20</span>];</span><br><span class="line">    <span class="type">char</span> _gender[<span class="number">3</span>];</span><br><span class="line">    <span class="type">int</span>  _age;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Person::PrintPersonInfo</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cout &lt;&lt; _name &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; _gender &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; _age &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Person._age = <span class="number">10</span>;   <span class="comment">// 编译失败：error C2059: 语法错误:“.”，因为没有对</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//正确做法</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">PrintPersonInfo</span><span class="params">()</span></span>;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="type">char</span>* _name;</span><br><span class="line">    <span class="type">char</span>* _sex;</span><br><span class="line">    <span class="type">int</span> _age;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Person::PrintPersonInfo</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cout &lt;&lt; _name &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; _sex &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; _age &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Person man;</span><br><span class="line">    man._name = (<span class="type">char</span>*)<span class="string">&quot;limou3434&quot;</span>;<span class="comment">//由于C++类型检查比较严格，故加上强制转化</span></span><br><span class="line">    man._age = <span class="number">10</span>;</span><br><span class="line">    man._sex = (<span class="type">char</span>*)<span class="string">&quot;男&quot;</span>;<span class="comment">//由于C++类型检查比较严格，故加上强制转化</span></span><br><span class="line">    man.<span class="built_in">PrintPersonInfo</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2-7-对象大小"><a href="#2-7-对象大小" class="headerlink" title="2.7.对象大小"></a>2.7.对象大小</h2><p>如果一个类中既有成员变量又有成员函数，那么这个根据类结构创建出来的对象的大小是多少呢？需要加上成员函数的大小吗？</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 类中既有成员变量，又有成员函数</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A1</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">f1</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">int</span> _a;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 类中仅有成员函数</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A2</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">   <span class="function"><span class="type">void</span> <span class="title">f2</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 类中什么都没有---空类</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A3</span></span><br><span class="line">&#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//结果为4 1 1</span></span><br></pre></td></tr></table></figure>

<p>实际就是该类中“成员变量”之和，不过要注意内存对齐的问题！这点和结构体内存对齐是一样的…因此我们可以观察到：对象在计算大小中是不算上成员函数的。</p>
<p>为什么不带上成员函数的大小呢？不带上的话，函数需要的空间又应该保存在哪里呢？让我们假设下面三种情况：</p>
<ol>
<li><p>对象存储方法一：存储“类函数+类成员变量”假设大小含有成员函数，那么每次都实例化一个类生成一个对象时，就会重复多出函数的栈帧空间，浪费空间</p>
</li>
<li><p>对象存储方法二：存储“类函数表地址+类成员变量”，其中类函数表地址指向一个类函数表（这在虚表和多态被采用），这种方案不错，但是<code>C++</code>没有采用这种</p>
</li>
<li><p>对象存储方法三：只保存成员变量，成员函数存放在公共的代码段。编译链接的时候就会根据函数名去公共代码区找到函数的地址（类似<code>a.Function()</code>时，汇编的时候会使用<code>call</code>指令去替换，即：<code>call</code>函数地址），这是<code>C++</code>所采用的</p>
</li>
</ol>
<blockquote>
<p>注意：类成员函数表（<code>Class Member Function Table</code>）和公共代码区域（<code>Common Code Area</code>）是两个不同的概念。</p>
<ol>
<li><p>类成员函数表：类成员函数表是用于存储与类相关的成员函数指针的数据结构。每当创建一个类的对象时，都会为该类分配一个内存空间，并在内存中创建一个类成员函数表。类成员函数表中的每个条目都保存着对应成员函数的地址。通过类成员函数表，可以在运行时动态地调用类的成员函数。这种机制称为虚函数表（<code>VTable</code>）或虚函数指针表（<code>VPointer Table</code>），它支持面向对象编程中的多态性。</p>
</li>
<li><p>公共代码区域：公共代码区域是指程序中多个模块（例如函数、方法或类）之间共享的代码部分。当多个模块需要访问相同的功能或过程时，它们可以共享一段代码，而不是复制相同的代码到每个模块中。这样做可以减少冗余，并提高代码的重用性和可维护性。公共代码区域通常位于内存的某个特定位置，所有需要访问这些公共代码的模块都可以通过指针或跳转进行调用。</p>
</li>
</ol>
<p>总结起来，类成员函数表是一个与类相关的数据结构，用于支持多态调用类的成员函数。而公共代码区域则是指多个模块之间共享的代码部分，可以提高代码的重用性和可维护性。两者是面向对象编程和模块化设计中不同概念的体现。</p>
</blockquote>
<p>使用下面代码也能证明：函数没有在类中存储。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">public:</span><br><span class="line">    <span class="type">int</span> i;</span><br><span class="line">    <span class="type">int</span> j;</span><br><span class="line">public:</span><br><span class="line">    <span class="type">void</span> <span class="title function_">Print</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">void</span> <span class="title function_">A::Print</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Helow word!\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    A* ptr = nullptr;</span><br><span class="line">    ptr-&gt;Print();<span class="comment">//正常运行，因为这里不是真正的解引用，原因是function()函数没有真正放在类中，而是放在了公共代码区，这里只是单纯的调用罢了</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>另外这里需要注意空类（没有任何成员函数和成员变量的类）的大小，空类比较特殊，<code>C++</code>规定空类使用一个字节大小的空间来唯一标识这个类的对象，只做占位使用，内部不存储实际数据。<br>为什么说是做标记使用呢？因为如果开辟<code>0</code>字节，那就没有指针可以指向这个空间了，下面两个对象就无法做出区分：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Data</span></span><br><span class="line">&#123;&#125;;<span class="comment">//空类</span></span><br><span class="line">Data d1;<span class="comment">//空类创建出来的成员1</span></span><br><span class="line">Data d2;<span class="comment">//空类创建出来的成员2</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%zd&quot;</span>, <span class="built_in">sizeof</span>(Data));<span class="comment">//输出1</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%p&quot;</span>, &amp;d1);<span class="comment">//d1和d2存储在两个地方</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%p&quot;</span>, &amp;d2);</span><br></pre></td></tr></table></figure>

<h1 id="3-this指针"><a href="#3-this指针" class="headerlink" title="3.this指针"></a>3.this指针</h1><p>我们之前说过，类是创建对象的一个“模板”，但是在类中存在成员函数，并且我们通过对象来调用成员函数的时候，有一个很奇怪的现象。</p>
<h2 id="3-1-隐藏this指针"><a href="#3-1-隐藏this指针" class="headerlink" title="3.1.隐藏this指针"></a>3.1.隐藏this指针</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Data</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Init</span><span class="params">(<span class="type">int</span> year, <span class="type">int</span> month, <span class="type">int</span> day)</span><span class="comment">//3.但是函数是怎么找到实例化后，变量里的_year呢？其实就是在这里的参数列表隐藏了一个this指针（每一个成员函数都有）完整写法为：void Init(Date* const this, int year, int month, int day)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        _year = year;<span class="comment">//2.而这里的year值并不是赋给了类里的_year，而是实例化后对象d里的_year，这句话的完整写法为：this-&gt;_year = year;</span></span><br><span class="line">        _month = month;<span class="comment">//这句话的完整写法为：this-&gt;_month= month;</span></span><br><span class="line">        _day = day;<span class="comment">//这句话的完整写法为：this-&gt;_day= day;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Print</span><span class="params">(<span class="type">void</span>)</span></span>;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">int</span> _year;<span class="comment">//1.没有经过实例化的类，因此这里的_year只是声明</span></span><br><span class="line">    <span class="type">int</span> _month;</span><br><span class="line">    <span class="type">int</span> _day;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Data::Print</span><span class="params">(<span class="type">void</span>)</span><span class="comment">//这里没有添加this指针</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cout &lt;&lt; _year &lt;&lt; <span class="string">&quot;-&quot;</span> &lt;&lt; _month &lt;&lt; <span class="string">&quot;-&quot;</span> &lt;&lt; _day &lt;&lt; endl;<span class="comment">//这个函数到底打印的是哪一个对象的成员变量？？？</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Data d;</span><br><span class="line">    d.<span class="built_in">Init</span>(<span class="number">2023</span>, <span class="number">6</span>, <span class="number">8</span>);</span><br><span class="line">    d.<span class="built_in">Print</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>this</code>指针参数由编译器帮我们加上，在对象<code>d</code>调用函数<code>Init()</code>的时候，函数参数内部隐含一个<code>this</code>指针参数，指向对象<code>d</code>，确保初始化的对象是<code>d</code>的成员变量。</p>
<p>但是在类外定义的函数不会自动添加<code>this</code>指针，因此调用<code>Print()</code>函数的时候，函数的参数列表内部没有隐藏的<code>this</code>指针，因此不知道指向哪一个对象，这样在打印成员变量的时候，该函数就会失败。</p>
<p>下面为了方便理解，我们把编译器的活也给补上（注意下面的代码是运行不起来的，只是我们演示了在编译器视角是怎么工作的）</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">class Data</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">public:</span></span><br><span class="line"><span class="comment">    void Init(Date* const this, int year, int month, int day)</span></span><br><span class="line"><span class="comment">    &#123;</span></span><br><span class="line"><span class="comment">        this-&gt;_year = year;</span></span><br><span class="line"><span class="comment">        this-&gt;_month = month;</span></span><br><span class="line"><span class="comment">        this-&gt;_day = day;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    void Print();</span></span><br><span class="line"><span class="comment">private:</span></span><br><span class="line"><span class="comment">    int _year;</span></span><br><span class="line"><span class="comment">    int _month;</span></span><br><span class="line"><span class="comment">    int _day;</span></span><br><span class="line"><span class="comment">&#125;;</span></span><br><span class="line"><span class="comment">void Data::Print()</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">    cout &lt;&lt; _year &lt;&lt; &quot;-&quot; &lt;&lt; _month &lt;&lt; &quot;-&quot; &lt;&lt; _day &lt;&lt; endl;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">int main()</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">    Data d;</span></span><br><span class="line"><span class="comment">    d.Init(&amp;d1, 2023, 6, 8);</span></span><br><span class="line"><span class="comment">    d.Print(&amp;d1);</span></span><br><span class="line"><span class="comment">    return 0;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<h2 id="3-2-显示this指针"><a href="#3-2-显示this指针" class="headerlink" title="3.2.显示this指针"></a>3.2.显示this指针</h2><p><code>this</code>指针我们不能手动加到函数参数列表，或者函数调用中（即：不能显示接受和显示传递<code>this</code>指针），这是编译器在做的事情，编译器会帮您自动加上。</p>
<p>但是有一个例外：您可以在函数内部使用<code>this</code>指针，这点<code>C++</code>没做太多限制，唯一需要的是由于<code>this</code>指针参数的类型是<code>类类型 const*</code>，因此没有办法使用解引用改变<code>this</code>指向对象的值。</p>
<p>这种情况经常出现在类外部定义的函数，由于声明在类内部，因此已经添加了<code>this</code>指针，定义处的参数列表也不需要再声明有一个<code>this</code>指针的存在，但是函数定义内的函数体没有自动添加<code>this</code>指针，需要我们手动加上。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Data</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Init</span><span class="params">(<span class="type">int</span> year, <span class="type">int</span> month, <span class="type">int</span> day)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;_year = year;</span><br><span class="line">        <span class="keyword">this</span>-&gt;_month = month;</span><br><span class="line">        <span class="keyword">this</span>-&gt;_day = day;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Print</span><span class="params">()</span></span>;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">int</span> _year;</span><br><span class="line">    <span class="type">int</span> _month;</span><br><span class="line">    <span class="type">int</span> _day;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Data::Print</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cout &lt;&lt; <span class="keyword">this</span>-&gt;_year &lt;&lt; <span class="string">&quot;-&quot;</span> &lt;&lt; <span class="keyword">this</span>-&gt;_month &lt;&lt; <span class="string">&quot;-&quot;</span> &lt;&lt; <span class="keyword">this</span>-&gt;_day &lt;&lt; endl;<span class="comment">//手动调用，这里的this是我们自己写出来的，不是编译器加上来的</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Data d;</span><br><span class="line">    d.<span class="built_in">Init</span>(<span class="number">2023</span>, <span class="number">6</span>, <span class="number">8</span>);</span><br><span class="line">    d.<span class="built_in">Print</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="3-3-this指针的特性"><a href="#3-3-this指针的特性" class="headerlink" title="3.3.this指针的特性"></a>3.3.this指针的特性</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Cl</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="type">int</span> x;</span><br><span class="line">    <span class="type">int</span> y;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Print</span><span class="params">()</span><span class="comment">//2.程序来到这里后，这里的函数头等价于“Print(Cl* const this)”</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        cout &lt;&lt; x &lt;&lt; endl;<span class="comment">//3.上面这一句展开来写就是“cout &lt;&lt; this-&gt;x &lt;&lt; endl;”这个时候就发生空指针解引用了，程序就会发生奔溃</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Cl* C = <span class="literal">nullptr</span>;</span><br><span class="line">    C-&gt;<span class="built_in">Print</span>();<span class="comment">//1.这里展开写就是“C-&gt;Print(C);”，这个函数被call的地址在编译的时候就被写入了，故正常调用（函数的地址并没有被存在对象里面，这里的解引用是“假象”）</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>另外，这个<code>this</code>指针补全了就是<code>类类型* const this</code>，这里的<code>const</code>只是避免了改变<code>this</code>的值，但是没有避免改变<code>*this</code>（也就是对象本身）的值，但是有的时候我们不希望<code>this</code>在编写代码的过程中不小心改变<code>this</code>指向对象的值，但是如果我们希望再加一个<code>const</code>（也就是成为<code>类类型* const this</code>）来避免<code>this</code>改变指向怎么办呢？这个<code>this</code>指针被编译器隐藏起来了呀！</p>
<p>因此我们可以直接在调用了<code>this</code>指针的函数签名的最后面加上<code>const</code>关键字，因此如果是上面的<code>void Print()</code>，在声明处可以改写成<code>void Print() const</code>，而在函数定义处也需要这么更改。</p>
<p>这种现象在本文的末尾我们还会再次提到。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Data</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Init</span><span class="params">(<span class="type">int</span> year, <span class="type">int</span> month, <span class="type">int</span> day)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;_year = year;</span><br><span class="line">        <span class="keyword">this</span>-&gt;_month = month;</span><br><span class="line">        <span class="keyword">this</span>-&gt;_day = day;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Print</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">int</span> _year;</span><br><span class="line">    <span class="type">int</span> _month;</span><br><span class="line">    <span class="type">int</span> _day;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Data::Print</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cout &lt;&lt; <span class="keyword">this</span>-&gt;_year &lt;&lt; <span class="string">&quot;-&quot;</span> &lt;&lt; <span class="keyword">this</span>-&gt;_month &lt;&lt; <span class="string">&quot;-&quot;</span> &lt;&lt; <span class="keyword">this</span>-&gt;_day &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Data d;</span><br><span class="line">    d.<span class="built_in">Init</span>(<span class="number">2023</span>, <span class="number">6</span>, <span class="number">8</span>);</span><br><span class="line">    d.<span class="built_in">Print</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="3-4-this指针的位置"><a href="#3-4-this指针的位置" class="headerlink" title="3.4.this指针的位置"></a>3.4.this指针的位置</h2><p>那么<code>this</code>指针应该存储到哪里去呢？存储到栈的区域，因为<code>this</code>本质还是一个形参，存储在栈上。但是这是不一定的，有的编译器会进行优化，比如：<code>VS2022</code>一般会采用寄存器<code>ecx</code>去优化代码，这点可以查看反汇编看看即可。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Cl</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="type">int</span> x;</span><br><span class="line">    <span class="type">int</span> y;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Print</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"><span class="number">00007F</span>F7B09420C0  mov         qword ptr [rsp+<span class="number">8</span>],rcx  </span><br><span class="line"><span class="number">00007F</span>F7B09420C5  push        rbp  </span><br><span class="line"><span class="number">00007F</span>F7B09420C6  push        rdi  </span><br><span class="line"><span class="number">00007F</span>F7B09420C7  sub         rsp,<span class="number">0E8</span>h  </span><br><span class="line"><span class="number">00007F</span>F7B09420CE  lea         rbp,[rsp+<span class="number">20</span>h]  </span><br><span class="line"><span class="number">00007F</span>F7B09420D3  lea         rcx,[__E91ADDBE_main@<span class="built_in">cpp</span> (<span class="number">07F</span>F7B09540E3h)]  </span><br><span class="line"><span class="number">00007F</span>F7B09420DA  call        __CheckForDebuggerJustMyCode (<span class="number">07F</span>F7B09413FCh)  </span><br><span class="line">        cout &lt;&lt; x &lt;&lt; endl;</span><br><span class="line"><span class="number">00007F</span>F7B09420DF  mov         rax,qword ptr [<span class="keyword">this</span>]  </span><br><span class="line"><span class="number">00007F</span>F7B09420E6  mov         edx,dword ptr [rax]  </span><br><span class="line"><span class="number">00007F</span>F7B09420E8  mov         rcx,qword ptr [__imp_std::<span class="built_in">cout</span> (<span class="number">07F</span>F7B0952190h)]  </span><br><span class="line"><span class="number">00007F</span>F7B09420EF  call        qword ptr [__imp_std::basic_ostream&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt; &gt;::<span class="keyword">operator</span>&lt;&lt; (<span class="number">07F</span>F7B0952168h)]  </span><br><span class="line"><span class="number">00007F</span>F7B09420F5  lea         rdx,[std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt; &gt; (<span class="number">07F</span>F7B094103Ch)]  </span><br><span class="line"><span class="number">00007F</span>F7B09420FC  mov         rcx,rax  </span><br><span class="line"><span class="number">00007F</span>F7B09420FF  call        qword ptr [__imp_std::basic_ostream&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt; &gt;::<span class="keyword">operator</span>&lt;&lt; (<span class="number">07F</span>F7B0952170h)]  </span><br><span class="line">    &#125;</span><br><span class="line"><span class="number">00007F</span>F7B0942105  lea         rsp,[rbp+<span class="number">0</span>C8h]  </span><br><span class="line"><span class="number">00007F</span>F7B094210C  pop         rdi  </span><br><span class="line"><span class="number">00007F</span>F7B094210D  pop         rbp  </span><br><span class="line"><span class="number">00007F</span>F7B094210E  ret </span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="number">00007F</span>F7B0942150  push        rbp  </span><br><span class="line"><span class="number">00007F</span>F7B0942152  push        rdi  </span><br><span class="line"><span class="number">00007F</span>F7B0942153  sub         rsp,<span class="number">108</span>h  </span><br><span class="line"><span class="number">00007F</span>F7B094215A  lea         rbp,[rsp+<span class="number">20</span>h]  </span><br><span class="line"><span class="number">00007F</span>F7B094215F  lea         rdi,[rsp+<span class="number">20</span>h]  </span><br><span class="line"><span class="number">00007F</span>F7B0942164  mov         ecx,<span class="number">0</span>Ah  </span><br><span class="line"><span class="number">00007F</span>F7B0942169  mov         eax,<span class="number">0</span>CCCCCCCCh  </span><br><span class="line"><span class="number">00007F</span>F7B094216E  rep stos    dword ptr [rdi]  </span><br><span class="line"><span class="number">00007F</span>F7B0942170  mov         rax,qword ptr [__security_cookie (<span class="number">07F</span>F7B094E018h)]  </span><br><span class="line"><span class="number">00007F</span>F7B0942177  <span class="keyword">xor</span>         rax,rbp  </span><br><span class="line"><span class="number">00007F</span>F7B094217A  mov         qword ptr [rbp+<span class="number">0</span>D8h],rax  </span><br><span class="line"><span class="number">00007F</span>F7B0942181  lea         rcx,[__E91ADDBE_main@<span class="built_in">cpp</span> (<span class="number">07F</span>F7B09540E3h)]  </span><br><span class="line"><span class="number">00007F</span>F7B0942188  call        __CheckForDebuggerJustMyCode (<span class="number">07F</span>F7B09413FCh)  </span><br><span class="line">        Cl C;</span><br><span class="line">        C.x = C.y = <span class="number">10</span>;</span><br><span class="line"><span class="number">00007F</span>F7B094218D  mov         dword ptr [rbp+<span class="number">0</span>Ch],<span class="number">0</span>Ah  </span><br><span class="line"><span class="number">00007F</span>F7B0942194  mov         eax,dword ptr [rbp+<span class="number">0</span>Ch]  </span><br><span class="line"><span class="number">00007F</span>F7B0942197  mov         dword ptr [C],eax  </span><br><span class="line">        C.<span class="built_in">Print</span>();</span><br><span class="line"><span class="number">00007F</span>F7B094219A  lea         rcx,[C]  </span><br><span class="line"><span class="number">00007F</span><span class="function">F7B094219E  call        <span class="title">Cl::Print</span> <span class="params">(<span class="number">07F</span>F7B0941474h)</span>  </span></span><br><span class="line"><span class="function">        <span class="keyword">return</span> 0</span>;</span><br><span class="line"><span class="number">00007F</span>F7B09421A3  <span class="keyword">xor</span>         eax,eax  </span><br><span class="line">&#125;</span><br><span class="line"><span class="number">00007F</span>F7B09421A5  mov         edi,eax  </span><br><span class="line"><span class="number">00007F</span>F7B09421A7  lea         rcx,[rbp<span class="number">-20</span>h]  </span><br><span class="line"><span class="number">00007F</span>F7B09421AB  lea         rdx,[string <span class="string">&quot;%d\n&quot;</span>+<span class="number">58</span>h (<span class="number">07F</span>F7B094AC80h)]  </span><br><span class="line"><span class="number">00007F</span>F7B09421B2  call        _RTC_CheckStackVars (<span class="number">07F</span>F7B0941384h)  </span><br><span class="line"><span class="number">00007F</span>F7B09421B7  mov         eax,edi  </span><br><span class="line"><span class="number">00007F</span>F7B09421B9  mov         rcx,qword ptr [rbp+<span class="number">0</span>D8h]  </span><br><span class="line"><span class="number">00007F</span>F7B09421C0  <span class="keyword">xor</span>         rcx,rbp  </span><br><span class="line"><span class="number">00007F</span>F7B09421C3  call        __security_check_cookie (<span class="number">07F</span>F7B0941208h)  </span><br><span class="line"><span class="number">00007F</span>F7B09421C8  lea         rsp,[rbp+<span class="number">0E8</span>h]  </span><br><span class="line"><span class="number">00007F</span>F7B09421CF  pop         rdi  </span><br><span class="line"><span class="number">00007F</span>F7B09421D0  pop         rbp  </span><br><span class="line"><span class="number">00007F</span>F7B09421D1  ret  </span><br></pre></td></tr></table></figure>

<h1 id="4-类的默认成员函数"><a href="#4-类的默认成员函数" class="headerlink" title="4.类的默认成员函数"></a>4.类的默认成员函数</h1><p>实际上，一个空类并不是真的“空”，编译器还会自动生成<code>6</code>个默认成员函数（默认成员函数是用户没有显式实现的。编译器会自动生成的成员函数称为默认&#x2F;缺省成员函数）</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ClassName</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//某些成员</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<ol>
<li><p>初始化和清理：构造函数完成初始化、析构函数完成清理</p>
</li>
<li><p>拷贝复制：拷贝构造函数使用同类对象初始化创建对象、赋值重载函数主要是把一个对象赋值给另外一个对象</p>
</li>
<li><p>取地址重载：主要是重载“普通对象”和“<code>const</code>对象”取地址，这两个很少会自己实现，目前还不太重要（有机会再细谈）</p>
</li>
</ol>
<h2 id="4-1-初始化和清理"><a href="#4-1-初始化和清理" class="headerlink" title="4.1.初始化和清理"></a>4.1.初始化和清理</h2><h3 id="4-1-1-构造函数"><a href="#4-1-1-构造函数" class="headerlink" title="4.1.1.构造函数"></a>4.1.1.构造函数</h3><p>构造函数是类里特殊的成员函数，虽然叫“构造”，但是它的工作不是开辟空间，而是在构造对象的时候自动被调用，进行对象的初始赋值工作（构造函数这个名字其实起得不够好，容易引发误会）。</p>
<p>构造函数可以帮助我们给与对象的成员变量初始赋值，而不至于因为忘记初始赋值变量而得到随机值或者崩溃的结果。</p>
<p>由于这个函数很特殊，所以在理解的时候可以特殊化理解，在调用的时候也要特殊使用。</p>
<blockquote>
<p>注意：这里说的是初始值赋值，而不是初始化！</p>
<p>原因是初始化只有一次，但是赋值可以多次，构造函数的作用类似于帮助我们在定义<code>int a</code>之后，编译器进行了<code>a=初始值</code>的功能。而不是实现了在定义<code>a</code>的同时初始化<code>a</code>，即<code>int a = 初始值</code>。这两种方式是完全不一样的，而这一点我们将在初始化列表的时候再次提及，这里学习构造函数的时候您只需要知道如何使用即可。</p>
</blockquote>
<p>构造函数的特征如下：</p>
<ol>
<li>函数名和类相同</li>
<li>没有返回值，也不用写<code>void</code>（这里的没有返回值不是返回空（<code>void</code>），而是根本就没有返回值这一说法，构造函数只需要做到初始化即可，因此我们说它是个特殊的函数）</li>
<li>对象实例化时编译器自动调用对应的构造函数，如果没有显示定义，编译器会生成默认的无参数构造函数，因此哪怕没写也会被调用</li>
<li>构造函数可以被重载</li>
</ol>
<p>接下来我们试着来写一下构造函数：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//没有构造函数的情况</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Date</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Init</span><span class="params">(<span class="type">int</span> year, <span class="type">int</span> month, <span class="type">int</span> day)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        _year = year;</span><br><span class="line">        _month = month;</span><br><span class="line">        _day = day;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Print</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        cout &lt;&lt; _year &lt;&lt; <span class="string">&quot;-&quot;</span> &lt;&lt; _month &lt;&lt; <span class="string">&quot;-&quot;</span> &lt;&lt; _day &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">int</span> _year;</span><br><span class="line">    <span class="type">int</span> _month;</span><br><span class="line">    <span class="type">int</span> _day;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Date d1;<span class="comment">//创建一个d1结构体变量</span></span><br><span class="line">    d1.<span class="built_in">Init</span>(<span class="number">2022</span>, <span class="number">7</span>, <span class="number">5</span>);</span><br><span class="line">    d1.<span class="built_in">Print</span>();</span><br><span class="line"></span><br><span class="line">    Date d2;<span class="comment">//创建一个d2结构体变量</span></span><br><span class="line">    d2.<span class="built_in">Init</span>(<span class="number">2022</span>, <span class="number">7</span>, <span class="number">6</span>);</span><br><span class="line">    d2.<span class="built_in">Print</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//使用构造函数的情况</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Date</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Date</span>()</span><br><span class="line">    &#123;</span><br><span class="line">        _year = <span class="number">2023</span>;</span><br><span class="line">        _month = <span class="number">6</span>;</span><br><span class="line">        _day = <span class="number">8</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Print</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        cout &lt;&lt; _year &lt;&lt; <span class="string">&quot;-&quot;</span> &lt;&lt; _month &lt;&lt; <span class="string">&quot;-&quot;</span> &lt;&lt; _day &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">int</span> _year;</span><br><span class="line">    <span class="type">int</span> _month;</span><br><span class="line">    <span class="type">int</span> _day;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Date d1;<span class="comment">//创建一个d1结构体变量</span></span><br><span class="line">    d1.<span class="built_in">Print</span>();<span class="comment">//自动调用构造函数</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>因此光是这个自动初始化，在<code>C++</code>中就能省略很多代码，还可以使用缺省值加强构造函数。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//全缺省的构造函数（更加好用）</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Date</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Date</span>(<span class="type">int</span> year = <span class="number">2000</span>, <span class="type">int</span> month = <span class="number">1</span>, <span class="type">int</span> day = <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        _year = year;</span><br><span class="line">        _month = month;</span><br><span class="line">        _day = day;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Print</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        cout &lt;&lt; _year &lt;&lt; <span class="string">&quot;-&quot;</span> &lt;&lt; _month &lt;&lt; <span class="string">&quot;-&quot;</span> &lt;&lt; _day &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">int</span> _year;</span><br><span class="line">    <span class="type">int</span> _month;</span><br><span class="line">    <span class="type">int</span> _day;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">Date <span class="title">d1</span><span class="params">(<span class="number">2022</span>)</span></span>;</span><br><span class="line">    d1.<span class="built_in">Print</span>();</span><br><span class="line">    <span class="function">Date <span class="title">d2</span><span class="params">(<span class="number">2023</span>, <span class="number">7</span>)</span></span>;</span><br><span class="line">    d2.<span class="built_in">Print</span>();</span><br><span class="line">    <span class="function">Date <span class="title">d3</span><span class="params">(<span class="number">2002</span>, <span class="number">9</span>, <span class="number">8</span>)</span></span>;</span><br><span class="line">    d3.<span class="built_in">Print</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果没有显示定义构造函数，编译器就会自动生成一个无参的构造函数，如果有显示定义构造函数，编译器则不会自动生成。</p>
<p>但是如果编译器自动生成的构造函数，真的会帮助我们初始化吗？答案是：在默认生成的构造函数中：</p>
<ol>
<li><p>对内置类型成员（例如char、int、以及所有的指针类型等）不做初始化处理（可能有的编译器会做好处理，但是<code>C++</code>没有规定）</p>
</li>
<li><p>但是自定义类型成员（例如类类型）会回去调用自定义类型成员变量自己的默认构造函数（但是这种构造函数必须是全缺省或无参的，以及编译器默认生成的，有参数的构造函数是不算入默认构造函数的）。</p>
</li>
</ol>
<p>不对内置类型初始化可以说是<code>C++</code>早期设计的一个缺陷，当然有的新编译器对这些进行了处理，但是我们不能太依赖编译器的优化。</p>
<p>但是在<code>C++ 11</code>的时候打了一个补丁，可以通过给类内置类型成员变量设置缺省值来实现初始化，注意：是初始化，不是初始赋值。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//默认构造函数对内置类型不起作用</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Cl</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Cl</span>(<span class="type">int</span> x = <span class="number">1</span>)<span class="comment">//C1类创建对象时使用的默认构造函数</span></span><br><span class="line">    &#123;</span><br><span class="line">        _x = x;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="type">int</span> _x;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Date</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Print</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        cout &lt;&lt; _year &lt;&lt; <span class="string">&quot;-&quot;</span> &lt;&lt; _month &lt;&lt; <span class="string">&quot;-&quot;</span> &lt;&lt; _day &lt;&lt; endl;</span><br><span class="line">        cout &lt;&lt; _a1._x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; _a2._x &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Cl _a1;</span><br><span class="line">    Cl _a2;</span><br><span class="line">    <span class="type">int</span> _year;</span><br><span class="line">    <span class="type">int</span> _month;</span><br><span class="line">    <span class="type">int</span> _day;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Date d1;</span><br><span class="line">    d1.<span class="built_in">Print</span>();<span class="comment">//观察到内置的_a1、_a2自动进行了初始化，但是其他的三个内置类型没有初始化</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//默认构造函数对内置类型不起作用</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Cl</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Cl</span>(<span class="type">int</span> x = <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        _x = x;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="type">int</span> _x;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Date</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Print</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        cout &lt;&lt; _year &lt;&lt; <span class="string">&quot;-&quot;</span> &lt;&lt; _month &lt;&lt; <span class="string">&quot;-&quot;</span> &lt;&lt; _day &lt;&lt; endl;</span><br><span class="line">        cout &lt;&lt; _a1._x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; _a2._x &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Cl _a1;</span><br><span class="line">    Cl _a2;</span><br><span class="line">    <span class="type">int</span> _year = <span class="number">2000</span>;<span class="comment">//补丁</span></span><br><span class="line">    <span class="type">int</span> _month = <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> _day = <span class="number">1</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Date d1;</span><br><span class="line">    d1.<span class="built_in">Print</span>();<span class="comment">//观察到都自动进行了初始化</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意：这个补丁的缺省参数还有一个离谱的用法：可以在缺省处调用函数，例如使用<code>malloc()</code>。</p>
</blockquote>
<p>总结起来，实际上在<code>C++</code>中默认构造函数有三类：</p>
<ol>
<li><p>我们没写，编译器自动生成的默认构造函数</p>
</li>
<li><p>我们自己写的，全缺省的默认构造函数</p>
</li>
<li><p>我们自己写的，无参的默认构造函数</p>
</li>
</ol>
<p>另外，这三种默认构造函数不可能同时存在。</p>
<p>在<code>C++</code>中，构造函数是可以使用<code>private</code>访问权限进行修饰的。这种情况下，它们通常被用于实现特定的设计模式，如：“单例模式”或“工厂模式”等。</p>
<p>使用<code>private</code>构造函数可以防止类的实例化，也就是禁止用户直接创建对象。这样做的目的可能是为了控制对象的创建和确保只有特定的方式（即特点的参数）能够创建对象，避免用户错误创建具有危险性的对象。</p>
<blockquote>
<p>补充：以下是一个使用<code>private</code>构造函数实现单例模式的示例：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Singleton</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="built_in">Singleton</span>() &#123;&#125;<span class="comment">//私有构造函数</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">static</span> Singleton&amp; <span class="title">getInstance</span><span class="params">()</span> </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="type">static</span> Singleton instance;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//Singleton obj;//错误！无法直接创建对象</span></span><br><span class="line">    Singleton&amp; obj = Singleton::<span class="built_in">getInstance</span>();<span class="comment">//通过静态函数获取对象实例</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在上述示例中，私有构造函数<code>Singleton()</code>阻止了类实例的直接创建，而是通过静态成员函数<code>getInstance()</code>来获取唯一的类实例。</p>
</blockquote>
<blockquote>
<p>同时还要强调，<code>C++</code>不允许<code>类类型 对象名字()</code>这种写法，因为编译器没有办法确认这是定义一个对象，还是对一个函数进行声明。这样做是不会调用默认构造函数的，只需要把括号去掉就可以。</p>
</blockquote>
<h3 id="4-1-2-析构函数"><a href="#4-1-2-析构函数" class="headerlink" title="4.1.2.析构函数"></a>4.1.2.析构函数</h3><p>析构函数和构造函数功能相反。但是析构函数也不是完成对对象本身的销毁，局部对象销毁的工作由编译器完成。那析构函数究竟做什么呢？析构函数在对象销毁后会自动调用析构函数，完成对象中资源的清理工作（比如：对象内部的成员变量申请了堆空间的资源）。</p>
<p>析构函数的特征：</p>
<ol>
<li><p>析构函数的书写方法是在类名前面加上<code>~</code>，意思就是和构造函数功能相反</p>
</li>
<li><p>构造函数没有参数，也没有返回值</p>
</li>
<li><p>一个类只能有一个析构函数，若未显示定义，系统就会自动生成默认的析构函数。（即：析构函数不能重载）</p>
</li>
<li><p>对象生命周期结束时，<code>C++</code>编译系统自动调用析构函数</p>
</li>
<li><p>对象被析构的顺序符合栈先进后出的规律。先定义的后析构，后定义的先析构。如果是静态对象或者全局对象，则情况会再复杂一点。总体来看就是全局和静态的都要比局部的对象慢使用析构函数，而全局和静态的对象的析构顺序取决于两者的先后顺序</p>
</li>
</ol>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Data1</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">//1.构造函数</span></span><br><span class="line">    <span class="built_in">Data1</span>(<span class="type">int</span> x = <span class="number">1</span>, <span class="type">int</span> y = <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        _x = x;</span><br><span class="line">        _y = y;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Data()&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//2.析构函数</span></span><br><span class="line">    ~<span class="built_in">Data1</span>()</span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;~Data1()&quot;</span> &lt;&lt; endl;</span><br><span class="line">        <span class="comment">//这个析构函数是没啥作用的，只是演示确实调用了析构函数</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//3.其他接口</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Print</span><span class="params">(<span class="type">void</span>)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">Add</span><span class="params">(<span class="type">void</span>)</span></span>;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="type">int</span> _x;</span><br><span class="line">    <span class="type">int</span> _y;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Data1 C;</span><br><span class="line">    C.<span class="built_in">Print</span>();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, C.<span class="built_in">Add</span>());</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">test</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Data1::Print</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d %d\n&quot;</span>, _x, _y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">Data1::Add</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> _x + _y;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>那么析构函数在什么时候才更加具有作用呢？在调用堆空间的时候析构函数就有很大的作用</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Data1</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">//1.构造函数</span></span><br><span class="line">    <span class="built_in">Data1</span>(<span class="type">int</span> x = <span class="number">1</span>, <span class="type">int</span> y = <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        _x = x;</span><br><span class="line">        _y = y;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Data()&quot;</span> &lt;&lt; endl;</span><br><span class="line">        <span class="type">int</span>* cache = (<span class="type">int</span>*)<span class="built_in">malloc</span>(<span class="built_in">sizeof</span>(<span class="type">int</span>) * <span class="number">5</span>);</span><br><span class="line">        <span class="keyword">if</span> (!cache) <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">        _arr = cache;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//2.析构函数</span></span><br><span class="line">    ~<span class="built_in">Data1</span>()</span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;~Data1()&quot;</span> &lt;&lt; endl;</span><br><span class="line">        <span class="built_in">free</span>(_arr);</span><br><span class="line">        _arr = <span class="literal">nullptr</span>;</span><br><span class="line">        _x = _y = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//3.其他接口</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Print</span><span class="params">(<span class="type">void</span>)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">Add</span><span class="params">(<span class="type">void</span>)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">ForPrint</span><span class="params">(<span class="type">void</span>)</span></span>;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="type">int</span> _x;</span><br><span class="line">    <span class="type">int</span> _y;</span><br><span class="line">    <span class="type">int</span>* _arr;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Data1 C;</span><br><span class="line">    C.<span class="built_in">Print</span>();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, C.<span class="built_in">Add</span>());</span><br><span class="line">    C.<span class="built_in">ForPrint</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">test</span>();</span><br><span class="line">    <span class="comment">//这里就体现了析构函数的价值，使用析构函数就可以在这里避免内存泄露</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Data1::Print</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d %d\n&quot;</span>, _x, _y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">Data1::Add</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> _x + _y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Data1::ForPrint</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        _arr[i] = i * i;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, _arr[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>但是，如果我们没有显式的写出析构函数，那么编译器自己执行的默认析构函数又有什么作用呢？和构造函数类似，隐式的析构函数：对内置类型不做处理，但是会处理自定义类型，调用字段自定义类型的默认析构函数，这里的默认析构函数包括编译器自己生成的析构函数、我们自己写的自定义析构函数。</p>
<p>其中编译器默认生成的析构函数的作用就是调用自定义类型的默认构造函数。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Data1</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">//1.构造函数</span></span><br><span class="line">    <span class="built_in">Data1</span>(<span class="type">int</span> x = <span class="number">1</span>, <span class="type">int</span> y = <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        _x = x;</span><br><span class="line">        _y = y;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Data()&quot;</span> &lt;&lt; endl;</span><br><span class="line">        <span class="type">int</span>* cache = (<span class="type">int</span>*)<span class="built_in">malloc</span>(<span class="built_in">sizeof</span>(<span class="type">int</span>) * <span class="number">5</span>);</span><br><span class="line">        <span class="keyword">if</span> (!cache) <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">        _arr = cache;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//2.析构函数</span></span><br><span class="line">    ~<span class="built_in">Data1</span>()</span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;~Data1()&quot;</span> &lt;&lt; endl;</span><br><span class="line">        <span class="built_in">free</span>(_arr);</span><br><span class="line">        _arr = <span class="literal">nullptr</span>;</span><br><span class="line">        _x = _y = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//3.其他接口</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Print</span><span class="params">(<span class="type">void</span>)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">Add</span><span class="params">(<span class="type">void</span>)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">ForPrint</span><span class="params">(<span class="type">void</span>)</span></span>;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="type">int</span> _x;</span><br><span class="line">    <span class="type">int</span> _y;</span><br><span class="line">    <span class="type">int</span>* _arr;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Data2</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Data2</span>()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span>* cache = (<span class="type">int</span>*)<span class="built_in">malloc</span>(<span class="built_in">sizeof</span>(<span class="type">int</span>) * <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span> (!cache) <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">        _d = cache;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Data1 _a;</span><br><span class="line">    Data1 _b;</span><br><span class="line">    <span class="type">int</span> _c = <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span>* _d;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Data2 D;</span><br><span class="line">    cout &lt;&lt; D._a._arr;<span class="comment">//这个arr就会被默认的析构函数清理，因为_a的数据类型书自定义类型，拥有自己的析构函数，默认的析构函数去调用了这个自定义的析构函数</span></span><br><span class="line">    cout &lt;&lt; D._d;<span class="comment">//这里_d就不会被默认的析构函数释放掉，因为其是内置类型，因此造成了内存泄露</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">test</span>();</span><br><span class="line">    <span class="comment">//这里就体现了析构函数的价值，使用析构函数就可以在这里避免内存泄露</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Data1::Print</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d %d\n&quot;</span>, _x, _y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">Data1::Add</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> _x + _y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Data1::ForPrint</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        _arr[i] = i * i;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, _arr[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意：这和<code>Java</code>的垃圾回收机制是不一样的，不能混为一谈！利用析构函数在书写某些数据结构的时候就很方便。</p>
</blockquote>
<p>下面演示构造函数和析构函数的调用顺序问题：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">A</span>(<span class="type">int</span> x)</span><br><span class="line">    &#123;</span><br><span class="line">        _a = x;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;A():&quot;</span> &lt;&lt; <span class="string">&quot;aa&quot;</span> &lt;&lt; _a &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    ~<span class="built_in">A</span>()</span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;~A():&quot;</span> &lt;&lt; <span class="string">&quot;aa&quot;</span> &lt;&lt; _a &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">int</span> _a;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function">A <span class="title">aa0</span><span class="params">(<span class="number">0</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">f</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function"><span class="type">static</span> A <span class="title">aa1</span><span class="params">(<span class="number">1</span>)</span></span>;</span><br><span class="line">    <span class="function">A <span class="title">aa2</span><span class="params">(<span class="number">2</span>)</span></span>;</span><br><span class="line">    <span class="function">A <span class="title">aa3</span><span class="params">(<span class="number">3</span>)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">static</span> A <span class="title">aa4</span><span class="params">(<span class="number">4</span>)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">f</span>();</span><br><span class="line">    <span class="comment">//构造aa0</span></span><br><span class="line">    <span class="comment">//构造aa1</span></span><br><span class="line">    <span class="comment">//构造aa2</span></span><br><span class="line">    <span class="comment">//构造aa3</span></span><br><span class="line">    <span class="comment">//构造aa4</span></span><br><span class="line">    <span class="comment">//析构aa3</span></span><br><span class="line">    <span class="comment">//析构aa2</span></span><br><span class="line">    <span class="built_in">f</span>();</span><br><span class="line">    <span class="comment">//构造aa2</span></span><br><span class="line">    <span class="comment">//构造aa3</span></span><br><span class="line">    <span class="comment">//析构aa3</span></span><br><span class="line">    <span class="comment">//析构aa2</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="comment">//析构aa4</span></span><br><span class="line">    <span class="comment">//析构aa1</span></span><br><span class="line">    <span class="comment">//析构aa0</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>等我们学到在<code>C++</code>中栈和队列的使用，就可以使用<code>C</code>语言和<code>C++</code>语言来解决这道力扣题目：<a target="_blank" rel="noopener" href="https://leetcode.cn/problems/implement-queue-using-stacks/">力扣：两个栈实现一个队列对比一下</a>，对比一下<code>C++</code>的便捷之处。</p>
</blockquote>
<h2 id="4-2-拷贝复制赋值"><a href="#4-2-拷贝复制赋值" class="headerlink" title="4.2.拷贝复制赋值"></a>4.2.拷贝复制赋值</h2><h3 id="4-2-1-拷贝构造函数（初始化的拷贝）"><a href="#4-2-1-拷贝构造函数（初始化的拷贝）" class="headerlink" title="4.2.1.拷贝构造函数（初始化的拷贝）"></a>4.2.1.拷贝构造函数（初始化的拷贝）</h3><p>在创建对象时，可否创建一个与已存在对象相同的的新对象呢？这个时候就可以用到拷贝构造函数，拷贝构造函数的特征有：</p>
<ol>
<li><p>只有单个形参，该形参是对本类型对象的“引用”（一般常用const修饰，使用传值方式编译器会直接报错，因为会引发无穷递归调用，当然用指针也不错，但是形式上怪怪的），在用已存在的类类型对象创建新对象时由编译器自动调用</p>
</li>
<li><p>拷贝构造函数实际上是构造函数的一个重载形式</p>
</li>
</ol>
<blockquote>
<p>补充：会引发无穷递归调用，是因为在传对象作为参数的时候，就发生了传值拷贝，也就是需要调用拷贝构造，而调用拷贝构造函数又需要传对象参数，传参数又需要调用拷贝构造…因此如果使用了<code>&amp;</code>引用就不会发生这样的事情，传递过来的参数就是参数本身，而不是参数的拷贝。</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Data1</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">//1.构造函数</span></span><br><span class="line">    <span class="built_in">Data1</span>(<span class="type">int</span> x = <span class="number">1</span>, <span class="type">int</span> y = <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        _x = x;</span><br><span class="line">        _y = y;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Data()&quot;</span> &lt;&lt; endl;</span><br><span class="line">        <span class="type">int</span>* cache = (<span class="type">int</span>*)<span class="built_in">malloc</span>(<span class="built_in">sizeof</span>(<span class="type">int</span>) * <span class="number">4</span>);</span><br><span class="line">        <span class="keyword">if</span> (!cache) <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">        _arr = cache;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//2.析构函数</span></span><br><span class="line">    ~<span class="built_in">Data1</span>()</span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;~Data1()&quot;</span> &lt;&lt; endl;</span><br><span class="line">        <span class="built_in">free</span>(_arr);</span><br><span class="line">        _arr = <span class="literal">nullptr</span>;</span><br><span class="line">        _x = _y = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//3.拷贝构造函数</span></span><br><span class="line">    <span class="built_in">Data1</span>(<span class="type">const</span> Data1&amp; d)</span><br><span class="line">    &#123;</span><br><span class="line">        _x = d._x;</span><br><span class="line">        _y = d._y;</span><br><span class="line">        <span class="type">int</span>* cache = (<span class="type">int</span>*)<span class="built_in">malloc</span>(<span class="built_in">sizeof</span>(<span class="type">int</span>) * <span class="number">4</span>);</span><br><span class="line">        <span class="keyword">if</span> (!cache) <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">        <span class="built_in">memcpy</span>(cache, d._arr, <span class="built_in">sizeof</span>(<span class="type">int</span>) * <span class="number">4</span><span class="comment">//另外，拷贝构造函数还会涉及到深拷贝和浅拷贝的知识，不过这个后面再说了</span></span><br><span class="line">        _arr = cache;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//4.其他接口</span></span><br><span class="line">    <span class="type">void</span> <span class="built_in">Print</span>(<span class="type">void</span>);</span><br><span class="line">    <span class="type">int</span> <span class="built_in">Add</span>(<span class="type">void</span>);</span><br><span class="line">    <span class="type">void</span> <span class="built_in">ForPrint</span>(<span class="type">void</span>);</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="type">int</span> _x;</span><br><span class="line">    <span class="type">int</span> _y;</span><br><span class="line">    <span class="type">int</span>* _arr;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">void</span> <span class="built_in">test</span>(<span class="type">void</span>)</span><br><span class="line">&#123;</span><br><span class="line">    Data1 <span class="built_in">E</span>(<span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line">    E.<span class="built_in">Print</span>();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, E.<span class="built_in">Add</span>());</span><br><span class="line">    <span class="comment">//方法一：兼容C的一种拷贝方法</span></span><br><span class="line">    Data1 F = E;</span><br><span class="line">    E.<span class="built_in">Print</span>();</span><br><span class="line">    <span class="comment">//方法二：使用类的拷贝构造函数</span></span><br><span class="line">    Data1 <span class="built_in">G</span>(E);</span><br><span class="line">    G.<span class="built_in">Print</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="built_in">main</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">test</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> Data1::<span class="built_in">Print</span>(<span class="type">void</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d %d\n&quot;</span>, _x, _y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> Data1::<span class="built_in">Add</span>(<span class="type">void</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> _x + _y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> Data1::<span class="built_in">ForPrint</span>(<span class="type">void</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        _arr[i] = i * i;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, _arr[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>那么构造拷贝函数如果是编译器默认生成的会有什么作用呢？实际上，编译器生成的默认拷贝构造函数会对“内置类型”直接按照字节的方式直接拷贝（是比较粗暴的浅拷贝），而“自定义类型”则回去调用其自己的拷贝构造函数完成拷贝。这里与构造函数和析构函数不太一样。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Data1</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">//1.构造函数</span></span><br><span class="line">    <span class="built_in">Data1</span>(<span class="type">int</span> x = <span class="number">1</span>, <span class="type">int</span> y = <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        _x = x;</span><br><span class="line">        _y = y;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Data()&quot;</span> &lt;&lt; endl;</span><br><span class="line">        <span class="type">int</span>* cache = (<span class="type">int</span>*)<span class="built_in">malloc</span>(<span class="built_in">sizeof</span>(<span class="type">int</span>) * <span class="number">4</span>);</span><br><span class="line">        <span class="keyword">if</span> (!cache) <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">        _arr = cache;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//2.析构函数</span></span><br><span class="line">    ~<span class="built_in">Data1</span>()</span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;~Data1()&quot;</span> &lt;&lt; endl;</span><br><span class="line">        <span class="built_in">free</span>(_arr);</span><br><span class="line">        _arr = <span class="literal">nullptr</span>;</span><br><span class="line">        _x = _y = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//3.拷贝构造函数</span></span><br><span class="line">    <span class="built_in">Data1</span>(<span class="type">const</span> Data1&amp; d)</span><br><span class="line">    &#123;</span><br><span class="line">        _x = d._x;</span><br><span class="line">        _y = d._y;</span><br><span class="line">        <span class="type">int</span>* cache = (<span class="type">int</span>*)<span class="built_in">malloc</span>(<span class="built_in">sizeof</span>(<span class="type">int</span>) * <span class="number">4</span>);</span><br><span class="line">        <span class="keyword">if</span> (!cache) <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">        <span class="built_in">memcpy</span>(cache, d._arr, <span class="built_in">sizeof</span>(<span class="type">int</span>) * <span class="number">4</span>);</span><br><span class="line">        _arr = cache;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//4.其他接口</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Print</span><span class="params">(<span class="type">void</span>)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">Add</span><span class="params">(<span class="type">void</span>)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">ForPrint</span><span class="params">(<span class="type">void</span>)</span></span>;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="type">int</span> _x;</span><br><span class="line">    <span class="type">int</span> _y;</span><br><span class="line">    <span class="type">int</span>* _arr;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Data2</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Print</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        cout &lt;&lt; _data1._x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; _data1._y &lt;&lt; endl;</span><br><span class="line">        cout &lt;&lt; _data3 &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; _data4 &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Fun</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        _data1._x = x;</span><br><span class="line">        _data1._y = y;</span><br><span class="line">        _data3 = <span class="number">100000</span>;</span><br><span class="line">        _data4 = <span class="string">&#x27;X&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Data1 _data1;</span><br><span class="line">    Data1 _data2;</span><br><span class="line">    <span class="type">int</span> _data3 = <span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> _data4 = <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Data2 H;</span><br><span class="line">    H.<span class="built_in">Print</span>();</span><br><span class="line">    cout &lt;&lt; endl;</span><br><span class="line">    H.<span class="built_in">Fun</span>(<span class="number">100000</span>, <span class="number">100000</span>);</span><br><span class="line">    H.<span class="built_in">Print</span>();</span><br><span class="line">    cout &lt;&lt; endl;</span><br><span class="line">    <span class="function">Data2 <span class="title">I</span><span class="params">(H)</span></span>;</span><br><span class="line">    <span class="comment">//这一步拷贝，使用的是编译器自动给出的默认拷贝构造函数。</span></span><br><span class="line">    <span class="comment">//对于内置类型会自己进行拷贝，没必要我们写出来</span></span><br><span class="line">    <span class="comment">//对于自定义类型则会回去调用自定义类型的拷贝函数</span></span><br><span class="line">    I.<span class="built_in">Print</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">test</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Data1::Print</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d %d\n&quot;</span>, _x, _y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">Data1::Add</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> _x + _y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Data1::ForPrint</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        _arr[i] = i * i;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, _arr[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在函数传参的时候，尤其需要注意拷贝传值和引用传值中拷贝构造函数的动作。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">A</span>(<span class="type">int</span> x = <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        _a = x;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;A(int x = 0)&quot;</span> &lt;&lt; _a &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">A</span>(<span class="type">const</span> A&amp; aa)</span><br><span class="line">    &#123;</span><br><span class="line">        _a = aa._a;<span class="comment">//拷贝</span></span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;A(const A&amp; aa)-&gt;&quot;</span> &lt;&lt; _a &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    ~<span class="built_in">A</span>()</span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;~A()-&gt;&quot;</span> &lt;&lt; _a &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">int</span> _a;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">fun0</span><span class="params">(A aa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">fun1</span><span class="params">(A&amp; aa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">A <span class="title">fun2</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">static</span> A aa;</span><br><span class="line">    <span class="keyword">return</span> aa;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">A&amp; <span class="title">fun3</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">static</span> A aa;</span><br><span class="line">    <span class="keyword">return</span> aa;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    A aa0;<span class="comment">//使用一次构造函数</span></span><br><span class="line">    <span class="function">A <span class="title">aa1</span><span class="params">(aa0)</span></span>;<span class="comment">//使用一次拷贝构造</span></span><br><span class="line">    <span class="built_in">fun0</span>(aa0);<span class="comment">//由于使用的是拷贝传值方式，所以使用一次自定义的拷贝构造函数，使用完形参后，也要使用自定义析构函数</span></span><br><span class="line">    <span class="built_in">fun1</span>(aa0);<span class="comment">//由于使用的是引用传值方式，无需使用自定义的拷贝构造函数，也就无需使用自定义析构函数</span></span><br><span class="line">    <span class="built_in">fun2</span>();<span class="comment">//内部构建了一个static对象aa，使用了一次构造函数。并且其返回值需要拷贝给类型为A的匿名对象返回来，所以又使用了一次自定义拷贝构造函数，并且这个匿名对象还要使用一次析构函数</span></span><br><span class="line">    <span class="built_in">fun3</span>();<span class="comment">//内部再次构建一个static对象aa，使用了一次构造函数。由于使用的是引用返回，所以无需使用拷贝构造函数</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="comment">//最后aa0使用析构函数，aa1也使用析构函数</span></span><br><span class="line">    <span class="comment">//最后把两个static对象aa分别使用析构函数</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>另外，实际上不使用引用改为指针也是可以的，但是在语法书写形式上会很奇怪，感兴趣您可以自己试一试。</p>
<h3 id="4-2-2-赋值运算符重载函数（赋值拷贝）"><a href="#4-2-2-赋值运算符重载函数（赋值拷贝）" class="headerlink" title="4.2.2.赋值运算符重载函数（赋值拷贝）"></a>4.2.2.赋值运算符重载函数（赋值拷贝）</h3><p>要使用赋值重载函数，还需要先深入了解运算符重载函数（<code>Java</code>没有运算符重载）。</p>
<p>运算符重载的应用很多，比如：对象和对象直接要进行运算符运算。为什么需要重载呢？因为编译器只会内置类型的运算符运算，无法通过运算符运算自定义的类对象，这个时候就需要运算符重载了，例如下面的代码。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//没有运算符重载</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Time</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Time</span>(<span class="type">int</span> x = <span class="number">2000</span>, <span class="type">int</span> y = <span class="number">1</span>, <span class="type">int</span> z = <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        _year = x;</span><br><span class="line">        _month = y;</span><br><span class="line">        _day = z;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Print</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        cout &lt;&lt; _year &lt;&lt; <span class="string">&quot;-&quot;</span> &lt;&lt; _month &lt;&lt; <span class="string">&quot;-&quot;</span> &lt;&lt; _day &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="type">int</span> _year;</span><br><span class="line">    <span class="type">int</span> _month;</span><br><span class="line">    <span class="type">int</span> _day;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Time A;</span><br><span class="line">    A.<span class="built_in">Print</span>();</span><br><span class="line">    <span class="function">Time <span class="title">B</span><span class="params">(<span class="number">2023</span>, <span class="number">1</span>, <span class="number">1</span>)</span></span>;</span><br><span class="line">    Time C = B - A;<span class="comment">//这里的编译器就无法知道究竟如何运算</span></span><br><span class="line">    C.<span class="built_in">Print</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>面对这种情况，我们就可以使用关键字<code>operator</code>，这个关键字的使用格式是：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">返回值类型 <span class="keyword">operator</span>操作符(参数列表)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//…</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>值得注意的是，不能通过连接其他符号来创建新的操作符，比如<code>operator@</code>。下面我们来演示一个运算符重载的例子。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdlib&gt;</span> </span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std; </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Time</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>: </span><br><span class="line">      <span class="comment">//1.构造函数 </span></span><br><span class="line">      <span class="built_in">Time</span>(<span class="type">int</span> x = <span class="number">2000</span>, <span class="type">int</span> y = <span class="number">1</span>, <span class="type">int</span> z = <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">          _year = x; </span><br><span class="line">          _month = y; </span><br><span class="line">          _day = z; </span><br><span class="line">    &#125;</span><br><span class="line">      <span class="function"><span class="type">void</span> <span class="title">Print</span><span class="params">()</span> </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">          cout &lt;&lt; _year &lt;&lt; <span class="string">&quot;-&quot;</span> &lt;&lt; _month &lt;&lt; <span class="string">&quot;-&quot;</span> &lt;&lt; _day &lt;&lt; endl; </span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">public</span>:<span class="comment">//注意这里是公有限定符</span></span><br><span class="line">      <span class="type">int</span> _year; </span><br><span class="line">      <span class="type">int</span> _month; </span><br><span class="line">      <span class="type">int</span> _day; </span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//2.全局运算符重载</span></span><br><span class="line"><span class="type">int</span> <span class="keyword">operator</span>-(Time x, Time y) </span><br><span class="line">&#123;</span><br><span class="line">      <span class="keyword">return</span> x._year - y._year; </span><br><span class="line">&#125; </span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">      Time A;</span><br><span class="line">      A.<span class="built_in">Print</span>();</span><br><span class="line">      </span><br><span class="line">      <span class="function">Time <span class="title">B</span><span class="params">(<span class="number">2023</span>, <span class="number">1</span>, <span class="number">1</span>)</span></span>;</span><br><span class="line">      B.<span class="built_in">Print</span>();</span><br><span class="line">      </span><br><span class="line">      Time C = (B - A); </span><br><span class="line">      C.<span class="built_in">Print</span>(); </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>另外运算符重载中的重载操作符必须有一个类类型参数（例如两个操作符都是<code>int</code>，这是不被允许的）。</p>
<p>还有五个运算符不允许重载的：<code>.*</code>、<code>::</code>、<code>sizeof</code>、<code>?:</code>、<code>.</code></p>
<p>运算符重载有两种写法，一种是全局运算符重载（在类外声明和定义），这种就需要把操作符需要的所有操作数写成参数列表写清楚（因为没有<code>this</code>指针）。</p>
<p>但是如果像上面这么写的话，万一类里的成员变量并不是公有的而是私有的怎么办呢？全局运算符重载是没有办法直接访问类的私有成员的（除非使用友元），因此<code>C++</code>还提供了第二种写法：直接写在类里成为类的成员函数。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Time</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">//1.构造函数</span></span><br><span class="line">    <span class="built_in">Time</span>(<span class="type">int</span> x = <span class="number">2000</span>, <span class="type">int</span> y = <span class="number">1</span>, <span class="type">int</span> z = <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        _year = x;</span><br><span class="line">        _month = y;</span><br><span class="line">        _day = z;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Print</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        cout &lt;&lt; _year &lt;&lt; <span class="string">&quot;-&quot;</span> &lt;&lt; _month &lt;&lt; <span class="string">&quot;-&quot;</span> &lt;&lt; _day &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//2.运算符重载函数</span></span><br><span class="line">    <span class="type">int</span> <span class="keyword">operator</span>-(Time x)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> _year - x._year;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">int</span> _year;</span><br><span class="line">    <span class="type">int</span> _month;</span><br><span class="line">    <span class="type">int</span> _day;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Time A;</span><br><span class="line">    A.<span class="built_in">Print</span>();</span><br><span class="line">    <span class="function">Time <span class="title">B</span><span class="params">(<span class="number">2023</span>, <span class="number">1</span>, <span class="number">1</span>)</span></span>;</span><br><span class="line">    B.<span class="built_in">Print</span>();</span><br><span class="line">    Time C = (B - A);</span><br><span class="line">    C.<span class="built_in">Print</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>为什么只传递一个参数也能通过呢？不要忘记<code>this</code>指针的存在，上述的代码还可以显式写成下面这个样子（即编译器处理后的样子，自己直接这么写是会报错的）。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">#include &lt;iostream&gt;</span></span><br><span class="line"><span class="comment">#include &lt;cstdio&gt;</span></span><br><span class="line"><span class="comment">#include &lt;cstdlib&gt;</span></span><br><span class="line"><span class="comment">using namespace std;</span></span><br><span class="line"><span class="comment">class Time</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">public:</span></span><br><span class="line"><span class="comment">    //1.构造函数</span></span><br><span class="line"><span class="comment">    Time(int x = 2000, int y = 1, int z = 1)</span></span><br><span class="line"><span class="comment">    &#123;</span></span><br><span class="line"><span class="comment">        _year = x;</span></span><br><span class="line"><span class="comment">        _month = y;</span></span><br><span class="line"><span class="comment">        _day = z;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    void Print()</span></span><br><span class="line"><span class="comment">    &#123;</span></span><br><span class="line"><span class="comment">        cout &lt;&lt; _year &lt;&lt; &quot;-&quot; &lt;&lt; _month &lt;&lt; &quot;-&quot; &lt;&lt; _day &lt;&lt; endl;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    //2.运算符重载函数</span></span><br><span class="line"><span class="comment">    int operator-(Time* const this, Time x)</span></span><br><span class="line"><span class="comment">    &#123;</span></span><br><span class="line"><span class="comment">        return this-&gt;_year - x._year;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">private:</span></span><br><span class="line"><span class="comment">    int _year;</span></span><br><span class="line"><span class="comment">    int _month;</span></span><br><span class="line"><span class="comment">    int _day;</span></span><br><span class="line"><span class="comment">&#125;;</span></span><br><span class="line"><span class="comment">int main()</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">    Time A;</span></span><br><span class="line"><span class="comment">    A.Print();</span></span><br><span class="line"><span class="comment">    Time B(2023, 1, 1);</span></span><br><span class="line"><span class="comment">    B.Print();</span></span><br><span class="line"><span class="comment">    Time C = (&amp;B - A);</span></span><br><span class="line"><span class="comment">    C.Print();</span></span><br><span class="line"><span class="comment">    return 0;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<p>可以利用运算符重载函数来写一个日期加法，<code>日期(data)+天数(int)=日期(data)</code>，感兴趣的话您可以自己先实现一下，或者直接看下一章节的《日期类的实现》。</p>
<p>接下来我们来看看赋值运算符重载的使用。<br>这里我们提前展示后面日期类里的赋值运算符重载的写法（之后会详细介绍日期类的实现）</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Data</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">//1.构造函数（内联的构造函数）</span></span><br><span class="line">    <span class="built_in">Data</span>(<span class="type">int</span> year = <span class="number">1900</span>, <span class="type">int</span> month = <span class="number">1</span>, <span class="type">int</span> day = <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        _year = year;</span><br><span class="line">        _month = month;</span><br><span class="line">        _day = day;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//2.拷贝构造函数（使用默认的即可）</span></span><br><span class="line">    <span class="comment">//3.赋值运算符重载函数</span></span><br><span class="line">    <span class="comment">//3.1.写法1（可以是可以，但是不支持连续赋值）</span></span><br><span class="line">    <span class="comment">//void operator=(const Data&amp; d)</span></span><br><span class="line">    <span class="comment">//&#123;</span></span><br><span class="line">    <span class="comment">//    //this指向的是“=”前面的操作数，d是“=”后面的操作是</span></span><br><span class="line">    <span class="comment">//    _year = d._year;</span></span><br><span class="line">    <span class="comment">//    _month = d._month;</span></span><br><span class="line">    <span class="comment">//    _day = d._day;</span></span><br><span class="line">    <span class="comment">//&#125;</span></span><br><span class="line">    <span class="comment">//3.2.写法2（允许连续赋值）</span></span><br><span class="line">    Data&amp; <span class="keyword">operator</span>=(<span class="type">const</span> Data&amp; d)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//this指向的是“=”前面的操作数，d是“=”后面的操作是</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">this</span> != &amp;d)<span class="comment">//用地址值判断比较好</span></span><br><span class="line">        &#123;</span><br><span class="line">            _year = d._year;</span><br><span class="line">            _month = d._month;</span><br><span class="line">            _day = d._day;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Print</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        cout &lt;&lt; _year &lt;&lt; <span class="string">&quot;:&quot;</span> &lt;&lt; _month &lt;&lt; <span class="string">&quot;:&quot;</span> &lt;&lt; _day &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">int</span> _year;</span><br><span class="line">    <span class="type">int</span> _month;</span><br><span class="line">    <span class="type">int</span> _day;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">Data <span class="title">d1</span><span class="params">(<span class="number">2022</span>, <span class="number">7</span>, <span class="number">24</span>)</span></span>;</span><br><span class="line">    d1.<span class="built_in">Print</span>();</span><br><span class="line">    <span class="function">Data <span class="title">d2</span><span class="params">(d1)</span></span>;</span><br><span class="line">    d2.<span class="built_in">Print</span>();</span><br><span class="line">    <span class="function">Data <span class="title">d3</span><span class="params">(<span class="number">2022</span>, <span class="number">8</span>, <span class="number">24</span>)</span></span>;</span><br><span class="line">    <span class="function">Data <span class="title">d4</span><span class="params">(<span class="number">2023</span>, <span class="number">6</span>, <span class="number">21</span>)</span></span>;</span><br><span class="line">    d4 = d1 = d3;<span class="comment">//这里就需要用到赋值运算符重载函数，而不是拷贝构造函数，并且注意这里是连续赋值</span></span><br><span class="line">    d3.<span class="built_in">Print</span>();</span><br><span class="line">    d1.<span class="built_in">Print</span>();</span><br><span class="line">    d4.<span class="built_in">Print</span>();</span><br><span class="line">    d2 = d2;<span class="comment">//这里使用的是自己给自己赋值，赋值运算符重载可以考虑在这里优化</span></span><br><span class="line">    d2.<span class="built_in">Print</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>需要注意的是，赋值运算符函数不同于其他的运算符重载函数，赋值运算符重载只能重载为类的成员函数，不能直接重载成全局函数。如果您这么做了，将会直接报错（<code>error C2801: operator= 必须是成员函数</code>）</p>
<p>这样错误的原因本质是：</p>
<ol>
<li><p>如果您不写赋值运算符重载成员函数，编译器会生成一个默认的赋值运算符重载成员函数</p>
</li>
<li><p>如果是内置类型成员变量：直接按字节赋值的（因此上面的代码例子实际上是不需要自己写一个赋值运算符重载函数的，编译器自动会把三个<code>int</code>类型的成员进行按字节赋值，上面只是演示如何使用赋值重载成员函数而已）</p>
</li>
<li><p>如果是自定义类型成员变量：需要调用对应类的赋值运算符重载成员函数完成赋值（这里很像拷贝构造函数的使用）</p>
</li>
<li><p>这个时候问题来了，如果写了全局的赋值运算符重载函数，那么将和这个默认生成的赋值运算符重载函数发冲突，对象不知道该调用哪一个函数（注意，我们之前是因为在类里面写了成员函数，编译器才不会重复生成默认构造函数的，这里我们把赋值重载函数写成了全局，编译器就还是会生成一个默认的赋值重载成员函数，这两个函数就同时存在了）。</p>
</li>
</ol>
<h2 id="4-3-取地址重载函数"><a href="#4-3-取地址重载函数" class="headerlink" title="4.3.取地址重载函数"></a>4.3.取地址重载函数</h2><h3 id="4-3-1-const成员函数"><a href="#4-3-1-const成员函数" class="headerlink" title="4.3.1.const成员函数"></a>4.3.1.const成员函数</h3><p><code>C++</code>的类型检查很严格，对于<code>const</code>对象，不可以直接使用没有<code>const</code>修饰<code>this</code>指针的成员函数。但是<code>this</code>是编译器自动给我们加上的，我们在哪里写<code>const</code>呢？答案是直接写在成员函数的函数头右侧（这种现象我们之前提到过）。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//没有const成员函数的情况下</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">A</span>(a = <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">          _a = a;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Print</span><span class="params">()</span><span class="comment">//这里的this展开写是A* const this</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        cout &lt;&lt; _a &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> _a;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">A <span class="title">aa1</span><span class="params">(<span class="number">5</span>)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">const</span> A <span class="title">aa2</span><span class="params">(<span class="number">10</span>)</span></span>;</span><br><span class="line">    aa1.<span class="built_in">Print</span>();<span class="comment">//这里传递&amp;aa1（类型是A*）,权限放小，没有关系</span></span><br><span class="line">    aa2.<span class="built_in">Print</span>();<span class="comment">//这里就会有问题</span></span><br><span class="line">    <span class="comment">//因为this指针的存在，使得这里调用Print的时候是&amp;aa2（类型为const A*），权限放大了</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>因此就需要让编译器给<code>this</code>前面加上<code>const</code>，修改为下面这个代码就可以通过编译了。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//写了const成员函数的情况</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">A</span>(a = <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">          _a = a;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Print</span><span class="params">()</span> <span class="type">const</span><span class="comment">//这里的this展开写就是const A* const this</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        cout &lt;&lt; _a &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> _a;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">A <span class="title">aa1</span><span class="params">(<span class="number">5</span>)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">const</span> A <span class="title">aa2</span><span class="params">(<span class="number">10</span>)</span></span>;</span><br><span class="line">    aa1.<span class="built_in">Print</span>();</span><br><span class="line">    aa2.<span class="built_in">Print</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意：<code>const</code>加到普通的函数返回值是没有什么意义的，因为正常情况下，函数的返回值具有常属性，没有必要再多此一举加上<code>const</code>。</p>
</blockquote>
<p>思考一下下面的几个问题：</p>
<ol>
<li><p><code>const</code>对象可以调用非<code>const</code>成员函数吗？（不可以）</p>
</li>
<li><p>非<code>const</code>对象可以调用<code>const</code>成员函数吗？（可以，发生隐式转化）</p>
</li>
<li><p><code>const</code>成员函数内可以调用其他非<code>const</code>成员函数吗？（不可以，本质是<code>const</code>的<code>this</code>调用了非<code>const</code>的成员函数，这符合上面的第<code>1</code>条。但是可以调用<code>const</code>成员变量，不过这会造成一个现象：声明了一个<code>const</code>成员函数，就很有可能需要声明一系列的<code>const</code>函数）</p>
</li>
<li><p>非<code>const</code>成员函数可内以调用其他<code>const</code>成员函数吗？（可以，本质是非<code>const</code>的<code>this</code>调用了<code>const</code>的成员函数，这符合上面的第<code>2</code>条）</p>
</li>
</ol>
<p>给某些只读的成员函数加上<code>const</code>修饰<code>this</code>最重要的好处是：<code>const</code>对象可以正常调用成员函数，不用担心在编码的时候被人为破坏。</p>
<blockquote>
<p>注意：声明和定义在加<code>const</code>上要同步加上。</p>
</blockquote>
<h3 id="4-3-2-取地址操作符重载"><a href="#4-3-2-取地址操作符重载" class="headerlink" title="4.3.2.取地址操作符重载"></a>4.3.2.取地址操作符重载</h3><p>取地址在默认情况下是很够用的，所以一般是不需要将<code>&amp;</code>重载的，除非有的时候不希望被别人取到有地址（但是这种应用极少，不过也不是没有）。</p>
<p>对于自定义类型，理论上是不能直接使用<code>&amp;</code>的，但是我们在编译器中是能通过编译并且运行的。这是因为类还有一个默认成员函数：取地址重载成员函数。我们可以显示写出下面得成员函数：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Data</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Data* <span class="keyword">operator</span>&amp;()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="type">const</span> Data* <span class="keyword">operator</span>&amp;()<span class="type">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">    &#125; </span><br><span class="line">&#125;; </span><br></pre></td></tr></table></figure>

<p>可以返回一个虚假的地址…</p>
<h1 id="5-日期类的实现"><a href="#5-日期类的实现" class="headerlink" title="5.日期类的实现"></a>5.日期类的实现</h1><p>这里我实现了一个<a href="./%E9%A2%9D%E5%A4%96%E8%A1%A5%E5%85%85%EF%BC%9AC++%E6%97%A5%E6%9C%9F%E7%B1%BB%E7%9A%84%E5%AE%9E%E7%8E%B0.md">简单的日期类</a>，您可以去看看。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/12/01/000+limou+2023_07_23+C++%E5%AF%BC%E8%AE%BA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="limou3434">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2023/12/01/000+limou+2023_07_23+C++%E5%AF%BC%E8%AE%BA/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2023-12-01T16:34:49+08:00">
                2023-12-01
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>[TOC]</p>
<h1 id="1-何为C"><a href="#1-何为C" class="headerlink" title="1.何为C++"></a>1.何为C++</h1><p><code>C</code>语言是关于结构化和模块化的语言，比较适合处理较小规模的程序。而对于复杂的问题，规模较大的程序，需要高度的抽象和建模时，<code>C</code>语言则变得很不适用且麻烦。</p>
<p>在20世纪80年代，计算机界提出了<code>OOP</code>思想（面向对象思想）支持面向对象的程序设计语言（例如<code>C++</code>、<code>Java</code>等）应运而生。</p>
<p><code>1982</code>年，<code>Bjarne Stroustrup</code>博士在<code>C</code>语言的基础上引入并扩充了面向对象的概念，发明了一种新的程序语言。为了表达该语言与<code>C</code>语言的渊源关系，命名为<code>C++</code>。</p>
<p>因此<code>C++</code>是基于<code>C</code>语言而产生的，它既可以进行<code>C</code>语言的过程化程序设计，又可以进行以抽象数据类型为特点的基于对象的程序设计，还可以进行面向对象的程序设计，并且还支持泛型编程，并且增加了许多有用的库（<code>C++</code>是<code>C</code>的超集，包含C的内容，兼容C的运行）。</p>
<blockquote>
<p>补充：有关<code>Bjarne Stroustrup</code>，您可以去他的<a target="_blank" rel="noopener" href="https://www.stroustrup.com/">Bjarne Stroustrup的个人博客</a>那里逛一下。</p>
</blockquote>
<p>学习<code>C++</code>语言，最直接的好处是：可以明白<code>C</code>语言设计不合理的地方，明白面向对象编程是怎么一回事，交织<code>C</code>和<code>C++</code>可以窥探对现代编程语言的变化。</p>
<h1 id="2-C-发展简史"><a href="#2-C-发展简史" class="headerlink" title="2.C++发展简史"></a>2.C++发展简史</h1><ol>
<li><p><code>C with classes</code>：<code>1979</code>年贝尔实验室<code>Bjarne Stroustrup</code>等人试图分析<code>unix</code>内核的时候，将内核模块化，于是在<code>C</code>语言的基础上进行扩展，增加了类的机制，完成了一个可以运行的预处理程序，称之为<code>C with classes</code>（具备功能：类及派生类、公有和私有成员、类的构造和析构、友元、内联函数、赋值运算符、重载等）。</p>
</li>
<li><p><code>C++1.0</code>：添加虚函数概念、函数和运算符重载、引用、常量等。</p>
</li>
<li><p><code>C++2.0</code>：新增保护成员、多重继承、对象的初始化、抽象类、静态成员、const成员函数等。</p>
</li>
<li><p><code>C++3.0</code>：引入模板、解决多重继承产生的二义性问题、解决相应构造和析构的处理。</p>
</li>
<li><p><code>C++98</code>：<code>C++</code>标准的第一个版本，绝大多数编译器都支持，得到了国际标准化组织（<code>ISO</code>）和美国标准化协会认可，以模板方式重写<code>C++标准库</code>，引入了<code>STL</code>（标准模板库）</p>
</li>
<li><p><code>C++03</code>：<code>C++</code>标准第二个版本，语言特性无大改变，主要：修订错误、减少多异性</p>
</li>
<li><p><code>C++05</code>：<code>C++</code>标准委员会发布了一份计数报告（<code>Technical Report</code>，<code>TR1</code>），正式更名<code>C++0x</code>，即：计划在本世纪第一个<code>10</code>年的某个时间发布。</p>
</li>
<li><p><code>C++11</code>：增加了许多特性，使得<code>C++</code>更像一种新语言，比如：正则表达式、基于范围<code>for</code>循环、<code>auto</code>关键字、新容器、列表初始化、标准线程库等。</p>
</li>
<li><p><code>C++14</code>：对<code>C++11</code>的扩展，主要是修复<code>C++11</code>中漏洞以及改进，比如：泛型的<code>lambda</code>表达式，<code>auto</code>的返回值类型推导，二进制字面常量等。</p>
</li>
<li><p><code>C++17</code>：在<code>C++11</code>上做了一些小幅改进，增加了<code>19</code>个新特性，比如：<code>static_assert()</code>的文本信息可选，<code>Fold</code>表达式用于可变的模板，<code>if</code>和<code>switch</code>语句中的初始化器等。</p>
</li>
<li><p><code>C++20</code>：自<code>C++11</code>以来最大的发行版，引入了许多新的特性，比如：模块（<code>Modules</code>）、协程（<code>Coroutines</code>）、范围（<code>Ranges</code>）、概念（<code>Constraints</code>）等重大特性，还有对已有特性的更新：比如<code>Lambda</code>支持模板、范围<code>for</code>支持初始化等。</p>
</li>
</ol>
<h1 id="3-C-常见邻域"><a href="#3-C-常见邻域" class="headerlink" title="3.C++常见邻域"></a>3.C++常见邻域</h1><ol>
<li><p>操作系统或者大型系统软件开发（JVM、Office）</p>
</li>
<li><p>服务器端开发</p>
</li>
<li><p>游戏开发（虚幻4）</p>
</li>
<li><p>嵌入式和物联网（扫地机器人）</p>
</li>
<li><p>数字图像处理（<code>Photoshop</code>）</p>
</li>
<li><p>人工智能（深度学习算法）</p>
</li>
<li><p>分布式应用</p>
</li>
</ol>
<h1 id="4-C-阅读书籍"><a href="#4-C-阅读书籍" class="headerlink" title="4.C++阅读书籍"></a>4.C++阅读书籍</h1><h1 id="5-C-学习层次"><a href="#5-C-学习层次" class="headerlink" title="5.C++学习层次"></a>5.C++学习层次</h1><p>以下引用自<code>2010</code>年<code>8</code>月号《程序员》刊登的拙文《<code>C++</code>强大背后》最后一段</p>
<ol>
<li><p>第一个层次：</p>
<p>C++基础</p>
</li>
<li><p>第二个层次：正确高效的使用C++：</p>
<p>开始自修，阅读过《<code>(More)Effective C++</code>》、《<code>(More)Exceptional C++</code>》、《<code>Effective STL</code>》及《<code>C++</code>编程规范》等，踏入专业<code>C++</code>开发之路;</p>
</li>
<li><p>第三个层次，深入解读C++：</p>
<p>关于全局问题可读《深入探索C++对象模型》、《<code>Imperfect C++</code>》、《<code>C++</code>沉思录》、《<code>STL</code>源码剖析》，要挑战智商，可看关于模版及模版元编程的书籍如《<code>C++ Templates</code>》、《<code>C++</code>设计新思维》、《<code>C++</code>模版元编程》</p>
</li>
<li><p>第四个层次，研究C++：</p>
<p>阅读《<code>C++</code>语言的设计和演化》、《编程的本质》（含<code>STL</code>设计背后的数学根基）、<code>C++</code>标准文件《<code>ISO/IEC 14882:2003</code>》、<code>C++</code>标准委员会的提案书和报告书、关于<code>C++</code>的学术文献。<code>C++</code>只是软件开发的一环而已，单凭语言并不能应付业务和工程上的问题。不要强求几年内“彻底学会<code>C++</code>的知识”，到达第二层左右便从工作实战中汲取经验，有兴趣才慢慢继续学习更高层次的知识。</p>
</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/12/01/018+limou+2023_9_22+C++%E7%9A%84priority_queue%E7%9A%84%E6%A8%A1%E6%8B%9F%E5%AE%9E%E7%8E%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="limou3434">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2023/12/01/018+limou+2023_9_22+C++%E7%9A%84priority_queue%E7%9A%84%E6%A8%A1%E6%8B%9F%E5%AE%9E%E7%8E%B0/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2023-12-01T16:34:49+08:00">
                2023-12-01
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;deque&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">namespace</span> limou</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//1.仿函数（也可以自己在main()内部实现，符合自己的要求）</span></span><br><span class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">less</span><span class="comment">//仿函数（传递仿函数类型就可以做到：给模板传递类型后，只需要在内部创建对象（甚至匿名对象）就可以携带很多的成员函数，这比单纯使用函数指针来说厉害多了）</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="type">bool</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="type">const</span> T&amp; x, <span class="type">const</span> T&amp; y)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> x &lt; y;<span class="comment">//另外这里也可以使用对象比较（只要有重载）</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">greater</span><span class="comment">//仿函数</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="type">bool</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="type">const</span> T&amp; x, <span class="type">const</span> T&amp; y)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> x &gt; y;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">//2.类模板</span></span><br><span class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> Container = std::vector&lt;T&gt;, <span class="keyword">typename</span> Comapre = less&lt;T&gt;&gt;<span class="comment">//默认大堆</span></span><br><span class="line">    <span class="keyword">class</span> PriorityQueue</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="keyword">private</span>:</span><br><span class="line">        Comapre com;</span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">adjust_up</span><span class="params">(<span class="type">int</span> child_i)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="type">int</span> parent_i = (child_i - <span class="number">1</span>) / <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">while</span> (child_i &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="built_in">com</span>(_con[parent_i], _con[child_i]))<span class="comment">//如果是匿名对象就可以写成Compre()(_con[parent_i], _con[child_i])，虽然奇怪但是也有很多人使用</span></span><br><span class="line">                &#123;</span><br><span class="line">                    std::<span class="built_in">swap</span>(_con[parent_i], _con[child_i]);</span><br><span class="line">                    child_i = parent_i;</span><br><span class="line">                    parent_i = (child_i - <span class="number">1</span>) / <span class="number">2</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">adjust_down</span><span class="params">(<span class="type">size_t</span> parent_i)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="type">size_t</span> child_i = parent_i * <span class="number">2</span> + <span class="number">1</span>;<span class="comment">//直接先求出左孩子，注意右孩子不存在的情况</span></span><br><span class="line">            <span class="keyword">while</span> (child_i &lt; _con.<span class="built_in">size</span>())</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (child_i + <span class="number">1</span> &lt; _con.<span class="built_in">size</span>() &amp;&amp; <span class="built_in">com</span>(_con[child_i], _con[child_i + <span class="number">1</span>]))<span class="comment">//选出最大孩子的下标</span></span><br><span class="line">                &#123;</span><br><span class="line">                    child_i++;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (<span class="built_in">com</span>(_con[parent_i], _con[child_i]))</span><br><span class="line">                &#123;</span><br><span class="line">                    std::<span class="built_in">swap</span>(_con[child_i], _con[parent_i]);</span><br><span class="line">                    parent_i = child_i;</span><br><span class="line">                    child_i = parent_i * <span class="number">2</span> + <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">push</span><span class="params">(<span class="type">const</span> T&amp; val)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            _con.<span class="built_in">push_back</span>(val);<span class="comment">//插入数组的末尾</span></span><br><span class="line">            <span class="built_in">adjust_up</span>(_con.<span class="built_in">size</span>() - <span class="number">1</span>);<span class="comment">//使用向上调整算法</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">pop</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            std::<span class="built_in">swap</span>(_con[<span class="number">0</span>], _con[_con.<span class="built_in">size</span>() - <span class="number">1</span>]);<span class="comment">//交换数组首位元素</span></span><br><span class="line">            _con.<span class="built_in">pop_back</span>();<span class="comment">//删除最后一个元素</span></span><br><span class="line">            <span class="built_in">adjust_down</span>(<span class="number">0</span>);<span class="comment">//使用向下调整算法</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="type">const</span> T&amp; <span class="title">top</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> _con[<span class="number">0</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="type">size_t</span> <span class="title">size</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> _con.<span class="built_in">size</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="type">bool</span> <span class="title">empty</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> _con.<span class="built_in">empty</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">private</span>:</span><br><span class="line">        Container _con;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/12/01/016+limou+2023_8_17+C++%E7%9A%84stack%E5%92%8Cqueue%E7%B1%BB%E6%A8%A1%E6%9D%BF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="limou3434">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2023/12/01/016+limou+2023_8_17+C++%E7%9A%84stack%E5%92%8Cqueue%E7%B1%BB%E6%A8%A1%E6%9D%BF/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2023-12-01T16:34:49+08:00">
                2023-12-01
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="1-栈（stack）"><a href="#1-栈（stack）" class="headerlink" title="1.栈（stack）"></a>1.栈（stack）</h1><p><a target="_blank" rel="noopener" href="https://legacy.cplusplus.com/reference/stack/stack/">栈接口</a>查询手册。</p>
<h1 id="2-队列（queue）"><a href="#2-队列（queue）" class="headerlink" title="2.队列（queue）"></a>2.队列（queue）</h1><p><a target="_blank" rel="noopener" href="https://legacy.cplusplus.com/reference/queue/queue/">队列</a>接口查询手册。</p>
<blockquote>
<p>和我们之前讲的<code>vector</code>、<code>list</code>的容器不一样，栈和队列内部有<code>适配器</code>。</p>
<ol>
<li><p>前者<code>vector</code>、<code>list</code>都是自己直接管理数据</p>
</li>
<li><p>而后者<code>stack</code>和<code>queue</code>是在其他容器的基础上封装转化出需要的数据。</p>
</li>
</ol>
</blockquote>
<h1 id="3-相关题目练习"><a href="#3-相关题目练习" class="headerlink" title="3.相关题目练习"></a>3.相关题目练习</h1><h2 id="3-1-栈的压入、弹出序列"><a href="#3-1-栈的压入、弹出序列" class="headerlink" title="3.1.栈的压入、弹出序列"></a>3.1.<a target="_blank" rel="noopener" href="https://www.nowcoder.com/practice/d77d11405cc7470d82554cb392585106?tpId=13&tqId=11174&ru=/exam/oj">栈的压入、弹出序列</a></h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * 代码中的类名、方法名、参数名已经指定，请勿修改，直接返回方法规定的值即可</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * @param pushV int整型vector</span></span><br><span class="line"><span class="comment">     * @param popV int整型vector</span></span><br><span class="line"><span class="comment">     * @return bool布尔型</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">IsPopOrder</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; pushV, vector&lt;<span class="type">int</span>&gt;&amp; popV)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">//0.规定pushV为入栈序列，popV为出栈序列</span></span><br><span class="line">        <span class="comment">//1.入栈序列先入栈s</span></span><br><span class="line">        <span class="comment">//2.s的栈顶数据和出栈序列比较</span></span><br><span class="line">            <span class="comment">//a.如果匹配，出栈序列++，出s的栈顶元素，继续比较，直到栈为空，或者不匹配，回到1步骤</span></span><br><span class="line">            <span class="comment">//b.如果不匹配，回到步骤1</span></span><br><span class="line">        <span class="comment">//3.如果一直走到出栈序列结束就返回true</span></span><br><span class="line">        stack&lt;<span class="type">int</span>&gt; s;</span><br><span class="line">        <span class="type">int</span> pushVIndex = <span class="number">0</span>, popVIndex = <span class="number">0</span>;</span><br><span class="line">        s.<span class="built_in">push</span>(pushV[pushVIndex++]);</span><br><span class="line">        <span class="keyword">while</span> (popVIndex &lt; popV.<span class="built_in">size</span>())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (s.<span class="built_in">empty</span>() || s.<span class="built_in">top</span>() != popV[popVIndex])</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (pushVIndex &gt; pushV.<span class="built_in">size</span>())</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                s.<span class="built_in">push</span>(pushV[pushVIndex]);</span><br><span class="line">                pushVIndex++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (s.<span class="built_in">top</span>() == popV[popVIndex])</span><br><span class="line">            &#123;</span><br><span class="line">                popVIndex++;</span><br><span class="line">                s.<span class="built_in">pop</span>();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="3-2-最小栈"><a href="#3-2-最小栈" class="headerlink" title="3.2.最小栈"></a>3.2.<a target="_blank" rel="noopener" href="https://leetcode.cn/problems/min-stack/">最小栈</a></h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MinStack</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">MinStack</span>()</span><br><span class="line">    &#123;&#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">push</span><span class="params">(<span class="type">int</span> val)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        s1.<span class="built_in">push</span>(val);</span><br><span class="line">        <span class="keyword">if</span> (!s2.<span class="built_in">empty</span>())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (val &lt;= s2.<span class="built_in">top</span>())</span><br><span class="line">            &#123;</span><br><span class="line">                s2.<span class="built_in">push</span>(val);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span><span class="comment">//空</span></span><br><span class="line">        &#123;</span><br><span class="line">            s2.<span class="built_in">push</span>(val);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">pop</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (s1.<span class="built_in">empty</span>())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (s1.<span class="built_in">top</span>() == s2.<span class="built_in">top</span>())</span><br><span class="line">        &#123;</span><br><span class="line">            s1.<span class="built_in">pop</span>();</span><br><span class="line">            s2.<span class="built_in">pop</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            s1.<span class="built_in">pop</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">top</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> s1.<span class="built_in">top</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">getMin</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> s2.<span class="built_in">top</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    stack&lt;<span class="type">int</span>&gt; s1;</span><br><span class="line">    stack&lt;<span class="type">int</span>&gt; s2;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/12/01/015+limou+2023_8_17+C++%E7%9A%84list%E7%B1%BB%E6%A8%A1%E6%9D%BF%E7%9A%84%E6%A8%A1%E6%8B%9F%E5%AE%9E%E7%8E%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="limou3434">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2023/12/01/015+limou+2023_8_17+C++%E7%9A%84list%E7%B1%BB%E6%A8%A1%E6%9D%BF%E7%9A%84%E6%A8%A1%E6%8B%9F%E5%AE%9E%E7%8E%B0/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2023-12-01T16:34:49+08:00">
                2023-12-01
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><code>list</code>的类模板模拟实现</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> std::cout; </span><br><span class="line"><span class="keyword">using</span> std::cin;</span><br><span class="line"><span class="keyword">using</span> std::endl;</span><br><span class="line"><span class="keyword">namespace</span> limou</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//1.Node节点结构体</span></span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">list_node</span></span><br><span class="line">    &#123;</span><br><span class="line">        T _data;</span><br><span class="line">        list_node&lt;T&gt;* _next;</span><br><span class="line">        list_node&lt;T&gt;* _prev;</span><br><span class="line">        <span class="comment">//构造函数</span></span><br><span class="line">        <span class="built_in">list_node</span>(<span class="type">const</span> T&amp; x = <span class="built_in">T</span>())<span class="comment">//注意不能给0，因为不一定是int，这个内置类型有了模板之后就升级了，也有构造函数了</span></span><br><span class="line">            : _data(x)</span><br><span class="line">            , _next(<span class="literal">nullptr</span>)</span><br><span class="line">            , _prev(<span class="literal">nullptr</span>)</span><br><span class="line">        &#123;&#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2.迭代器结构体（合二为一）</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//2.1.可修改迭代器</span></span><br><span class="line">    <span class="comment">//template&lt;typename T&gt;</span></span><br><span class="line">    <span class="comment">//struct __list_iterator</span></span><br><span class="line">    <span class="comment">//&#123;</span></span><br><span class="line">    <span class="comment">//    typedef list_node&lt;T&gt; Node;</span></span><br><span class="line">    <span class="comment">//    typedef __list_iterator&lt;T&gt; iterator;</span></span><br><span class="line">    <span class="comment">//    Node* _node;</span></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="comment">//    //构造函数</span></span><br><span class="line">    <span class="comment">//    __list_iterator(Node* x)</span></span><br><span class="line">    <span class="comment">//        : _node(x)</span></span><br><span class="line">    <span class="comment">//    &#123;&#125;</span></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="comment">//    iterator&amp; operator++()</span></span><br><span class="line">    <span class="comment">//    &#123;</span></span><br><span class="line">    <span class="comment">//        _node = _node-&gt;_next;</span></span><br><span class="line">    <span class="comment">//        return *this;</span></span><br><span class="line">    <span class="comment">//    &#125;</span></span><br><span class="line">    <span class="comment">//    iterator operator++(int)</span></span><br><span class="line">    <span class="comment">//    &#123;</span></span><br><span class="line">    <span class="comment">//        iterator tmp(*this);</span></span><br><span class="line">    <span class="comment">//        _node = _node-&gt;_next;</span></span><br><span class="line">    <span class="comment">//        return tmp;</span></span><br><span class="line">    <span class="comment">//    &#125;</span></span><br><span class="line">    <span class="comment">//    iterator&amp; operator--()</span></span><br><span class="line">    <span class="comment">//    &#123;</span></span><br><span class="line">    <span class="comment">//        _node = _node-&gt;_prev;</span></span><br><span class="line">    <span class="comment">//        return *this;</span></span><br><span class="line">    <span class="comment">//    &#125;</span></span><br><span class="line">    <span class="comment">//    iterator operator--(int)</span></span><br><span class="line">    <span class="comment">//    &#123;</span></span><br><span class="line">    <span class="comment">//        iterator tmp(*this);</span></span><br><span class="line">    <span class="comment">//        _node = _node-&gt;_prev;</span></span><br><span class="line">    <span class="comment">//        return tmp;</span></span><br><span class="line">    <span class="comment">//    &#125;</span></span><br><span class="line">    <span class="comment">//    T&amp; operator*()</span></span><br><span class="line">    <span class="comment">//    &#123;</span></span><br><span class="line">    <span class="comment">//        return _node-&gt;_data;</span></span><br><span class="line">    <span class="comment">//    &#125;</span></span><br><span class="line">    <span class="comment">//    T* operator-&gt;()//这个&quot;-&gt;&quot;符重载是比较奇怪的</span></span><br><span class="line">    <span class="comment">//    &#123;</span></span><br><span class="line">    <span class="comment">//        return &amp;_node-&gt;_data;</span></span><br><span class="line">    <span class="comment">//        </span></span><br><span class="line">    <span class="comment">//        //假设某个自定义类A(内部又成员_a)使用了list&lt;A&gt; li来存储A类型对象，</span></span><br><span class="line">    <span class="comment">//        //list&lt;A&gt;::iterator it = li.begin()</span></span><br><span class="line">    <span class="comment">//        //而我们解引用迭代器是为了得到“节点内部的A类型内部的_a”</span></span><br><span class="line">    <span class="comment">//        //cout &lt;&lt; *(li)._a &lt;&lt; endl;    //没问题（这里使用了两次解引用）</span></span><br><span class="line">    <span class="comment">//        //cout &lt;&lt; li-&gt;_a &lt;&lt; endl;    //出现问题（必须重载&quot;-&gt;&quot;）</span></span><br><span class="line">    <span class="comment">//        //cout &lt;&lt; li.operator-&gt;()-&gt;_a &lt;&lt; endl;//由于可读性不好，编译器特殊化后，省略了一个&quot;-&gt;&quot;</span></span><br><span class="line">    <span class="comment">//    &#125;</span></span><br><span class="line">    <span class="comment">//    bool operator!=(const iterator&amp; s)</span></span><br><span class="line">    <span class="comment">//    &#123;</span></span><br><span class="line">    <span class="comment">//        return _node != s._node;</span></span><br><span class="line">    <span class="comment">//    &#125;</span></span><br><span class="line">    <span class="comment">//    bool operator==(const iterator&amp; s)</span></span><br><span class="line">    <span class="comment">//    &#123;</span></span><br><span class="line">    <span class="comment">//        return _node == s._node;</span></span><br><span class="line">    <span class="comment">//    &#125;</span></span><br><span class="line">    <span class="comment">//&#125;;</span></span><br><span class="line">    <span class="comment">////2.2.只可读迭代器</span></span><br><span class="line">    <span class="comment">//template&lt;typename T&gt;</span></span><br><span class="line">    <span class="comment">//struct __list_const_iterator</span></span><br><span class="line">    <span class="comment">//&#123;</span></span><br><span class="line">    <span class="comment">//    //需要注意的是，常量迭代器不是在迭代器类型前加上const就可以了，否则迭代器本身没有办法进行迭代修改，进而进行读取</span></span><br><span class="line">    <span class="comment">//    typedef list_node&lt;T&gt; Node;</span></span><br><span class="line">    <span class="comment">//    typedef __list_const_iterator&lt;T&gt; const_iterator;</span></span><br><span class="line">    <span class="comment">//    Node* _node;</span></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="comment">//    //构造函数</span></span><br><span class="line">    <span class="comment">//    __list_const_iterator(Node* x) </span></span><br><span class="line">    <span class="comment">//        : _node(x)</span></span><br><span class="line">    <span class="comment">//    &#123;&#125;</span></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="comment">//    const_iterator&amp; operator++()</span></span><br><span class="line">    <span class="comment">//    &#123;</span></span><br><span class="line">    <span class="comment">//        _node = _node-&gt;_next;</span></span><br><span class="line">    <span class="comment">//        return *this;</span></span><br><span class="line">    <span class="comment">//    &#125;</span></span><br><span class="line">    <span class="comment">//    const_iterator operator++(int)</span></span><br><span class="line">    <span class="comment">//    &#123;</span></span><br><span class="line">    <span class="comment">//        const_iterator tmp(*this);</span></span><br><span class="line">    <span class="comment">//        _node = _node-&gt;_next;</span></span><br><span class="line">    <span class="comment">//        return tmp;</span></span><br><span class="line">    <span class="comment">//    &#125;</span></span><br><span class="line">    <span class="comment">//    const_iterator&amp; operator--()</span></span><br><span class="line">    <span class="comment">//    &#123;</span></span><br><span class="line">    <span class="comment">//        _node = _node-&gt;_prev;</span></span><br><span class="line">    <span class="comment">//        return *this;</span></span><br><span class="line">    <span class="comment">//    &#125;</span></span><br><span class="line">    <span class="comment">//    const_iterator operator--(int)</span></span><br><span class="line">    <span class="comment">//    &#123;</span></span><br><span class="line">    <span class="comment">//        const_iterator tmp(*this);</span></span><br><span class="line">    <span class="comment">//        _node = _node-&gt;_prev;</span></span><br><span class="line">    <span class="comment">//        return tmp;</span></span><br><span class="line">    <span class="comment">//    &#125;</span></span><br><span class="line">    <span class="comment">//    const T&amp; operator*()</span></span><br><span class="line">    <span class="comment">//    &#123;</span></span><br><span class="line">    <span class="comment">//        return _node-&gt;_data;</span></span><br><span class="line">    <span class="comment">//    &#125;</span></span><br><span class="line">    <span class="comment">//    const T* operator-&gt;()//这个&quot;-&gt;&quot;符重载是比较奇怪的</span></span><br><span class="line">    <span class="comment">//    &#123;</span></span><br><span class="line">    <span class="comment">//        return &amp;_node-&gt;_data;</span></span><br><span class="line">    <span class="comment">//        //假设某个自定义类A(内部又成员_a)使用了list&lt;A&gt; li来存储A类型对象，</span></span><br><span class="line">    <span class="comment">//        //list&lt;A&gt;::iterator it = li.begin()</span></span><br><span class="line">    <span class="comment">//        //而我们解引用迭代器是为了得到“节点内部的A类型内部的_a”</span></span><br><span class="line">    <span class="comment">//        //cout &lt;&lt; *(li)._a &lt;&lt; endl;    //没问题（这里使用了两次解引用）</span></span><br><span class="line">    <span class="comment">//        //cout &lt;&lt; li-&gt;_a &lt;&lt; endl;    //出现问题（必须重载&quot;-&gt;&quot;，但是只有一次解引用了）</span></span><br><span class="line">    <span class="comment">//        //cout &lt;&lt; li.operator-&gt;()-&gt;_a &lt;&lt; endl;//由于可读性不好，编译器特殊化后，省略了一个&quot;-&gt;&quot;</span></span><br><span class="line">    <span class="comment">//    &#125;</span></span><br><span class="line">    <span class="comment">//    bool operator!=(const const_iterator&amp; s)</span></span><br><span class="line">    <span class="comment">//    &#123;</span></span><br><span class="line">    <span class="comment">//        return _node != s._node;</span></span><br><span class="line">    <span class="comment">//    &#125;</span></span><br><span class="line">    <span class="comment">//    bool operator==(const const_iterator&amp; s)</span></span><br><span class="line">    <span class="comment">//    &#123;</span></span><br><span class="line">    <span class="comment">//        return _node == s._node;</span></span><br><span class="line">    <span class="comment">//    &#125;</span></span><br><span class="line">    <span class="comment">//&#125;;</span></span><br><span class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> Ref, <span class="keyword">typename</span> Ptr&gt;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">__list_iterator</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">typedef</span> list_node&lt;T&gt; Node;</span><br><span class="line">        <span class="keyword">typedef</span> __list_iterator&lt;T, Ref, Ptr&gt; self;</span><br><span class="line">        Node* _node;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//构造函数</span></span><br><span class="line">        __list_iterator(Node* x)</span><br><span class="line">            : _node(x)</span><br><span class="line">        &#123;&#125;</span><br><span class="line"></span><br><span class="line">        self&amp; <span class="keyword">operator</span>++()</span><br><span class="line">        &#123;</span><br><span class="line">            _node = _node-&gt;_next;</span><br><span class="line">            <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        self <span class="keyword">operator</span>++(<span class="type">int</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="function">self <span class="title">tmp</span><span class="params">(*<span class="keyword">this</span>)</span></span>;</span><br><span class="line">            _node = _node-&gt;_next;</span><br><span class="line">            <span class="keyword">return</span> tmp;</span><br><span class="line">        &#125;</span><br><span class="line">        self&amp; <span class="keyword">operator</span>--()</span><br><span class="line">        &#123;</span><br><span class="line">            _node = _node-&gt;_prev;</span><br><span class="line">            <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        self <span class="keyword">operator</span>--(<span class="type">int</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="function">self <span class="title">tmp</span><span class="params">(*<span class="keyword">this</span>)</span></span>;</span><br><span class="line">            _node = _node-&gt;_prev;</span><br><span class="line">            <span class="keyword">return</span> tmp;</span><br><span class="line">        &#125;</span><br><span class="line">        Ref <span class="keyword">operator</span>*()</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> _node-&gt;_data;</span><br><span class="line">        &#125;</span><br><span class="line">        Ptr <span class="keyword">operator</span>-&gt;()</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> &amp;_node-&gt;_data;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">bool</span> <span class="keyword">operator</span>!=(<span class="type">const</span> self&amp; s)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> _node != s._node;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">bool</span> <span class="keyword">operator</span>==(<span class="type">const</span> self&amp; s)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> _node == s._node;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//3.list容器</span></span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">list</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">typedef</span> list_node&lt;T&gt; Node;<span class="comment">//节点结构体被重命名</span></span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        <span class="keyword">typedef</span> __list_iterator&lt;T, T&amp;, T*&gt; iterator;<span class="comment">//迭代器结构体被重命名</span></span><br><span class="line">        <span class="keyword">typedef</span> __list_iterator&lt;T, <span class="type">const</span> T&amp;, <span class="type">const</span> T*&gt; const_iterator;<span class="comment">//迭代器结构体被重命名</span></span><br><span class="line">        <span class="comment">//typedef __list_const_iterator&lt;T&gt; const_iterator;//迭代器结构体被重命名</span></span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">empty_init</span><span class="params">()</span><span class="comment">//空初始化函数，由于后面有很多该操作，故专门写成一个函数</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            _head = <span class="keyword">new</span> Node;</span><br><span class="line">            _head-&gt;_next = _head;</span><br><span class="line">            _head-&gt;_prev = _head;</span><br><span class="line">            _head-&gt;_data = <span class="built_in">T</span>();</span><br><span class="line"></span><br><span class="line">            _size = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//3.1.Member functions</span></span><br><span class="line">        <span class="built_in">list</span>()<span class="comment">//初始化好头节点</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">empty_init</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">list</span>(list&lt;T&gt;&amp; li)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">empty_init</span>();</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">auto</span> e : li)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">push_back</span>(e);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        list&lt;T&gt;&amp; <span class="keyword">operator</span>=(list&lt;T&gt; tmp)<span class="comment">//拷贝构造一份</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//1.传统写法</span></span><br><span class="line">            <span class="comment">//if (this != &amp;lt)</span></span><br><span class="line">            <span class="comment">//&#123;</span></span><br><span class="line">            <span class="comment">//    clear();</span></span><br><span class="line">            <span class="comment">//    for (auto e : lt)</span></span><br><span class="line">            <span class="comment">//    &#123;</span></span><br><span class="line">            <span class="comment">//        push_back(e);</span></span><br><span class="line">            <span class="comment">//    &#125;</span></span><br><span class="line">            <span class="comment">//&#125;</span></span><br><span class="line">            <span class="comment">//return *this;</span></span><br><span class="line">            <span class="comment">//2.现代写法</span></span><br><span class="line">            <span class="built_in">swap</span>(tmp);</span><br><span class="line">            <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//3.2.Iterators</span></span><br><span class="line">        <span class="function">iterator <span class="title">begin</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> _head-&gt;_next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function">iterator <span class="title">end</span><span class="params">()</span><span class="comment">//实际上是返回哨兵位节点</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> _head;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function">const_iterator <span class="title">begin</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> _head-&gt;_next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function">const_iterator <span class="title">end</span><span class="params">()</span> <span class="type">const</span><span class="comment">//实际上是返回哨兵位节点</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> _head;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//3.3.Capacity</span></span><br><span class="line">        <span class="function"><span class="type">size_t</span> <span class="title">size</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> _size;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//3.4.Element access</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//3.5.Modifiers</span></span><br><span class="line">        <span class="function">iterator <span class="title">inster</span><span class="params">(iterator pos, <span class="type">const</span> T&amp; x)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="comment">//在pos前插入</span></span><br><span class="line">            Node* newNode = <span class="keyword">new</span> <span class="built_in">Node</span>(x);</span><br><span class="line"></span><br><span class="line">            Node* cur = pos._node;</span><br><span class="line">            Node* prev = cur-&gt;_prev;</span><br><span class="line"></span><br><span class="line">            prev-&gt;_next = newNode;</span><br><span class="line">            newNode-&gt;_prev = prev;</span><br><span class="line">            newNode-&gt;_next = cur;</span><br><span class="line">            cur-&gt;_prev = newNode;</span><br><span class="line"></span><br><span class="line">            _size++;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">iterator</span>(newNode);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function">iterator <span class="title">erase</span><span class="params">(iterator pos)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            Node* cur = pos._node;</span><br><span class="line">            Node* prev = cur-&gt;_prev;</span><br><span class="line">            Node* next = cur-&gt;_next;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">delete</span> cur;</span><br><span class="line">            prev-&gt;_next = next;</span><br><span class="line">            next-&gt;_prev = prev;</span><br><span class="line">            _size--;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">iterator</span>(next);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">push_back</span><span class="params">(<span class="type">const</span> T&amp; x)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="built_in">inster</span>(<span class="built_in">end</span>(), x);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">pop_back</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="built_in">erase</span>(--<span class="built_in">end</span>());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">push_front</span><span class="params">(<span class="type">const</span> T&amp; x)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="built_in">inster</span>(<span class="built_in">begin</span>(), x);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">pop_front</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="built_in">erase</span>(<span class="built_in">begin</span>());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">clear</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            iterator it = <span class="built_in">begin</span>();</span><br><span class="line">            <span class="keyword">while</span> (it != <span class="built_in">end</span>())</span><br><span class="line">            &#123;</span><br><span class="line">                it = <span class="built_in">erase</span>(it);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//3.6.Operations</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//3.7.Observers</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//3.8.Non-member function overloads</span></span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">swap</span><span class="params">(list&lt;T&gt;&amp; li)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            std::<span class="built_in">swap</span>(_head, li._head);</span><br><span class="line">            std::<span class="built_in">swap</span>(_size, li._size);</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">private</span>:</span><br><span class="line">        Node* _head;</span><br><span class="line">        <span class="type">size_t</span> _size;<span class="comment">//方便事先size()，避免效率底下</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">test_1</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        list&lt;<span class="type">int</span>&gt; l1;</span><br><span class="line">        l1.<span class="built_in">push_back</span>(<span class="number">1</span>);</span><br><span class="line">        l1.<span class="built_in">push_back</span>(<span class="number">2</span>);</span><br><span class="line">        l1.<span class="built_in">push_back</span>(<span class="number">3</span>);</span><br><span class="line">        l1.<span class="built_in">push_back</span>(<span class="number">4</span>);</span><br><span class="line">        l1.<span class="built_in">push_back</span>(<span class="number">5</span>);</span><br><span class="line"></span><br><span class="line">        list&lt;<span class="type">int</span>&gt;::iterator it = l1.<span class="built_in">begin</span>();</span><br><span class="line">        <span class="keyword">while</span> (it != l1.<span class="built_in">end</span>())</span><br><span class="line">        &#123;</span><br><span class="line">            cout &lt;&lt; *it &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">            (*it) += <span class="number">50</span>;</span><br><span class="line">            ++it;</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> in : l1)</span><br><span class="line">        &#123;</span><br><span class="line">            cout &lt;&lt; in &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; endl;</span><br><span class="line">        <span class="comment">//迭代器的使用体现了封装的优势</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">test_2</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        list&lt;<span class="type">int</span>&gt; l1;</span><br><span class="line">        l1.<span class="built_in">push_back</span>(<span class="number">1</span>);</span><br><span class="line">        l1.<span class="built_in">push_back</span>(<span class="number">2</span>);</span><br><span class="line">        l1.<span class="built_in">push_back</span>(<span class="number">3</span>);</span><br><span class="line">        l1.<span class="built_in">push_front</span>(<span class="number">1</span>);</span><br><span class="line">        l1.<span class="built_in">push_front</span>(<span class="number">2</span>);</span><br><span class="line">        l1.<span class="built_in">push_front</span>(<span class="number">3</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> in : l1)</span><br><span class="line">        &#123;</span><br><span class="line">            cout &lt;&lt; in &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; endl;</span><br><span class="line">        l1.<span class="built_in">pop_back</span>();</span><br><span class="line">        l1.<span class="built_in">pop_front</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> in : l1)</span><br><span class="line">        &#123;</span><br><span class="line">            cout &lt;&lt; in &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; endl;</span><br><span class="line">        l1.<span class="built_in">clear</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> in : l1)</span><br><span class="line">        &#123;</span><br><span class="line">            cout &lt;&lt; in &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">test_3</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        list&lt;<span class="type">double</span>&gt; l1;</span><br><span class="line">        l1.<span class="built_in">push_back</span>(<span class="number">1.2</span>);</span><br><span class="line">        l1.<span class="built_in">push_back</span>(<span class="number">5.0</span>);</span><br><span class="line">        l1.<span class="built_in">push_back</span>(<span class="number">1.3</span>);</span><br><span class="line">        l1.<span class="built_in">push_back</span>(<span class="number">0.89</span>);</span><br><span class="line">        l1.<span class="built_in">push_back</span>(<span class="number">-0.12</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> e : l1)</span><br><span class="line">        &#123;</span><br><span class="line">            cout &lt;&lt; e &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; l1.<span class="built_in">size</span>() &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">        <span class="function">list&lt;<span class="type">double</span>&gt; <span class="title">l2</span><span class="params">(l1)</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> e : l1)</span><br><span class="line">        &#123;</span><br><span class="line">            cout &lt;&lt; e &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; l2.<span class="built_in">size</span>() &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">        list&lt;<span class="type">double</span>&gt; l3;</span><br><span class="line">        l3 = l2;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> e : l3)</span><br><span class="line">        &#123;</span><br><span class="line">            cout &lt;&lt; e &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; l3.<span class="built_in">size</span>() &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">test_4</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        list&lt;<span class="type">int</span>&gt; l1;</span><br><span class="line">        l1.<span class="built_in">push_back</span>(<span class="number">1</span>);</span><br><span class="line">        l1.<span class="built_in">push_back</span>(<span class="number">2</span>);</span><br><span class="line">        l1.<span class="built_in">push_back</span>(<span class="number">3</span>);</span><br><span class="line">        l1.<span class="built_in">push_back</span>(<span class="number">4</span>);</span><br><span class="line">        l1.<span class="built_in">push_back</span>(<span class="number">5</span>);</span><br><span class="line">        <span class="type">const</span> list&lt;<span class="type">int</span>&gt; l2 = l1;</span><br><span class="line">        list&lt;<span class="type">int</span>&gt;::const_iterator it = l2.<span class="built_in">begin</span>();</span><br><span class="line">        <span class="keyword">while</span> (it != l2.<span class="built_in">end</span>())</span><br><span class="line">        &#123;</span><br><span class="line">            cout &lt;&lt; *it &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">            it++;</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">test_5</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">class</span> <span class="title class_">A</span></span><br><span class="line">        &#123;</span><br><span class="line">        <span class="keyword">public</span>:</span><br><span class="line">            <span class="type">int</span> _a = <span class="number">1</span>;</span><br><span class="line">        &#125;;</span><br><span class="line">        list&lt;A&gt; li;</span><br><span class="line">        A a1;</span><br><span class="line">        A a2;</span><br><span class="line">        A a3;</span><br><span class="line">        li.<span class="built_in">push_back</span>(a1);</span><br><span class="line">        li.<span class="built_in">push_back</span>(a2);</span><br><span class="line">        li.<span class="built_in">push_back</span>(a3);</span><br><span class="line"></span><br><span class="line">        list&lt;A&gt;:: iterator it = li.<span class="built_in">begin</span>();</span><br><span class="line"></span><br><span class="line">        cout &lt;&lt; (*it)._a &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">        cout &lt;&lt; it-&gt;_a &lt;&lt; endl;<span class="comment">//it.operator-&gt;()-&gt;_a</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span></span><br><span class="line"><span class="function">    <span class="type">void</span> <span class="title">print_list</span><span class="params">(<span class="type">const</span> list&lt;T&gt;&amp; li)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">typename</span> list&lt;T&gt;::const_iterator it = li.<span class="built_in">begin</span>();<span class="comment">//这里必须加上typename，不然该函数在编译期间无法确认实例化（静态成员变量？类型？）</span></span><br><span class="line">        <span class="comment">//因此上述的关键字typename就是告诉编译器这是一个类型，等list&lt;T&gt;实例化了再去类里面取</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (it != li.<span class="built_in">end</span>())</span><br><span class="line">        &#123;</span><br><span class="line">            cout &lt;&lt; *it &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">            it++;</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> Container&gt;</span></span><br><span class="line"><span class="function">    <span class="type">void</span> <span class="title">print_container</span><span class="params">(<span class="type">const</span> Container&amp; con)</span><span class="comment">//针对所有容器</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">typename</span> Container::const_iterator it = con.<span class="built_in">begin</span>();<span class="comment">//这里必须加上typename，不然该函数在编译期间无法确认实例化（静态成员变量？类型？）</span></span><br><span class="line">        <span class="comment">//因此上述的关键字typename就是告诉编译器这是一个类型，等list&lt;T&gt;实例化了再去类里面取</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (it != con.<span class="built_in">end</span>())</span><br><span class="line">        &#123;</span><br><span class="line">            cout &lt;&lt; *it &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">            it++;</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">test_6</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        list&lt;<span class="type">int</span>&gt; l1;</span><br><span class="line">        l1.<span class="built_in">push_back</span>(<span class="number">1</span>);</span><br><span class="line">        l1.<span class="built_in">push_back</span>(<span class="number">2</span>);</span><br><span class="line">        l1.<span class="built_in">push_back</span>(<span class="number">3</span>);</span><br><span class="line">        <span class="built_in">print_list</span>(l1);</span><br><span class="line"></span><br><span class="line">        list&lt;std::string&gt; l2;</span><br><span class="line">        l2.<span class="built_in">push_back</span>(<span class="string">&quot;aaaa&quot;</span>);</span><br><span class="line">        l2.<span class="built_in">push_back</span>(<span class="string">&quot;abbb&quot;</span>);</span><br><span class="line">        l2.<span class="built_in">push_back</span>(<span class="string">&quot;cccc&quot;</span>);</span><br><span class="line">        l2.<span class="built_in">push_back</span>(<span class="string">&quot;dddd&quot;</span>);</span><br><span class="line">        <span class="built_in">print_list</span>(l2);</span><br><span class="line"></span><br><span class="line">        std::vector&lt;std::string&gt; v;</span><br><span class="line">        v.<span class="built_in">push_back</span>(<span class="string">&quot;1111&quot;</span>);</span><br><span class="line">        v.<span class="built_in">push_back</span>(<span class="string">&quot;2222&quot;</span>);</span><br><span class="line">        v.<span class="built_in">push_back</span>(<span class="string">&quot;3333&quot;</span>);</span><br><span class="line">        v.<span class="built_in">push_back</span>(<span class="string">&quot;4444&quot;</span>);</span><br><span class="line">        <span class="built_in">print_container</span>(v);<span class="comment">//这个函数的强大体现了泛型编程</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/12/01/014+limou+2023_8_14+C++%E7%9A%84vector%E7%B1%BB%E6%A8%A1%E6%9D%BF%E7%9A%84%E6%A8%A1%E6%8B%9F%E5%AE%9E%E7%8E%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="limou3434">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2023/12/01/014+limou+2023_8_14+C++%E7%9A%84vector%E7%B1%BB%E6%A8%A1%E6%9D%BF%E7%9A%84%E6%A8%A1%E6%8B%9F%E5%AE%9E%E7%8E%B0/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2023-12-01T16:34:49+08:00">
                2023-12-01
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>下面代码是有关于<code>vector</code>的一些基础实现，和库里的函数可能有较大的不同，但是基本可以实现<code>vector</code>的很多功能。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cassert&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">看源代码不要上来就一行一行看，先看文档再进行使用，再整理框架（梳理类、变量、接口），然后“连蒙带猜”验证细节</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">namespace</span> limou</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">vector</span></span><br><span class="line">    &#123;</span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        <span class="keyword">typedef</span> T* iterator;</span><br><span class="line">        <span class="keyword">typedef</span> <span class="type">const</span> T* const_iterator;</span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        <span class="comment">//1.Menber function</span></span><br><span class="line">        <span class="built_in">vector</span>()</span><br><span class="line">            : _start(<span class="literal">nullptr</span>)</span><br><span class="line">            , _finish(<span class="literal">nullptr</span>)</span><br><span class="line">            , _end_of_storage(<span class="literal">nullptr</span>)</span><br><span class="line">        &#123;&#125;</span><br><span class="line">        <span class="keyword">template</span> &lt;<span class="keyword">typename</span> InputIterator&gt;<span class="comment">//这里之所以又嵌套一个类模板的原因是：能够使用多种种类的迭代器，而不当当是T类型的迭代器</span></span><br><span class="line">        <span class="built_in">vector</span>(InputIterator first, InputIterator last)</span><br><span class="line">            : _start(<span class="literal">nullptr</span>)</span><br><span class="line">            , _finish(<span class="literal">nullptr</span>)</span><br><span class="line">            , _end_of_storage(<span class="literal">nullptr</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">while</span> (first != last)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">push_back</span>(*first);</span><br><span class="line">                ++first;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">vector</span>(<span class="type">const</span> vector&lt;T&gt;&amp; v)</span><br><span class="line">            : _start(<span class="literal">nullptr</span>)</span><br><span class="line">            , _finish(<span class="literal">nullptr</span>)</span><br><span class="line">            , _end_of_storage(<span class="literal">nullptr</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">reserve</span>(v.<span class="built_in">capacity</span>());</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; e : v)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">push_back</span>(e);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">vector</span>(<span class="type">size_t</span> n, <span class="type">const</span> T&amp; val = <span class="built_in">T</span>())<span class="comment">//构造一个匿名对象，并且自动初始化</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">reserve</span>(n);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">push_back</span>(val);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">vector</span>(<span class="type">int</span> n, <span class="type">const</span> T&amp; val = <span class="built_in">T</span>())<span class="comment">//这个函数是专门给部分类型准备的（比如int）不重载就会调用成迭代器初始化</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">reserve</span>(n);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">push_back</span>(val);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        vector&lt;T&gt;&amp; <span class="keyword">operator</span>=(vector tmp)<span class="comment">//先拷贝一份，另外这里提一嘴，在类里面写成vector和vector&lt;T&gt;是一样的，当然我们建议写全</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">swap</span>(tmp);</span><br><span class="line">            <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        ~<span class="built_in">vector</span>()</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">delete</span>[] _start;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//2.Iterator</span></span><br><span class="line">        <span class="function">iterator <span class="title">begin</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> _start;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function">iterator <span class="title">end</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> _finish;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function">const_iterator <span class="title">begin</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> _start;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function">const_iterator <span class="title">end</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> _finish;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//3.Capacity</span></span><br><span class="line">        <span class="function"><span class="type">size_t</span> <span class="title">size</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> _finish - _start;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="type">size_t</span> <span class="title">capacity</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> _end_of_storage - _start;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//3.1.使用memcpy()会引发深浅拷贝的问题，因此不可以使用这个函数</span></span><br><span class="line">        <span class="comment">//void reserve(size_t n)</span></span><br><span class="line">        <span class="comment">//&#123;</span></span><br><span class="line">        <span class="comment">//    if (n &gt; capacity())//如果指定的数字大于现有容量就扩容</span></span><br><span class="line">        <span class="comment">//    &#123;</span></span><br><span class="line">        <span class="comment">//        T* tmp = new T[n];</span></span><br><span class="line">        <span class="comment">//        size_t sz = size();</span></span><br><span class="line">        <span class="comment">//        if (_start)//如果不是空容器</span></span><br><span class="line">        <span class="comment">//        &#123;</span></span><br><span class="line">        <span class="comment">//            memcpy(tmp, _start, sizeof(T) * sz);</span></span><br><span class="line">        <span class="comment">//            delete[] _start;//这里有可能因为浅拷贝而出事</span></span><br><span class="line">        <span class="comment">//        &#125;</span></span><br><span class="line">        <span class="comment">//        _start = tmp;//由于这里更换成了tmp</span></span><br><span class="line">        <span class="comment">//        _finish = tmp + sz;//而这里原本的_finish是指向别的空间指针，所以必须要修改</span></span><br><span class="line">        <span class="comment">//        _end_of_storage = tmp + n;//同理这里也做修改</span></span><br><span class="line">        <span class="comment">//    &#125;</span></span><br><span class="line">        <span class="comment">//&#125;</span></span><br><span class="line">        <span class="comment">//3.2.拷贝数据如果使用拷贝构造</span></span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">reserve</span><span class="params">(<span class="type">size_t</span> n)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (n &gt; <span class="built_in">capacity</span>())<span class="comment">//如果指定的数字大于现有容量就扩容</span></span><br><span class="line">            &#123;</span><br><span class="line">                T* tmp = <span class="keyword">new</span> T[n];</span><br><span class="line">                <span class="type">size_t</span> sz = <span class="built_in">size</span>();</span><br><span class="line">                <span class="keyword">if</span> (_start)<span class="comment">//如果不是空容器</span></span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="comment">//memcpy(tmp, _start, sizeof(T) * sz);</span></span><br><span class="line">                    <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; sz; i++)</span><br><span class="line">                    &#123;</span><br><span class="line">                        tmp[i] = _start[i];</span><br><span class="line">                        <span class="comment">//这样子做可以自动调用不同类型的深拷贝（赋值运算重载），</span></span><br><span class="line">                        <span class="comment">//这个深拷贝有可能是我们写的也有可能是库里的……</span></span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">delete</span>[] _start;</span><br><span class="line">                &#125;</span><br><span class="line">                _start = tmp;<span class="comment">//由于这里更换成了tmp</span></span><br><span class="line">                _finish = _start + sz;<span class="comment">//而这里原本的_finish是指向别的空间指针，所以必须要修改</span></span><br><span class="line">                _end_of_storage = _start + n;<span class="comment">//同理这里也做修改</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//3.3.当然，还有一种方法是使用引用计数，不过这个方法我们暂时不讲（这个地方如果是类似string类型使用引用计数效率就会有很大的提高）</span></span><br><span class="line">        <span class="comment">//3.4.另外，库中的实现使用了拷贝构造，因为人家使用的是定位new，因此可以调用，而我们自己是直接使用new的，已经存在两个对象了，只能使用赋值重载</span></span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">resize</span><span class="params">(<span class="type">size_t</span> n, <span class="type">const</span> T&amp; val = T())</span></span></span><br><span class="line"><span class="function">            <span class="comment">//这里给了默认匿名参数T()，</span></span></span><br><span class="line"><span class="function">            <span class="comment">//注意匿名对象具有常属性，</span></span></span><br><span class="line"><span class="function">            <span class="comment">//这也是为什么在C++之后支持“int i = int(3);”</span></span></span><br><span class="line"><span class="function">            <span class="comment">//这种语法就是因为：</span></span></span><br><span class="line"><span class="function">            <span class="comment">//在类模板出现后没有办法确认是内置类型，还是自定义类型</span></span></span><br><span class="line"><span class="function">            <span class="comment">//并且还会给与自定义类型默认值</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (n &lt;= <span class="built_in">size</span>())</span><br><span class="line">            &#123;</span><br><span class="line">                _finish = _start + n;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">reserve</span>(n);</span><br><span class="line">            <span class="keyword">while</span> (_finish &lt; _start + n)</span><br><span class="line">            &#123;</span><br><span class="line">                *_finish = val;</span><br><span class="line">                _finish++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//4.Element access</span></span><br><span class="line">        T&amp; <span class="keyword">operator</span>[](<span class="type">size_t</span> pos)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">assert</span>(pos &lt; <span class="built_in">size</span>());</span><br><span class="line">            <span class="keyword">return</span> _start[pos];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">const</span> T&amp; <span class="keyword">operator</span>[](<span class="type">size_t</span> pos) <span class="type">const</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">assert</span>(pos &lt; <span class="built_in">size</span>());</span><br><span class="line">            <span class="keyword">return</span> _start[pos];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//5.Modifiers</span></span><br><span class="line">        <span class="comment">//注意insert()和erase()在使用过后迭代器都会失效，在库中就可以利用返回值来解决这个问题，我们自己实现的就没有实现insert()的返回值</span></span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">push_back</span><span class="params">(<span class="type">const</span> T&amp; x)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="comment">//if (_finish == _end_of_storage)//如果容量不足</span></span><br><span class="line">            <span class="comment">//&#123;</span></span><br><span class="line">            <span class="comment">//    reserve(capacity() == 0 ? 4 : capacity() * 2);//2倍容量</span></span><br><span class="line">            <span class="comment">//&#125;</span></span><br><span class="line">            <span class="comment">//*_finish = x;</span></span><br><span class="line">            <span class="comment">//_finish++;</span></span><br><span class="line">            <span class="built_in">insert</span>(<span class="built_in">end</span>(), x);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(iterator pos, <span class="type">const</span> T&amp; x)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="comment">//检验是否合法</span></span><br><span class="line">            <span class="built_in">assert</span>(pos &gt;= _start);</span><br><span class="line">            <span class="built_in">assert</span>(pos &lt;= _finish);</span><br><span class="line">            <span class="keyword">if</span> (_finish == _end_of_storage)<span class="comment">//如果容量不足</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="type">size_t</span> len = pos - _start;</span><br><span class="line">                <span class="built_in">reserve</span>(<span class="built_in">capacity</span>() == <span class="number">0</span> ? <span class="number">4</span> : <span class="built_in">capacity</span>() * <span class="number">2</span>);<span class="comment">//2倍容量</span></span><br><span class="line">                pos = _start + len;</span><br><span class="line">                <span class="comment">//上面这里还解决了迭代器失效的问题。</span></span><br><span class="line">                <span class="comment">//由于扩容导致的问题，pos指向旧空间的某个位置时，</span></span><br><span class="line">                <span class="comment">//旧空间没了，没能指向新空间，因此这里必须进行更新。</span></span><br><span class="line"></span><br><span class="line">                <span class="comment">//但是由于这里没有办法使用引用（传过来的pos迭代器是一个值），</span></span><br><span class="line">                <span class="comment">//因此本函数insert()使用过后迭代器就会失效，只能保证在本函数内有效。</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            iterator end = _finish - <span class="number">1</span>;</span><br><span class="line">            <span class="comment">//1,2,3,4,5</span></span><br><span class="line">           <span class="comment">//^       ^</span></span><br><span class="line">            <span class="keyword">while</span> (end &gt;= pos)</span><br><span class="line">            &#123;</span><br><span class="line">                *(end + <span class="number">1</span>) = *end;</span><br><span class="line">                end--;</span><br><span class="line">            &#125;</span><br><span class="line">            *pos = x;</span><br><span class="line">            _finish++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//1.第一种erase的书写解决不了迭代器失效的问题</span></span><br><span class="line">        <span class="comment">//void erase(iterator pos)</span></span><br><span class="line">        <span class="comment">//&#123;</span></span><br><span class="line">        <span class="comment">//    //检验是否合法</span></span><br><span class="line">        <span class="comment">//    assert(pos &gt;= _start);</span></span><br><span class="line">        <span class="comment">//    assert(pos &lt;= _finish);</span></span><br><span class="line">        <span class="comment">//    //&#123;1,2,3,4,5&#125;</span></span><br><span class="line">        <span class="comment">//    //pos-&gt;3,it-&gt;4,&#123;1,2,4,5&#125;</span></span><br><span class="line">        <span class="comment">//    //&#123;1&#125;,pos-&gt;1,it=_finish</span></span><br><span class="line">        <span class="comment">//    iterator it = pos + 1;</span></span><br><span class="line">        <span class="comment">//    while (it &lt; _finish)</span></span><br><span class="line">        <span class="comment">//    &#123;</span></span><br><span class="line">        <span class="comment">//        *(it - 1) = *it;</span></span><br><span class="line">        <span class="comment">//        it++;</span></span><br><span class="line">        <span class="comment">//    &#125;</span></span><br><span class="line">        <span class="comment">//    --_finish;</span></span><br><span class="line">        <span class="comment">//&#125;</span></span><br><span class="line">        <span class="comment">//2.第二种可以解决迭代器失效的问题，返回的是原pos的后一个数据的迭代器，也就是删除后pos的位置</span></span><br><span class="line">        <span class="function">iterator <span class="title">erase</span><span class="params">(iterator pos)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="comment">//检验是否合法</span></span><br><span class="line">            <span class="built_in">assert</span>(pos &gt;= _start);</span><br><span class="line">            <span class="built_in">assert</span>(pos &lt;= _finish);</span><br><span class="line">            <span class="comment">//&#123;1,2,3,4,5&#125;</span></span><br><span class="line">            <span class="comment">//pos-&gt;3,it-&gt;4,&#123;1,2,4,5&#125;</span></span><br><span class="line">            <span class="comment">//&#123;1&#125;,pos-&gt;1,it=_finish</span></span><br><span class="line">            iterator it = pos + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">while</span> (it &lt; _finish)</span><br><span class="line">            &#123;</span><br><span class="line">                *(it - <span class="number">1</span>) = *it;</span><br><span class="line">                it++;</span><br><span class="line">            &#125;</span><br><span class="line">            --_finish;</span><br><span class="line">            <span class="keyword">return</span> pos;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//6.other</span></span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">swap</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; v)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            std::<span class="built_in">swap</span>(_start, v._start);</span><br><span class="line">            std::<span class="built_in">swap</span>(_finish, v._finish);</span><br><span class="line">            std::<span class="built_in">swap</span>(_end_of_storage, v._end_of_storage);</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">private</span>:</span><br><span class="line">        <span class="comment">//三个迭代器成员变量</span></span><br><span class="line">        iterator _start;<span class="comment">//指向“存储空间”或者“存储”开始的位置</span></span><br><span class="line">        iterator _finish;<span class="comment">//指向“存储”结束的位置</span></span><br><span class="line">        iterator _end_of_storage;<span class="comment">//指向“存储空间”结束的位置</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">test_1</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; v1;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            v1.<span class="built_in">push_back</span>(i);</span><br><span class="line">            std::cout &lt;&lt; v1[i]++ &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        std::cout &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">        vector&lt;<span class="type">int</span>&gt;::iterator it = v1.<span class="built_in">begin</span>();</span><br><span class="line">        <span class="keyword">while</span> (it != v1.<span class="built_in">end</span>())</span><br><span class="line">        &#123;</span><br><span class="line">            std::cout &lt;&lt; (*it++)++ &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        std::cout &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> in : v1)</span><br><span class="line">        &#123;</span><br><span class="line">            std::cout &lt;&lt; in &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">const</span> vector&lt;<span class="type">float</span>&gt; v2;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//for (int i = 0; i &lt; 10; i++)</span></span><br><span class="line">        <span class="comment">//&#123;</span></span><br><span class="line">        <span class="comment">//    v2.push_back((float)i + 0.1);</span></span><br><span class="line">        <span class="comment">//    std::cout &lt;&lt; v2[i]++ &lt;&lt; &quot; &quot;;</span></span><br><span class="line">        <span class="comment">//&#125;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">test_2</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; v1;</span><br><span class="line">        v1.<span class="built_in">resize</span>(<span class="number">5</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> in : v1)</span><br><span class="line">        &#123;</span><br><span class="line">            std::cout &lt;&lt; in &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        &#125;std::cout &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">        vector&lt;<span class="type">int</span>*&gt; v2;</span><br><span class="line">        v2.<span class="built_in">resize</span>(<span class="number">5</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> p : v2)</span><br><span class="line">        &#123;</span><br><span class="line">            std::cout &lt;&lt; (<span class="type">void</span>*)p &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        &#125;std::cout &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">        vector&lt;std::string&gt; v3;</span><br><span class="line">        v3.<span class="built_in">resize</span>(<span class="number">5</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> str3 : v3)</span><br><span class="line">        &#123;</span><br><span class="line">            std::cout &lt;&lt; <span class="string">&quot;空字符=[&quot;</span> &lt;&lt; str3 &lt;&lt; <span class="string">&quot;]&quot;</span> &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        &#125;std::cout &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">        vector&lt;std::string&gt; v4;</span><br><span class="line">        v4.<span class="built_in">resize</span>(<span class="number">5</span>, <span class="string">&quot;abcd&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> str4 : v4)</span><br><span class="line">        &#123;</span><br><span class="line">            std::cout &lt;&lt; <span class="string">&quot;字符=[&quot;</span> &lt;&lt; str4 &lt;&lt; <span class="string">&quot;]&quot;</span> &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        &#125;std::cout &lt;&lt; std::endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">test_3</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; v1;</span><br><span class="line">        v1.<span class="built_in">insert</span>(v1.<span class="built_in">begin</span>(), <span class="number">1</span>);</span><br><span class="line">        v1.<span class="built_in">insert</span>(v1.<span class="built_in">begin</span>() + <span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">        v1.<span class="built_in">insert</span>(v1.<span class="built_in">begin</span>() + <span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> in : v1)</span><br><span class="line">        &#123;</span><br><span class="line">            std::cout &lt;&lt; in &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        std::cout &lt;&lt; std::endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">test_4</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; v1;</span><br><span class="line">        v1.<span class="built_in">push_back</span>(<span class="number">1</span>);<span class="comment">//内部使用了一次insert()因此迭代器失效</span></span><br><span class="line">        std::cout &lt;&lt; v1[v1.<span class="built_in">size</span>() - <span class="number">1</span>] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        v1.<span class="built_in">push_back</span>(<span class="number">2</span>);<span class="comment">//但是又重新使用insert()的时候重新计算了迭代器，使用后迭代器又失效了</span></span><br><span class="line">        std::cout &lt;&lt; v1[v1.<span class="built_in">size</span>() - <span class="number">1</span>] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        v1.<span class="built_in">push_back</span>(<span class="number">3</span>);</span><br><span class="line">        std::cout &lt;&lt; v1[v1.<span class="built_in">size</span>() - <span class="number">1</span>] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        std::cout &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; v2;</span><br><span class="line">        v2.<span class="built_in">insert</span>(v2.<span class="built_in">begin</span>(), <span class="number">1</span>);<span class="comment">//内部使用了一次insert()因此迭代器失效</span></span><br><span class="line">        std::cout &lt;&lt; v2[v2.<span class="built_in">size</span>() - <span class="number">1</span>] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        v2.<span class="built_in">insert</span>(v2.<span class="built_in">begin</span>(), <span class="number">2</span>);<span class="comment">//但是又重新使用insert()的时候重新计算了迭代器，使用后迭代器又失效了</span></span><br><span class="line">        std::cout &lt;&lt; v2[v2.<span class="built_in">size</span>() - <span class="number">2</span>] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        v2.<span class="built_in">insert</span>(v2.<span class="built_in">begin</span>(), <span class="number">3</span>);</span><br><span class="line">        std::cout &lt;&lt; v2[v2.<span class="built_in">size</span>() - <span class="number">3</span>] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        std::cout &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//错误示例（因为迭代器失效）</span></span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; v3;</span><br><span class="line">        v3.<span class="built_in">insert</span>(v3.<span class="built_in">begin</span>(), <span class="number">4</span>);</span><br><span class="line">        v3.<span class="built_in">insert</span>(v3.<span class="built_in">begin</span>(), <span class="number">3</span>);</span><br><span class="line">        v3.<span class="built_in">insert</span>(v3.<span class="built_in">begin</span>(), <span class="number">2</span>);</span><br><span class="line">        vector&lt;<span class="type">int</span>&gt;::iterator it = v3.<span class="built_in">begin</span>();</span><br><span class="line">        v3.<span class="built_in">insert</span>(it, <span class="number">1</span>);<span class="comment">//这个语句过后迭代器失效了</span></span><br><span class="line">        v3.<span class="built_in">insert</span>(it, <span class="number">0</span>);</span><br><span class="line">        v3.<span class="built_in">insert</span>(it, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">7</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            std::cout &lt;&lt; v3[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        &#125;std::cout &lt;&lt; std::endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">test_5</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">////1.使用erase()的时候一般不会出现迭代器失效的问题</span></span><br><span class="line">        <span class="comment">//vector&lt;int&gt; v;</span></span><br><span class="line">        <span class="comment">//v.push_back(0);</span></span><br><span class="line">        <span class="comment">//std::cout &lt;&lt; v[0] &lt;&lt; std::endl;</span></span><br><span class="line">        <span class="comment">//v.erase(v.begin());</span></span><br><span class="line">        <span class="comment">//v.push_back(1);</span></span><br><span class="line">        <span class="comment">//v.push_back(2);</span></span><br><span class="line">        <span class="comment">//v.push_back(3);</span></span><br><span class="line">        <span class="comment">//v.push_back(4);</span></span><br><span class="line">        <span class="comment">//vector&lt;int&gt;::iterator it = v.begin();</span></span><br><span class="line">        <span class="comment">//while (it != v.end())</span></span><br><span class="line">        <span class="comment">//&#123;</span></span><br><span class="line">        <span class="comment">//    std::cout &lt;&lt; *it &lt;&lt; &quot; &quot;;</span></span><br><span class="line">        <span class="comment">//    it++;</span></span><br><span class="line">        <span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//2.但是有一种情况会很危险</span></span><br><span class="line">        <span class="comment">//假设我们要删除一组数据中的偶数</span></span><br><span class="line">        <span class="comment">//可以试一下数据</span></span><br><span class="line">        <span class="comment">//&#123;1,2,3,4,5&#125;正常</span></span><br><span class="line">        <span class="comment">//&#123;1,2,3,4,5,6&#125;奔溃</span></span><br><span class="line">        <span class="comment">//&#123;2,2,3,4,5&#125;结果不对</span></span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; vbug;</span><br><span class="line">        vbug.<span class="built_in">push_back</span>(<span class="number">1</span>);</span><br><span class="line">        vbug.<span class="built_in">push_back</span>(<span class="number">2</span>);</span><br><span class="line">        vbug.<span class="built_in">push_back</span>(<span class="number">3</span>);</span><br><span class="line">        vbug.<span class="built_in">push_back</span>(<span class="number">4</span>);</span><br><span class="line">        vbug.<span class="built_in">push_back</span>(<span class="number">5</span>);</span><br><span class="line">        vbug.<span class="built_in">push_back</span>(<span class="number">6</span>);</span><br><span class="line">        vbug.<span class="built_in">push_back</span>(<span class="number">7</span>);</span><br><span class="line">        vbug.<span class="built_in">push_back</span>(<span class="number">8</span>);</span><br><span class="line">        vbug.<span class="built_in">push_back</span>(<span class="number">9</span>);</span><br><span class="line">        vbug.<span class="built_in">push_back</span>(<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">auto</span> it = vbug.<span class="built_in">begin</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//1.错误使用</span></span><br><span class="line">        <span class="comment">//while (it != vbug.end())</span></span><br><span class="line">        <span class="comment">//&#123;</span></span><br><span class="line">        <span class="comment">//    if (*it % 2 == 0)</span></span><br><span class="line">        <span class="comment">//    &#123;</span></span><br><span class="line">        <span class="comment">//        vbug.erase(it);</span></span><br><span class="line">        <span class="comment">//    &#125;</span></span><br><span class="line">        <span class="comment">//    //对于&#123;1,2,3,4,5,6,7,8,9,10&#125;</span></span><br><span class="line">        <span class="comment">//    //当最后一步只剩下&#123;1,3,5,7,9,10&#125;的时候</span></span><br><span class="line">        <span class="comment">//    //it-&gt;10,_finish-&gt;10后面的空间，因此在erase的时候，删除10的步骤就是_finish--</span></span><br><span class="line">        <span class="comment">//    //但是循环条件处的end()指向的位置还是原本的_finish位置</span></span><br><span class="line">        <span class="comment">//    it++;</span></span><br><span class="line">        <span class="comment">//    //而上面的一步又使得it++,it-&gt;旧的_finish</span></span><br><span class="line">        <span class="comment">//    //而回到循环条件的时候end()重新进行了计算（更新为新的_finish--）</span></span><br><span class="line">        <span class="comment">//    //此时it和end()错位，*it访问了野指针</span></span><br><span class="line">        <span class="comment">//  //导致迭代器失效</span></span><br><span class="line">        <span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//for (auto e : vbug)</span></span><br><span class="line">        <span class="comment">//&#123;</span></span><br><span class="line">        <span class="comment">//    std::cout &lt;&lt; e &lt;&lt; &quot; &quot;;</span></span><br><span class="line">        <span class="comment">//&#125;</span></span><br><span class="line">        <span class="comment">//std::cout &lt;&lt; std::endl;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//2.debug后</span></span><br><span class="line">        <span class="keyword">while</span> (it != vbug.<span class="built_in">end</span>())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (*it % <span class="number">2</span> == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                vbug.<span class="built_in">erase</span>(it);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (it == vbug.<span class="built_in">end</span>())</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            it++;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> e : vbug)</span><br><span class="line">        &#123;</span><br><span class="line">            std::cout &lt;&lt; e &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        std::cout &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3.使用总结</span></span><br><span class="line">        <span class="comment">//但是实际上如果数据存在连续的偶数，即使是debug后的版本也会出现问题（上面代码能过只是巧合）</span></span><br><span class="line">        <span class="comment">//因此在后期就会引入一些智能指针的解决方案</span></span><br><span class="line">        <span class="comment">//因此我们认为使用erase()后会导致之前的迭代器失效</span></span><br><span class="line">     &#125;</span><br><span class="line">    <span class="comment">//关于迭代器失效的其中一个解决方案就是修改返回值的类型</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">test_6</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; v;</span><br><span class="line">        v.<span class="built_in">push_back</span>(<span class="number">1</span>);</span><br><span class="line">        v.<span class="built_in">push_back</span>(<span class="number">2</span>);</span><br><span class="line">        v.<span class="built_in">push_back</span>(<span class="number">2</span>);</span><br><span class="line">        v.<span class="built_in">push_back</span>(<span class="number">3</span>);</span><br><span class="line">        v.<span class="built_in">push_back</span>(<span class="number">4</span>);</span><br><span class="line">        v.<span class="built_in">push_back</span>(<span class="number">5</span>);</span><br><span class="line">        v.<span class="built_in">push_back</span>(<span class="number">6</span>);</span><br><span class="line">        v.<span class="built_in">push_back</span>(<span class="number">6</span>);</span><br><span class="line"></span><br><span class="line">        vector&lt;<span class="type">int</span>&gt;::iterator it = v.<span class="built_in">begin</span>();</span><br><span class="line">        <span class="keyword">while</span> (it != v.<span class="built_in">end</span>())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (*it % <span class="number">2</span> == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                it = v.<span class="built_in">erase</span>(it);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                it++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; v.<span class="built_in">size</span>(); i++)</span><br><span class="line">        &#123;</span><br><span class="line">            std::cout &lt;&lt; v[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">test_7</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        vector&lt;std::string&gt; v1;</span><br><span class="line">        v1.<span class="built_in">push_back</span>(<span class="string">&quot;1111111111111111111111&quot;</span>);</span><br><span class="line">        v1.<span class="built_in">push_back</span>(<span class="string">&quot;1111111111111111111111&quot;</span>);</span><br><span class="line">        v1.<span class="built_in">push_back</span>(<span class="string">&quot;1111111111111111111111&quot;</span>);</span><br><span class="line">        v1.<span class="built_in">push_back</span>(<span class="string">&quot;1111111111111111111111&quot;</span>);</span><br><span class="line">        v1.<span class="built_in">push_back</span>(<span class="string">&quot;1111111111111111111111&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> e : v1)</span><br><span class="line">        &#123;</span><br><span class="line">            std::cout &lt;&lt; e &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        std::cout &lt;&lt; std::endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">test_8</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; v1;</span><br><span class="line">        v1.<span class="built_in">push_back</span>(<span class="number">1</span>);</span><br><span class="line">        v1.<span class="built_in">push_back</span>(<span class="number">2</span>);</span><br><span class="line">        v1.<span class="built_in">push_back</span>(<span class="number">3</span>);</span><br><span class="line">        v1.<span class="built_in">push_back</span>(<span class="number">4</span>);</span><br><span class="line">        v1.<span class="built_in">push_back</span>(<span class="number">5</span>);</span><br><span class="line">        <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">v2</span><span class="params">(v1)</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; e : v1)</span><br><span class="line">        &#123;</span><br><span class="line">            std::cout &lt;&lt; e &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        std::cout &lt;&lt; std::endl;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; e : v2)</span><br><span class="line">        &#123;</span><br><span class="line">            std::cout &lt;&lt; e &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        std::cout &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; v3;</span><br><span class="line">        v3 = v2;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; e : v3)</span><br><span class="line">        &#123;</span><br><span class="line">            std::cout &lt;&lt; e &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        std::cout &lt;&lt; std::endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">test_9</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; v1;</span><br><span class="line">        v1.<span class="built_in">push_back</span>(<span class="number">1</span>);</span><br><span class="line">        v1.<span class="built_in">push_back</span>(<span class="number">2</span>);</span><br><span class="line">        v1.<span class="built_in">push_back</span>(<span class="number">3</span>);</span><br><span class="line">        v1.<span class="built_in">push_back</span>(<span class="number">4</span>);</span><br><span class="line">        v1.<span class="built_in">push_back</span>(<span class="number">5</span>);</span><br><span class="line">        <span class="function">std::string <span class="title">str</span><span class="params">(<span class="string">&quot;abcdef&quot;</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">        <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">v2</span><span class="params">(v1.begin(), v1.end())</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; v2.<span class="built_in">size</span>(); i++)</span><br><span class="line">        &#123;</span><br><span class="line">            std::cout &lt;&lt; v2[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        &#125;std::cout &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">        <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">v3</span><span class="params">(str.begin() + <span class="number">1</span>, str.end() - <span class="number">1</span>)</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; v3.<span class="built_in">size</span>(); j++)</span><br><span class="line">        &#123;</span><br><span class="line">            std::cout &lt;&lt; v3[j] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        &#125;std::cout &lt;&lt; std::endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">test_10</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">v1</span><span class="params">(<span class="number">10</span>, <span class="number">1</span>)</span></span>;</span><br><span class="line">        <span class="function">vector&lt;std::string&gt; <span class="title">v2</span><span class="params">(<span class="number">5</span>, <span class="string">&quot;xxxx&quot;</span>)</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; v1.<span class="built_in">size</span>(); i++)</span><br><span class="line">        &#123;</span><br><span class="line">            std::cout &lt;&lt; v1[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        std::cout &lt;&lt; std::endl;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; v2.<span class="built_in">size</span>(); j++)</span><br><span class="line">        &#123;</span><br><span class="line">            std::cout &lt;&lt; v2[j] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        std::cout &lt;&lt; std::endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">vector没有流重载，因为很奇怪，您无法知道按照什么样的格式进行输出和输入</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>



          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/12/01/013+limou+2023_8_12+C++%E7%9A%84list%E7%B1%BB%E6%A8%A1%E6%9D%BF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="limou3434">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2023/12/01/013+limou+2023_8_12+C++%E7%9A%84list%E7%B1%BB%E6%A8%A1%E6%9D%BF/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2023-12-01T16:34:49+08:00">
                2023-12-01
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="1-list的基础认知"><a href="#1-list的基础认知" class="headerlink" title="1.list的基础认知"></a>1.list的基础认知</h1><p><code>list</code>实际上是一个带头双向链表的容器，允许在序列内的任何位置执行时间复杂度为<code>O(1)</code>插入和删除操作。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt; <span class="keyword">class</span> <span class="title class_">T</span>, <span class="keyword">class</span> <span class="title class_">Alloc</span> = allocator&lt;T&gt; &gt; <span class="keyword">class</span> list;</span><br></pre></td></tr></table></figure>

<h1 id="2-成员函数（Member-functions）"><a href="#2-成员函数（Member-functions）" class="headerlink" title="2.成员函数（Member functions）"></a>2.成员函数（Member functions）</h1><h2 id="2-1-构造函数"><a href="#2-1-构造函数" class="headerlink" title="2.1.构造函数"></a>2.1.构造函数</h2><h2 id="2-2-析构函数"><a href="#2-2-析构函数" class="headerlink" title="2.2.析构函数"></a>2.2.析构函数</h2><h2 id="2-3-拷贝构造和赋值重载"><a href="#2-3-拷贝构造和赋值重载" class="headerlink" title="2.3.拷贝构造和赋值重载"></a>2.3.拷贝构造和赋值重载</h2><h1 id="3-迭代器（Iterators）"><a href="#3-迭代器（Iterators）" class="headerlink" title="3.迭代器（Iterators）"></a>3.迭代器（Iterators）</h1><h1 id="4-容积（Capacity）"><a href="#4-容积（Capacity）" class="headerlink" title="4.容积（Capacity）"></a>4.容积（Capacity）</h1><h2 id="4-1-empty"><a href="#4-1-empty" class="headerlink" title="4.1.empty()"></a>4.1.empty()</h2><p>测试容器是否为空。</p>
<h2 id="4-2-size"><a href="#4-2-size" class="headerlink" title="4.2.size()"></a>4.2.size()</h2><p>返回大小。</p>
<h2 id="4-3-max-size"><a href="#4-3-max-size" class="headerlink" title="4.3.max_size"></a>4.3.max_size</h2><p>返回最大大小。</p>
<h1 id="5-元素访问（Element-access）"><a href="#5-元素访问（Element-access）" class="headerlink" title="5.元素访问（Element access）"></a>5.元素访问（Element access）</h1><h2 id="5-1-front"><a href="#5-1-front" class="headerlink" title="5.1.front()"></a>5.1.front()</h2><p>访问第一个元素。</p>
<h2 id="5-2-back"><a href="#5-2-back" class="headerlink" title="5.2.back()"></a>5.2.back()</h2><p>访问最后一个元素。</p>
<h1 id="6-修改器（Modifiers）"><a href="#6-修改器（Modifiers）" class="headerlink" title="6.修改器（Modifiers）"></a>6.修改器（Modifiers）</h1><h2 id="6-1-assign"><a href="#6-1-assign" class="headerlink" title="6.1.assign()"></a>6.1.assign()</h2><p>将新内容分配给容器。</p>
<h2 id="6-2-emplace-front"><a href="#6-2-emplace-front" class="headerlink" title="6.2.emplace_front()"></a>6.2.emplace_front()</h2><p>在开头构造和插入元素。</p>
<h2 id="6-3-push-front"><a href="#6-3-push-front" class="headerlink" title="6.3.push_front()"></a>6.3.push_front()</h2><p>在开头插入元素。</p>
<h2 id="6-4-pop-front"><a href="#6-4-pop-front" class="headerlink" title="6.4.pop_front()"></a>6.4.pop_front()</h2><p>删除第一个元素。</p>
<h2 id="6-5-emplace-back"><a href="#6-5-emplace-back" class="headerlink" title="6.5.emplace_back()"></a>6.5.emplace_back()</h2><p>在末尾构造和插入元素。</p>
<h2 id="6-6-push-back"><a href="#6-6-push-back" class="headerlink" title="6.6.push_back()"></a>6.6.push_back()</h2><p>在末尾添加元素。</p>
<h2 id="6-7-pop-back"><a href="#6-7-pop-back" class="headerlink" title="6.7.pop_back()"></a>6.7.pop_back()</h2><p>删除最后一个元素。</p>
<h2 id="6-8-emplace"><a href="#6-8-emplace" class="headerlink" title="6.8.emplace()"></a>6.8.emplace()</h2><p>构造和插入元素。</p>
<h2 id="6-9-insert"><a href="#6-9-insert" class="headerlink" title="6.9.insert()"></a>6.9.insert()</h2><p>插入元素。</p>
<h2 id="6-10-erase"><a href="#6-10-erase" class="headerlink" title="6.10.erase()"></a>6.10.erase()</h2><p>擦除元素。</p>
<h2 id="6-11-swap"><a href="#6-11-swap" class="headerlink" title="6.11.swap()"></a>6.11.swap()</h2><p>交换内容。</p>
<h2 id="6-12-resize"><a href="#6-12-resize" class="headerlink" title="6.12.resize()"></a>6.12.resize()</h2><p>更改大小。</p>
<h2 id="6-13-clear"><a href="#6-13-clear" class="headerlink" title="6.13.clear()"></a>6.13.clear()</h2><p>内容清晰。</p>
<h1 id="7-操作（Operations）"><a href="#7-操作（Operations）" class="headerlink" title="7.操作（Operations）"></a>7.操作（Operations）</h1><h2 id="7-1-splice"><a href="#7-1-splice" class="headerlink" title="7.1.splice()"></a>7.1.splice()</h2><p>将元素直接从一个列表拼接到另一个列表。</p>
<h2 id="7-2-remove"><a href="#7-2-remove" class="headerlink" title="7.2.remove()"></a>7.2.remove()</h2><p>删除具有特定值的元素。</p>
<h2 id="7-3-remove-if-和remove-if"><a href="#7-3-remove-if-和remove-if" class="headerlink" title="7.3.remove_if()和remove_if()"></a>7.3.remove_if()和remove_if()</h2><p>删除满足条件的元素。</p>
<h2 id="7-4-unique"><a href="#7-4-unique" class="headerlink" title="7.4.unique()"></a>7.4.unique()</h2><p>在有序的链表中去除掉重复的节点。</p>
<h2 id="7-5-merge"><a href="#7-5-merge" class="headerlink" title="7.5.merge()"></a>7.5.merge()</h2><p>将两个有序链表归并在一起（取小的节点尾插）。</p>
<h2 id="7-6-sort"><a href="#7-6-sort" class="headerlink" title="7.6.sort()"></a>7.6.sort()</h2><p>这个排序区别与算法内部的排序有所区分，并且链表不可以直接使用算法库里的<code>sort()</code>，这涉及到迭代器的分类。<code>list</code>的成员函数<code>sort()</code>底层是归并排序。并且该函数在大数据量的情况下效率也一般，只是使用上比较方便（在实践中直接对链表排序也是挺少见的，更常见的做法是：将<code>list</code>中的数据拷贝到<code>vector</code>里，在<code>vector</code>中进行排序，再拷贝回去，而拷贝数据的代价并不算很大）。</p>
<blockquote>
<p>在功能上，迭代器分为：1.正向 2.反向</p>
<p>在性质上，迭代器分为：</p>
<ol>
<li><p>单向（只支持++，比如哈希表、单链表）</p>
</li>
<li><p>双向（支持++&#x2F;–，比如双向链表、红黑树（map和set））</p>
</li>
<li><p>随机（++&#x2F;–&#x2F;+&#x2F;-，vector、string、deque）</p>
</li>
</ol>
</blockquote>
<h2 id="7-7-reverse"><a href="#7-7-reverse" class="headerlink" title="7.7.reverse()"></a>7.7.reverse()</h2><h1 id="8-感测器（Observers）"><a href="#8-感测器（Observers）" class="headerlink" title="8.感测器（Observers）"></a>8.感测器（Observers）</h1><h2 id="8-1-get-allocator"><a href="#8-1-get-allocator" class="headerlink" title="8.1.get_allocator()"></a>8.1.get_allocator()</h2><h2 id="8-2-get-allocator"><a href="#8-2-get-allocator" class="headerlink" title="8.2.get_allocator()"></a>8.2.get_allocator()</h2><h1 id="9-非成员函数重载（Non-member-function-overloads）"><a href="#9-非成员函数重载（Non-member-function-overloads）" class="headerlink" title="9.非成员函数重载（Non-member function overloads）"></a>9.非成员函数重载（Non-member function overloads）</h1><blockquote>
<p>补充：在<code>list</code>的实现中，由于是链表，所以使用<code>[]</code>效率很低，因此并没有重载这一个操作符。</p>
</blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/12/01/012+limou+2023_8_12+C++%E7%9A%84vector%E7%B1%BB%E6%A8%A1%E6%9D%BF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="limou3434">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2023/12/01/012+limou+2023_8_12+C++%E7%9A%84vector%E7%B1%BB%E6%A8%A1%E6%9D%BF/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2023-12-01T16:34:49+08:00">
                2023-12-01
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="1-vector简介"><a href="#1-vector简介" class="headerlink" title="1.vector简介"></a>1.vector简介</h1><p><code>vector</code>说明白点就是一个顺序表，一个可以进行动态存储的数组，在学习<code>vector</code>之前，您要对顺序表有足够的了解，最好是造过“轮子”。</p>
<p><code>vector</code>就像数组一样，对其中内部元素使用连续的存储位置，可以使用常规指针的偏移量来访问元素，但是和普通数组不同的是，<code>vector</code>序列容器的大小可以动态变化。</p>
<p>不过需要注意的是<code>vector</code>是一个类模板，而不是我们之前提到的<code>string</code>一样一个经过实例化的类。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt; <span class="keyword">class</span> <span class="title class_">T</span>, <span class="keyword">class</span> <span class="title class_">Alloc</span> = allocator&lt;T&gt; &gt; <span class="keyword">class</span> vector;<span class="comment">//类模板声明</span></span><br></pre></td></tr></table></figure>

<h1 id="2-成员类型（Member-types）"><a href="#2-成员类型（Member-types）" class="headerlink" title="2.成员类型（Member types）"></a>2.成员类型（Member types）</h1><ol>
<li><p><code>T</code>是类模板的模板类型，由使用者决定</p>
</li>
<li><p><code>Alloc</code>参数是有关空间配置器相关的设计，这个我们暂时不用理会，这个参数是方便使用者改写空间配置器，但是基本很少改动</p>
</li>
</ol>
<h1 id="3-成员函数（Member-function）"><a href="#3-成员函数（Member-function）" class="headerlink" title="3.成员函数（Member function）"></a>3.成员函数（Member function）</h1><h2 id="3-1-构造函数vector"><a href="#3-1-构造函数vector" class="headerlink" title="3.1.构造函数vector()"></a>3.1.构造函数vector()</h2><h3 id="3-1-1-default-1-默认"><a href="#3-1-1-default-1-默认" class="headerlink" title="3.1.1.default (1) 默认"></a>3.1.1.default (1) 默认</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">explicit</span> <span class="title">vector</span> <span class="params">(<span class="type">const</span> allocator_type&amp; alloc = allocator_type())</span></span>;</span><br></pre></td></tr></table></figure>

<h3 id="3-1-2-fill-2-填充"><a href="#3-1-2-fill-2-填充" class="headerlink" title="3.1.2.fill (2) 填充"></a>3.1.2.fill (2) 填充</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">explicit</span> <span class="title">vector</span> <span class="params">(size_type n)</span></span>; </span><br><span class="line"><span class="built_in">vector</span> (size_type n, <span class="type">const</span> value_type&amp; val, <span class="type">const</span> allocator_type&amp; alloc = <span class="built_in">allocator_type</span>());</span><br></pre></td></tr></table></figure>

<h3 id="3-1-3-range-3-范围"><a href="#3-1-3-range-3-范围" class="headerlink" title="3.1.3.range (3) 范围"></a>3.1.3.range (3) 范围</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">InputIterator</span>&gt;</span><br><span class="line">  <span class="built_in">vector</span> (InputIterator first, InputIterator last, <span class="type">const</span> allocator_type&amp; alloc = <span class="built_in">allocator_type</span>());</span><br></pre></td></tr></table></figure>

<h3 id="3-1-4-copy-4-副本"><a href="#3-1-4-copy-4-副本" class="headerlink" title="3.1.4.copy (4) 副本"></a>3.1.4.copy (4) 副本</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">vector</span> (<span class="type">const</span> vector&amp; x);</span><br><span class="line"><span class="built_in">vector</span> (<span class="type">const</span> vector&amp; x, <span class="type">const</span> allocator_type&amp; alloc);</span><br></pre></td></tr></table></figure>

<h3 id="3-1-5-move-5-移动-（5）"><a href="#3-1-5-move-5-移动-（5）" class="headerlink" title="3.1.5.move (5) 移动 （5）"></a>3.1.5.move (5) 移动 （5）</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">vector</span> (vector&amp;&amp; x);</span><br><span class="line"><span class="built_in">vector</span> (vector&amp;&amp; x, <span class="type">const</span> allocator_type&amp; alloc);</span><br></pre></td></tr></table></figure>

<h3 id="3-1-6-initializer-list-6-初始值设定项列表-（6）"><a href="#3-1-6-initializer-list-6-初始值设定项列表-（6）" class="headerlink" title="3.1.6.initializer list (6) 初始值设定项列表 （6）"></a>3.1.6.initializer list (6) 初始值设定项列表 （6）</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">vector</span> (initializer_list&lt;value_type&gt; il, <span class="type">const</span> allocator_type&amp; alloc = <span class="built_in">allocator_type</span>());</span><br></pre></td></tr></table></figure>

<p>在有使用过<code>string</code>类对象的基础上，我们加快一些进度，下面是构造函数的使用例子：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//vector (const allocator_type&amp; alloc = allocator_type());</span></span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; v1;<span class="comment">//(1)默认创建一个空的vector容器</span></span><br><span class="line">    <span class="comment">//vector (size_type n);</span></span><br><span class="line">    <span class="function">vector&lt;<span class="type">double</span>&gt; <span class="title">v2</span><span class="params">(<span class="number">10</span>)</span></span>;<span class="comment">//(2)创建一个大小位10的vector容器</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//vector(size_type n, const value_type &amp; val, const allocator_type &amp; alloc = allocator_type());</span></span><br><span class="line">    <span class="function">vector&lt;<span class="type">char</span>&gt; <span class="title">v3</span><span class="params">(<span class="number">10</span>, <span class="string">&#x27;c&#x27;</span>)</span></span>;<span class="comment">//(2)创建一个大小位10的vector容器</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//&lt;class InputIterator&gt; </span></span><br><span class="line">    <span class="comment">//vector (InputIterator first, InputIterator last, const allocator_type&amp; alloc = allocator_type());</span></span><br><span class="line">    <span class="function">vector&lt;<span class="type">char</span>&gt; <span class="title">v4</span><span class="params">(v3.begin() + <span class="number">1</span>, v3.end() - <span class="number">1</span>)</span></span>;<span class="comment">//(3)</span></span><br><span class="line">    <span class="function">string <span class="title">str</span><span class="params">(<span class="string">&quot;abcdef&quot;</span>)</span></span>;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">char</span>&gt; <span class="title">vec</span><span class="params">(str.begin() + <span class="number">1</span>, str.end() - <span class="number">1</span>)</span></span>;<span class="comment">//(3)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//vector(const vector &amp; x);</span></span><br><span class="line">    <span class="function">vector&lt;<span class="type">char</span>&gt; <span class="title">v5</span><span class="params">(v3)</span></span>;<span class="comment">//(4)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//vector (vector&amp;&amp; x);</span></span><br><span class="line">    <span class="function">vector&lt;<span class="type">char</span>&gt; <span class="title">v6</span><span class="params">(move(v3))</span></span>;<span class="comment">//(5)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//vector (initializer_list&lt;value_type&gt; il, const allocator_type&amp; alloc = allocator_type());</span></span><br><span class="line">    vector&lt;<span class="type">float</span>&gt; v7&#123;<span class="number">1</span>, <span class="number">3.1</span>, <span class="number">2.3</span>, <span class="number">4.5</span>&#125;;<span class="comment">//(6)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="3-2-析构函数-vecter"><a href="#3-2-析构函数-vecter" class="headerlink" title="3.2.析构函数~vecter()"></a>3.2.析构函数~vecter()</h2><p>就是销毁<code>vecter</code>容器对象。</p>
<h2 id="3-3-赋值重载"><a href="#3-3-赋值重载" class="headerlink" title="3.3.赋值重载"></a>3.3.赋值重载</h2><h3 id="3-3-1-copy-1-副本"><a href="#3-3-1-copy-1-副本" class="headerlink" title="3.3.1.copy (1) 副本"></a>3.3.1.copy (1) 副本</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vector&amp; <span class="keyword">operator</span>= (<span class="type">const</span> vector&amp; x);</span><br></pre></td></tr></table></figure>

<h3 id="3-3-2-move-2-移动"><a href="#3-3-2-move-2-移动" class="headerlink" title="3.3.2.move (2) 移动"></a>3.3.2.move (2) 移动</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vector&amp; <span class="keyword">operator</span>= (vector&amp;&amp; x);</span><br></pre></td></tr></table></figure>

<h3 id="3-3-3-initializer-list-3-初始值设定项列表"><a href="#3-3-3-initializer-list-3-初始值设定项列表" class="headerlink" title="3.3.3.initializer list (3) 初始值设定项列表"></a>3.3.3.initializer list (3) 初始值设定项列表</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vector&amp; <span class="keyword">operator</span>= (initializer_list&lt;value_type&gt; il);</span><br></pre></td></tr></table></figure>

<p>下面也是使用一段代码来深入了解赋值重载的应用：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; v1&#123; <span class="number">1</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">4</span> &#125;;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; v2;</span><br><span class="line">    v2 = v1;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt;::iterator it = v2.<span class="built_in">begin</span>();<span class="comment">//(1)</span></span><br><span class="line">    <span class="keyword">while</span> (it != v2.<span class="built_in">end</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; *it &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        it++;</span><br><span class="line">    &#125;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; v3&#123; <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span> &#125;;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; v4;</span><br><span class="line">    v4 = <span class="built_in">move</span>(v3);<span class="comment">//(2)</span></span><br><span class="line"></span><br><span class="line">    vector&lt;<span class="type">double</span>&gt; v5;</span><br><span class="line">    v5 = &#123; <span class="number">3.14</span>, <span class="number">3.2</span>, <span class="number">4.5</span>, <span class="number">9.0</span>, <span class="number">2.1</span> &#125;;<span class="comment">//(3)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="4-迭代器（Iterators）"><a href="#4-迭代器（Iterators）" class="headerlink" title="4.迭代器（Iterators）"></a>4.迭代器（Iterators）</h1><h2 id="4-1-begin"><a href="#4-1-begin" class="headerlink" title="4.1.begin()"></a>4.1.begin()</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">iterator <span class="title">begin</span><span class="params">()</span> <span class="keyword">noexcept</span></span>;</span><br><span class="line"><span class="function">const_iterator <span class="title">begin</span><span class="params">()</span> <span class="type">const</span> <span class="keyword">noexcept</span></span>;</span><br></pre></td></tr></table></figure>

<h2 id="4-2-end"><a href="#4-2-end" class="headerlink" title="4.2.end()"></a>4.2.end()</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">iterator <span class="title">end</span><span class="params">()</span> <span class="keyword">noexcept</span></span>;</span><br><span class="line"><span class="function">const_iterator <span class="title">end</span><span class="params">()</span> <span class="type">const</span> <span class="keyword">noexcept</span></span>;</span><br></pre></td></tr></table></figure>

<h2 id="4-3-rbegin"><a href="#4-3-rbegin" class="headerlink" title="4.3.rbegin()"></a>4.3.rbegin()</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">reverse_iterator <span class="title">rbegin</span><span class="params">()</span> <span class="keyword">noexcept</span></span>;</span><br><span class="line"><span class="function">const_reverse_iterator <span class="title">rbegin</span><span class="params">()</span> <span class="type">const</span> <span class="keyword">noexcept</span></span>;</span><br></pre></td></tr></table></figure>

<h2 id="4-4-rend"><a href="#4-4-rend" class="headerlink" title="4.4.rend()"></a>4.4.rend()</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">reverse_iterator <span class="title">rend</span><span class="params">()</span> <span class="keyword">noexcept</span></span>;</span><br><span class="line"><span class="function">const_reverse_iterator <span class="title">rend</span><span class="params">()</span> <span class="type">const</span> <span class="keyword">noexcept</span></span>;</span><br></pre></td></tr></table></figure>

<p>同样使用一些例子来演示一下：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; v1 = &#123; <span class="number">1</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">9</span> &#125;;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt;::iterator it = v1.<span class="built_in">begin</span>();</span><br><span class="line">    <span class="keyword">while</span> (it != v1.<span class="built_in">end</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; (*(it++))++ &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> in : v1)</span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; in &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    vector&lt;<span class="type">float</span>&gt; v2 = &#123; <span class="number">1.2</span>, <span class="number">3.0</span>, <span class="number">4.3</span>, <span class="number">0.4</span> &#125;;</span><br><span class="line">    <span class="keyword">auto</span> rit = v2.<span class="built_in">rbegin</span>();</span><br><span class="line">    <span class="keyword">while</span> (rit != v2.<span class="built_in">rend</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; *rit &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        rit++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>除此之外还有一些常量迭代器（<code>cbegin()</code>、<code>cend()、``crbegin()</code>、<code>crend()</code>），这里就不一一介绍使用了，和之前讲解的<code>string</code>类的迭代器类似。</p>
<h1 id="5-容积（Capacity）"><a href="#5-容积（Capacity）" class="headerlink" title="5.容积（Capacity）"></a>5.容积（Capacity）</h1><h2 id="5-1-size-与capacity-与max-size"><a href="#5-1-size-与capacity-与max-size" class="headerlink" title="5.1.size()与capacity()与max_size()"></a>5.1.size()与capacity()与max_size()</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">size_type <span class="title">size</span><span class="params">()</span> <span class="type">const</span> <span class="keyword">noexcept</span></span>;</span><br><span class="line"><span class="function">size_type <span class="title">capacity</span><span class="params">()</span> <span class="type">const</span> <span class="keyword">noexcept</span></span>;</span><br><span class="line"><span class="function">size_type <span class="title">max_size</span><span class="params">()</span> <span class="type">const</span> <span class="keyword">noexcept</span></span>;<span class="comment">//这个函数是被写死了，没啥用，之前string类里也有提到</span></span><br></pre></td></tr></table></figure>

<h2 id="5-3-resize-与reserve-与shrink-to-fit"><a href="#5-3-resize-与reserve-与shrink-to-fit" class="headerlink" title="5.3.resize()与reserve()与shrink_to_fit()"></a>5.3.resize()与reserve()与shrink_to_fit()</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">resize</span> <span class="params">(size_type n)</span></span>;<span class="function"><span class="type">void</span> <span class="title">resize</span> <span class="params">(size_type n, <span class="type">const</span> value_type&amp; val)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">reserve</span> <span class="params">(size_type n)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">shrink_to_fit</span><span class="params">()</span></span>;<span class="comment">//缩小容量来适应对象的实际大小，不过不建议使用，这是异地缩容，以时间换空间</span></span><br></pre></td></tr></table></figure>

<h2 id="5-4-empty"><a href="#5-4-empty" class="headerlink" title="5.4.empty()"></a>5.4.empty()</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">empty</span><span class="params">()</span> <span class="type">const</span> <span class="keyword">noexcept</span></span>;</span><br></pre></td></tr></table></figure>

<p>判空，没什么好说的。</p>
<h1 id="6-元素访问（Element-access）"><a href="#6-元素访问（Element-access）" class="headerlink" title="6.元素访问（Element access）"></a>6.元素访问（Element access）</h1><h2 id="6-1-operator-与at"><a href="#6-1-operator-与at" class="headerlink" title="6.1.operator[]()与at()"></a>6.1.operator[]()与at()</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">reference <span class="keyword">operator</span>[] (size_type n);</span><br><span class="line">const_reference <span class="keyword">operator</span>[] (size_type n) <span class="type">const</span>;</span><br><span class="line"></span><br><span class="line"><span class="function">reference <span class="title">at</span> <span class="params">(size_type n)</span></span>;</span><br><span class="line"><span class="function">const_reference <span class="title">at</span> <span class="params">(size_type n)</span> <span class="type">const</span></span>;</span><br></pre></td></tr></table></figure>

<p>不过在使用<code>[]</code>的时候需要注意，<code>[]</code>内部有<code>assert()</code>检查，不得超过<code>size()</code>的值，因此和数组有些不同的是，哪怕提前开辟好空间，也没有办法直接使用<code>[]</code>访问。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//错误写法</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; v;</span><br><span class="line">    v.<span class="built_in">reserve</span>(<span class="number">10</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        v[i] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//正确写法</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; v;</span><br><span class="line">    v.<span class="built_in">reserve</span>(<span class="number">10</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        v.<span class="built_in">push_back</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; v[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>或者调用<code>resize()</code>：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; v;</span><br><span class="line">    v.<span class="built_in">resize</span>(<span class="number">10</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">size</span>(); i++)</span><br><span class="line">    &#123;</span><br><span class="line">        v[i] = i;</span><br><span class="line">        cout &lt;&lt; v[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="6-2-front-与back"><a href="#6-2-front-与back" class="headerlink" title="6.2.front()与back()"></a>6.2.front()与back()</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">reference <span class="title">front</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function">const_reference <span class="title">front</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function">reference <span class="title">back</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function">const_reference <span class="title">back</span><span class="params">()</span> <span class="type">const</span></span>;</span><br></pre></td></tr></table></figure>

<p>返回首尾元素的引用。</p>
<h2 id="6-3-data"><a href="#6-3-data" class="headerlink" title="6.3.data()"></a>6.3.data()</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">value_type* <span class="title">data</span><span class="params">()</span> <span class="keyword">noexcept</span></span>;</span><br><span class="line"><span class="function"><span class="type">const</span> value_type* <span class="title">data</span><span class="params">()</span> <span class="type">const</span> <span class="keyword">noexcept</span></span>;</span><br></pre></td></tr></table></figure>

<p>返回指向<code>vector</code>内部用于存储其拥有元素的内存数组的直接指针。</p>
<h1 id="7-修改器（Modifiers）"><a href="#7-修改器（Modifiers）" class="headerlink" title="7.修改器（Modifiers）"></a>7.修改器（Modifiers）</h1><h2 id="7-1-assign"><a href="#7-1-assign" class="headerlink" title="7.1.assign()"></a>7.1.assign()</h2><h2 id="7-2-push-back-和pop-back"><a href="#7-2-push-back-和pop-back" class="headerlink" title="7.2.push_back()和pop_back()"></a>7.2.push_back()和pop_back()</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">push_back</span> <span class="params">(<span class="type">const</span> value_type&amp; val)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">push_back</span> <span class="params">(value_type&amp;&amp; val)</span></span>;</span><br></pre></td></tr></table></figure>

<h2 id="7-4-insert"><a href="#7-4-insert" class="headerlink" title="7.4.insert()"></a>7.4.insert()</h2><h3 id="7-4-1-single-element-1-单元素"><a href="#7-4-1-single-element-1-单元素" class="headerlink" title="7.4.1.single element (1) 单元素"></a>7.4.1.single element (1) 单元素</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">iterator <span class="title">insert</span> <span class="params">(const_iterator position, <span class="type">const</span> value_type&amp; val)</span></span>;</span><br></pre></td></tr></table></figure>

<h3 id="7-4-2-fill-2-填充"><a href="#7-4-2-fill-2-填充" class="headerlink" title="7.4.2.fill (2) 填充"></a>7.4.2.fill (2) 填充</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">iterator <span class="title">insert</span> <span class="params">(const_iterator position, size_type n, <span class="type">const</span> value_type&amp; val)</span></span>;</span><br></pre></td></tr></table></figure>

<h3 id="7-4-3-range-3-范围"><a href="#7-4-3-range-3-范围" class="headerlink" title="7.4.3.range (3) 范围"></a>7.4.3.range (3) 范围</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">InputIterator</span>&gt;</span><br><span class="line"><span class="function">iterator <span class="title">insert</span> <span class="params">(const_iterator position, InputIterator first, InputIterator last)</span></span>;</span><br></pre></td></tr></table></figure>

<h3 id="7-4-4-move-4-移动"><a href="#7-4-4-move-4-移动" class="headerlink" title="7.4.4.move (4) 移动"></a>7.4.4.move (4) 移动</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">iterator <span class="title">insert</span> <span class="params">(const_iterator position, value_type&amp;&amp; val)</span></span>;</span><br></pre></td></tr></table></figure>

<h3 id="7-4-5-initializer-list-5-初始值设定项列表"><a href="#7-4-5-initializer-list-5-初始值设定项列表" class="headerlink" title="7.4.5.initializer list (5) 初始值设定项列表"></a>7.4.5.initializer list (5) 初始值设定项列表</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">iterator <span class="title">insert</span> <span class="params">(const_iterator position, initializer_list&lt;value_type&gt; il)</span></span>;</span><br></pre></td></tr></table></figure>

<h2 id="7-5-erase-和clear"><a href="#7-5-erase-和clear" class="headerlink" title="7.5.erase()和clear()"></a>7.5.erase()和clear()</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">iterator <span class="title">erase</span> <span class="params">(const_iterator position)</span></span>;<span class="comment">//擦除一个元素</span></span><br><span class="line"><span class="function">iterator <span class="title">erase</span> <span class="params">(const_iterator first, const_iterator last)</span></span>;<span class="comment">//擦除范围内的元素</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">clear</span><span class="params">()</span> <span class="keyword">noexcept</span></span>;<span class="comment">//删除所有的元素，使得size()值位0，但是不清楚capacity()的值</span></span><br></pre></td></tr></table></figure>

<p>我们借此测试一下<code>vector</code>的扩容机制：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; v;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        v.<span class="built_in">push_back</span>(<span class="number">1</span>);</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;size = &quot;</span> &lt;&lt; v.<span class="built_in">size</span>() &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; <span class="string">&quot;capacity = &quot;</span> &lt;&lt; v.<span class="built_in">capacity</span>() &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="comment">//在VS2022下大概是1.5倍对齐，如果是Linux的G++有大概是2倍，当然要根据不同平台和编译器来决定</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>补充：我们可以看到<code>vector</code>类模板没有设计头插和头删的接口，因为这两个接口的效率很低，并且实在是需要如此操作，可以使用<code>insert()</code>来做到。</p>
</blockquote>
<h2 id="7-6-swap"><a href="#7-6-swap" class="headerlink" title="7.6.swap()"></a>7.6.swap()</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">swap</span> <span class="params">(vector&amp; x)</span></span>;</span><br></pre></td></tr></table></figure>

<p><code>vector</code>还自己写了一个<code>swap()</code>，同样也是对比全局的<code>std::swap()</code>更加高效一些。</p>
<h2 id="7-7-emplace-和emplace-back"><a href="#7-7-emplace-和emplace-back" class="headerlink" title="7.7.emplace()和emplace_back()"></a>7.7.emplace()和emplace_back()</h2><p>这两个暂时不用理会，前者使用起来和<code>insert()</code>类似，后者和<code>push_back</code>类似。在某些场景下效率高一些，需要使用的时候再来查询文档把。</p>
<h1 id="8-配置器（Allocator）"><a href="#8-配置器（Allocator）" class="headerlink" title="8.配置器（Allocator）"></a>8.配置器（Allocator）</h1><p>以后再提及</p>
<h1 id="9-非成员函数重载（Non-menber-function-overloads）"><a href="#9-非成员函数重载（Non-menber-function-overloads）" class="headerlink" title="9.非成员函数重载（Non-menber function overloads）"></a>9.非成员函数重载（Non-menber function overloads）</h1><p>主要是关系运算符的重载：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">T</span>, <span class="keyword">class</span> <span class="title class_">Alloc</span>&gt;</span><br><span class="line">  <span class="type">bool</span> <span class="keyword">operator</span>== (<span class="type">const</span> vector&lt;T,Alloc&gt;&amp; lhs, <span class="type">const</span> vector&lt;T,Alloc&gt;&amp; rhs);</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">T</span>, <span class="keyword">class</span> <span class="title class_">Alloc</span>&gt;</span><br><span class="line">  <span class="type">bool</span> <span class="keyword">operator</span>!= (<span class="type">const</span> vector&lt;T,Alloc&gt;&amp; lhs, <span class="type">const</span> vector&lt;T,Alloc&gt;&amp; rhs);</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">T</span>, <span class="keyword">class</span> <span class="title class_">Alloc</span>&gt;</span><br><span class="line">  <span class="type">bool</span> <span class="keyword">operator</span>&lt;  (<span class="type">const</span> vector&lt;T,Alloc&gt;&amp; lhs, <span class="type">const</span> vector&lt;T,Alloc&gt;&amp; rhs);</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">T</span>, <span class="keyword">class</span> <span class="title class_">Alloc</span>&gt;</span><br><span class="line">  <span class="type">bool</span> <span class="keyword">operator</span>&lt;= (<span class="type">const</span> vector&lt;T,Alloc&gt;&amp; lhs, <span class="type">const</span> vector&lt;T,Alloc&gt;&amp; rhs);</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">T</span>, <span class="keyword">class</span> <span class="title class_">Alloc</span>&gt;</span><br><span class="line">  <span class="type">bool</span> <span class="keyword">operator</span>&gt;  (<span class="type">const</span> vector&lt;T,Alloc&gt;&amp; lhs, <span class="type">const</span> vector&lt;T,Alloc&gt;&amp; rhs);</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">T</span>, <span class="keyword">class</span> <span class="title class_">Alloc</span>&gt;</span><br><span class="line">  <span class="type">bool</span> <span class="keyword">operator</span>&gt;= (<span class="type">const</span> vector&lt;T,Alloc&gt;&amp; lhs, <span class="type">const</span> vector&lt;T,Alloc&gt;&amp; rhs);</span><br></pre></td></tr></table></figure>

<p>还有一个交换内容用的<code>swap()</code>:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">T</span>, <span class="keyword">class</span> <span class="title class_">Alloc</span>&gt;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">swap</span> <span class="params">(vector&lt;T,Alloc&gt;&amp; x, vector&lt;T,Alloc&gt;&amp; y)</span></span>;</span><br></pre></td></tr></table></figure>

<h1 id="10-相关练习题目"><a href="#10-相关练习题目" class="headerlink" title="10.相关练习题目"></a>10.相关练习题目</h1><h2 id="10-1-二叉树的前序遍历"><a href="#10-1-二叉树的前序遍历" class="headerlink" title="10.1.二叉树的前序遍历"></a>10.1.<a target="_blank" rel="noopener" href="https://leetcode.cn/problems/binary-tree-preorder-traversal/">二叉树的前序遍历</a></h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="type">void</span> _preorderTraversal(TreeNode* root, vector&lt;<span class="type">int</span>&gt;&amp; v)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (root == <span class="literal">nullptr</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        v.<span class="built_in">push_back</span>(root-&gt;val);</span><br><span class="line">        _preorderTraversal(root-&gt;left, v);</span><br><span class="line">        _preorderTraversal(root-&gt;right, v);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">preorderTraversal</span><span class="params">(TreeNode* root)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; v;</span><br><span class="line">        _preorderTraversal(root, v);</span><br><span class="line">        <span class="keyword">return</span> v;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="10-2-只出现一次的数字"><a href="#10-2-只出现一次的数字" class="headerlink" title="10.2.只出现一次的数字"></a>10.2.<a target="_blank" rel="noopener" href="https://leetcode.cn/problems/single-number/">只出现一次的数字</a></h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">singleNumber</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="type">int</span> number = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> in : nums)</span><br><span class="line">        &#123;</span><br><span class="line">            number ^= in;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> number;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="10-3-杨辉三角"><a href="#10-3-杨辉三角" class="headerlink" title="10.3.杨辉三角"></a>10.3.<a target="_blank" rel="noopener" href="https://leetcode.cn/problems/pascals-triangle/">杨辉三角</a></h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">generate</span>(<span class="type">int</span> numRows)<span class="comment">//numRows=5</span></span><br><span class="line">    &#123;</span><br><span class="line">        vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">vs</span>(numRows);<span class="comment">//该容器，每一个元素都是一个容器</span></span><br><span class="line">        vs[<span class="number">0</span>].<span class="built_in">resize</span>(<span class="number">1</span>);</span><br><span class="line">        vs[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;<span class="comment">//1</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; numRows - <span class="number">1</span>; i++)<span class="comment">//vs[0]-&gt;vs[4]，每一次都要由本层算出下一层</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt;= i; j++)<span class="comment">//vs[i][0]-&gt;vs[i][i]</span></span><br><span class="line">            &#123;</span><br><span class="line">                vs[i + <span class="number">1</span>].<span class="built_in">resize</span>(i + <span class="number">2</span>);<span class="comment">//开辟好下一层的空间，并且宝藏首尾都是元素1</span></span><br><span class="line"></span><br><span class="line">                vs[i + <span class="number">1</span>][<span class="number">0</span>] = <span class="number">1</span>;<span class="comment">//下一层的首尾都为1</span></span><br><span class="line">                vs[i + <span class="number">1</span>][i + <span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (j != <span class="number">0</span> &amp;&amp; j != i + <span class="number">1</span>)<span class="comment">//保证不是下一层的首位的情况下</span></span><br><span class="line">                &#123;</span><br><span class="line">                    vs[i + <span class="number">1</span>][j] = vs[i][j - <span class="number">1</span>] + vs[i][j];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> vs;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>补充1：另外我们发现<code>vector</code>没有<code>find()</code>系列的函数，这是为什么呢？因为在以后要介绍的算法库中就有相关的接口，即<code>std::find()</code>。</p>
<p>而<code>string</code>类也可以使用这个，但是它依旧有一个自己的<code>fund()</code>，一是因为出现比较早，二是这个<code>std::fund()</code>不够满足<code>string</code>类的需求（比如查找子串）</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; v = &#123; <span class="number">1</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span> &#125;;</span><br><span class="line">    <span class="keyword">auto</span> it = <span class="built_in">find</span>(v.<span class="built_in">begin</span>(), v.<span class="built_in">end</span>(), <span class="number">4</span>);</span><br><span class="line">    <span class="keyword">if</span> (it != v.<span class="built_in">end</span>())</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;找到了！&quot;</span> &lt;&lt; * it &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;没有找到！&quot;</span> &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注意2：实际上不仅没有<code>find()</code>系列，很多的容器也没有提供流插入和流提取，直接打印这些容器比较少（打印<code>string</code>比较多）</p>
</blockquote>
<h2 id="10-4-电话号码的字母组合"><a href="#10-4-电话号码的字母组合" class="headerlink" title="10.4.电话号码的字母组合"></a>10.4.<a target="_blank" rel="noopener" href="https://leetcode.cn/problems/letter-combinations-of-a-phone-number/">电话号码的字母组合</a></h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span>* numToStr_Arr[<span class="number">10</span>] = &#123; <span class="string">&quot;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="string">&quot;abc&quot;</span>,<span class="string">&quot;def&quot;</span>,<span class="string">&quot;ghi&quot;</span>,<span class="string">&quot;jkl&quot;</span>,<span class="string">&quot;mno&quot;</span>,<span class="string">&quot;pqrs&quot;</span>,<span class="string">&quot;tuv&quot;</span>,<span class="string">&quot;wxyz&quot;</span> &#125;;<span class="comment">//“数字-&gt;字母”的映射表</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="type">void</span> _combine(string digits, <span class="type">int</span> i, string combineStr, vector&lt;string&gt;&amp; ret)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(i == digits.<span class="built_in">size</span>())</span><br><span class="line">        &#123;</span><br><span class="line">            ret.<span class="built_in">push_back</span>(combineStr);</span><br><span class="line">            <span class="keyword">return</span>;<span class="comment">//拼好了</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> num = digits[i] - <span class="string">&#x27;0&#x27;</span>;<span class="comment">//取得数字&#x27;2&#x27;</span></span><br><span class="line">        string str = numToStr_Arr[num];<span class="comment">//str=&quot;abc&quot;</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> ch : str)<span class="comment">//分别取得&#x27;a&#x27;、&#x27;b&#x27;、&#x27;c&#x27;</span></span><br><span class="line">        &#123;</span><br><span class="line">            _combine(digits, i + <span class="number">1</span>, combineStr + ch, ret);<span class="comment">//_combine(digits, 1, &#x27;a&#x27;, ret)</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">vector&lt;string&gt; <span class="title">letterCombinations</span><span class="params">(<span class="type">const</span> string digits)</span><span class="comment">//digits=&quot;258&quot;</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">//digits是数字序列</span></span><br><span class="line">        <span class="comment">//ret是结果顺序表</span></span><br><span class="line">        vector&lt;string&gt; ret;</span><br><span class="line">        <span class="keyword">if</span>(digits.<span class="built_in">empty</span>())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> ret;</span><br><span class="line">        &#125;</span><br><span class="line">        string combineStr;</span><br><span class="line">        _combine(digits, <span class="number">0</span>, combineStr, ret);</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/12/01/011+limou+2023_8_11+C++%E7%9A%84string%E7%B1%BB%E7%9A%84%E6%A8%A1%E6%8B%9F%E5%AE%9E%E7%8E%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="limou3434">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2023/12/01/011+limou+2023_8_11+C++%E7%9A%84string%E7%B1%BB%E7%9A%84%E6%A8%A1%E6%8B%9F%E5%AE%9E%E7%8E%B0/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2023-12-01T16:34:49+08:00">
                2023-12-01
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _CRT_SECURE_NO_WARNINGS 1</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cassert&gt;</span></span></span><br><span class="line"><span class="keyword">namespace</span> limou<span class="comment">//标准命名空间</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">string</span></span><br><span class="line">    &#123;</span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        <span class="keyword">typedef</span> <span class="type">char</span>* iterator;<span class="comment">//迭代器的类型，迭代器实际上是重命名来的</span></span><br><span class="line">        <span class="keyword">typedef</span> <span class="type">const</span> <span class="type">char</span>* const_iterator;<span class="comment">//常量迭代器</span></span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        <span class="comment">//1.成员函数</span></span><br><span class="line">        <span class="comment">//1.1.构造函数</span></span><br><span class="line">        <span class="built_in">string</span>(<span class="type">const</span> <span class="type">char</span>* s = <span class="string">&quot;&quot;</span>)<span class="comment">//缺省参数传递空字符</span></span><br><span class="line">        &#123;</span><br><span class="line">            std::cout &lt;&lt; <span class="string">&quot;string(const char* s = &quot;</span><span class="string">&quot;)&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">            _size = <span class="built_in">strlen</span>(s);<span class="comment">//str的长度，不计入&#x27;\0&#x27;</span></span><br><span class="line">            _capacity = <span class="number">15</span>;<span class="comment">//str的默认容量，不计入&#x27;\0&#x27;</span></span><br><span class="line">            _s = <span class="keyword">new</span> <span class="type">char</span>[_capacity + <span class="number">1</span>];<span class="comment">//默认申请16个空间其中一个存储&#x27;\0&#x27;</span></span><br><span class="line">            <span class="keyword">while</span> (_size &gt; _capacity)<span class="comment">//如果容量不够了，就会进行扩容</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">delete</span>[] _s;</span><br><span class="line">                _s = <span class="keyword">new</span> <span class="type">char</span>[_capacity * <span class="number">2</span>];</span><br><span class="line">                _capacity *= <span class="number">2</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">strcpy</span>(_s, s);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//1.2.析构函数</span></span><br><span class="line">        ~<span class="built_in">string</span>()</span><br><span class="line">        &#123;</span><br><span class="line">            std::cout &lt;&lt; <span class="string">&quot;~string()&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">            <span class="keyword">delete</span>[] _s;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//1.3.拷贝构造+赋值重载函数</span></span><br><span class="line">        <span class="built_in">string</span>(<span class="type">const</span> string&amp; str)</span><br><span class="line">            : _s(<span class="literal">nullptr</span>)<span class="comment">//这里的初始化列表就可以避免后续交换的时候，析构cache出现奔溃的现象（delete了随机值）</span></span><br><span class="line">            , _size(<span class="number">0</span>)</span><br><span class="line">            , _capacity(<span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//1.传统写法</span></span><br><span class="line">            <span class="comment">//std::cout &lt;&lt; &quot;string(const string&amp; str)&quot; &lt;&lt; std::endl;</span></span><br><span class="line">            <span class="comment">//_size = str._size;</span></span><br><span class="line">            <span class="comment">//_capacity = str._capacity;</span></span><br><span class="line">            <span class="comment">//_s = new char[_capacity + 1];</span></span><br><span class="line">            <span class="comment">//strcpy(_s, str._s);</span></span><br><span class="line">            <span class="comment">//2.现代写法</span></span><br><span class="line">            std::cout &lt;&lt; <span class="string">&quot;string(const string&amp; str)&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">            <span class="function">string <span class="title">cache</span><span class="params">(str._s)</span></span>;<span class="comment">//构造一个</span></span><br><span class="line">            std::<span class="built_in">swap</span>(_s, cache._s);</span><br><span class="line">            std::<span class="built_in">swap</span>(_size, cache._size);</span><br><span class="line">            std::<span class="built_in">swap</span>(_capacity, cache._capacity);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//string&amp; operator=(const string&amp; str)</span></span><br><span class="line">        <span class="comment">//&#123;</span></span><br><span class="line">        <span class="comment">//    //1.传统写法</span></span><br><span class="line">        <span class="comment">//    //if (this != &amp;str)</span></span><br><span class="line">        <span class="comment">//    //&#123;</span></span><br><span class="line">        <span class="comment">//    //    std::cout &lt;&lt; &quot;string operator=(const string&amp; str)&quot; &lt;&lt; std::endl;</span></span><br><span class="line">        <span class="comment">//    //    char* cache = new char[str._capacity + 1];</span></span><br><span class="line">        <span class="comment">//    //    strcpy(cache, str._s);</span></span><br><span class="line">        <span class="comment">//    //    delete[] _s;</span></span><br><span class="line">        <span class="comment">//    //    _s = cache;</span></span><br><span class="line">        <span class="comment">//    //    _size = str._size;</span></span><br><span class="line">        <span class="comment">//    //    _capacity = str._capacity;</span></span><br><span class="line">        <span class="comment">//    //&#125;</span></span><br><span class="line">        <span class="comment">//    //return *this;</span></span><br><span class="line">        <span class="comment">//    //2.现代写法（实际上和传统写法的效率差别不大）</span></span><br><span class="line">        <span class="comment">//    //string str1(&quot;abcd&quot;);</span></span><br><span class="line">        <span class="comment">//    //string str2;</span></span><br><span class="line">        <span class="comment">//    //str2 = str1;</span></span><br><span class="line">        <span class="comment">//    std::cout &lt;&lt; &quot;string operator=(const string&amp; str)&quot; &lt;&lt; std::endl;</span></span><br><span class="line">        <span class="comment">//    if (this != &amp;str)</span></span><br><span class="line">        <span class="comment">//    &#123;</span></span><br><span class="line">        <span class="comment">//        string cache(str);//这里是调用了拷贝构造</span></span><br><span class="line">        <span class="comment">//        std::swap(_s, cache._s);</span></span><br><span class="line">        <span class="comment">//        std::swap(_size, cache._size);</span></span><br><span class="line">        <span class="comment">//        std::swap(_capacity, cache._capacity);</span></span><br><span class="line">        <span class="comment">//    &#125;</span></span><br><span class="line">        <span class="comment">//    return *this;</span></span><br><span class="line">        <span class="comment">//&#125;</span></span><br><span class="line">        <span class="comment">//如果写得再现代一点，还能吧拷贝的步骤省略</span></span><br><span class="line">        string&amp; <span class="keyword">operator</span>=(string cache)<span class="comment">//这里是调用了拷贝构造</span></span><br><span class="line">        &#123;</span><br><span class="line">            std::cout &lt;&lt; <span class="string">&quot;string operator=(const string&amp; str)&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">            std::<span class="built_in">swap</span>(_s, cache._s);</span><br><span class="line">            std::<span class="built_in">swap</span>(_size, cache._size);</span><br><span class="line">            std::<span class="built_in">swap</span>(_capacity, cache._capacity);</span><br><span class="line">            <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//2.迭代器</span></span><br><span class="line">        <span class="function">iterator <span class="title">begin</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> _s;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function">iterator <span class="title">end</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> _s + _size;<span class="comment">//若&quot;abcd&quot;,size=4,_s-&gt;a,_s+4-&gt;&#x27;\0&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function">const_iterator <span class="title">begin</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> _s;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function">const_iterator <span class="title">end</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> _s + _size;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//3.容积</span></span><br><span class="line">        <span class="function"><span class="type">const</span> <span class="type">char</span>* <span class="title">c_str</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> _s;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="type">const</span> <span class="type">size_t</span> <span class="title">size</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> _size;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="type">const</span> <span class="type">size_t</span> <span class="title">capacity</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> _capacity;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">reserve</span><span class="params">(<span class="type">size_t</span> n)</span><span class="comment">//改变容量</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (n &gt; _capacity)</span><br><span class="line">            &#123;</span><br><span class="line">                _capacity = n;<span class="comment">//改变容量</span></span><br><span class="line">                <span class="type">char</span>* cache = <span class="keyword">new</span> <span class="type">char</span>[n + <span class="number">1</span>];<span class="comment">//创建对应容量的空间</span></span><br><span class="line">                <span class="built_in">strcpy</span>(cache, _s);<span class="comment">//拷贝源字符串数据，会拷贝&#x27;\0&#x27;</span></span><br><span class="line">                <span class="keyword">delete</span>[] _s;<span class="comment">//销毁源字符串</span></span><br><span class="line">                _s = cache;<span class="comment">//</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                std::cout &lt;&lt; <span class="string">&quot;reserve操作只能扩容&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">resize</span><span class="params">(<span class="type">size_t</span> n, <span class="type">char</span> ch = <span class="string">&#x27;\0&#x27;</span>)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (n &lt;= _size)</span><br><span class="line">            &#123;</span><br><span class="line">                _s[n] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">                _size = n;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">reserve</span>(n);</span><br><span class="line">                <span class="keyword">while</span> (_size &lt; n)</span><br><span class="line">                &#123;</span><br><span class="line">                    _s[_size] = ch;</span><br><span class="line">                    _size++;</span><br><span class="line">                &#125;</span><br><span class="line">                _s[_size] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">clear</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="built_in">erase</span>(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//3.访问</span></span><br><span class="line">        <span class="type">char</span>&amp; <span class="keyword">operator</span>[](<span class="type">size_t</span> pos)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">assert</span>(pos &lt;= _size);<span class="comment">//这里设计的和库是一样的，可以访问到&#x27;\0&#x27;</span></span><br><span class="line">            <span class="keyword">return</span> _s[pos];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//4.修改器</span></span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">push_back</span><span class="params">(<span class="type">char</span> ch)</span><span class="comment">//push_back单字符</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="comment">//若&quot;abcd&quot;,_size=4,_capacity=15,空间足够,无需扩容</span></span><br><span class="line">            <span class="comment">//若&quot;aaaaabbbbbccccc&quot;,_size=15,_capacity=15,空间不够,需要扩容</span></span><br><span class="line">            <span class="keyword">if</span> (_size == _capacity)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">reserve</span>(_capacity * <span class="number">2</span>);<span class="comment">//改变容量为原来的2倍</span></span><br><span class="line">            &#125;</span><br><span class="line">            _s[_size++] = ch;</span><br><span class="line">            _s[_size] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">append</span><span class="params">(<span class="type">const</span> <span class="type">char</span>* s)</span><span class="comment">//append字符串</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="type">size_t</span> len = _size + <span class="built_in">strlen</span>(s);</span><br><span class="line">            <span class="keyword">if</span> (len &gt; _capacity)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">reserve</span>(len);<span class="comment">//改变容量</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">strcpy</span>(_s + _size, s);</span><br><span class="line">            _size += <span class="built_in">strlen</span>(s);</span><br><span class="line">        &#125;</span><br><span class="line">        string&amp; <span class="keyword">operator</span>+=(<span class="type">char</span> ch)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">push_back</span>(ch);</span><br><span class="line">            <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        string&amp; <span class="keyword">operator</span>+=(<span class="type">const</span> <span class="type">char</span>* str)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">append</span>(str);</span><br><span class="line">            <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">inster</span><span class="params">(<span class="type">size_t</span> pos, <span class="type">char</span> ch)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="comment">//个人看法：顺序表挪动数据从越界位置的索引开始比较好（也就是下面end=_size + 1,从越界的end开始）</span></span><br><span class="line">            <span class="comment">//&quot;abcdef\0&quot;,pos=2,pos-&gt;c,s[_size]=&#x27;\0&#x27;,&quot;ab cdef&quot;</span></span><br><span class="line">            <span class="comment">//&quot;\0&quot;,pos=0,pos-&gt;&#x27;\0&#x27;,s[_size]=&#x27;\0&#x27;,&quot; \0&quot;</span></span><br><span class="line">            <span class="built_in">assert</span>(pos &lt;= _size);</span><br><span class="line">            <span class="keyword">if</span> (_size == _capacity)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">reserve</span>(_capacity * <span class="number">2</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">size_t</span> end = _size + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">while</span> (end &gt; pos)</span><br><span class="line">            &#123;</span><br><span class="line">                _s[end] = _s[end - <span class="number">1</span>];</span><br><span class="line">                end--;</span><br><span class="line">            &#125;</span><br><span class="line">            _s[pos] = ch;</span><br><span class="line">            _size++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">inster</span><span class="params">(<span class="type">size_t</span> pos, <span class="type">const</span> <span class="type">char</span>* s)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="comment">//&quot;abcde\0&quot;,pos=1,pos-&gt;b,s=&quot;xxx&quot;,&quot;abcde\0&quot;-&gt;&quot;a   bcde\0&quot;</span></span><br><span class="line">            <span class="built_in">assert</span>(pos &lt;= _size);</span><br><span class="line">            <span class="type">size_t</span> len = <span class="built_in">strlen</span>(s);</span><br><span class="line">            <span class="keyword">if</span> (len + _size &gt; _capacity)<span class="comment">//容量不够</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">reserve</span>(len + _size);<span class="comment">//开辟好足够的空间</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">size_t</span> end = _size + len;<span class="comment">//end=5+3=8</span></span><br><span class="line">            <span class="keyword">while</span> (end &gt; pos)<span class="comment">//8&gt;1</span></span><br><span class="line">            &#123;</span><br><span class="line">                _s[end] = _s[end - len];<span class="comment">//_s[8] = _s[5]</span></span><br><span class="line">                end--;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">strncpy</span>(_s + pos, s, len);</span><br><span class="line">            _size += len;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">erase</span><span class="params">(<span class="type">size_t</span> pos, <span class="type">size_t</span> len = npos)</span><span class="comment">//len没有指定就会全部删除</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="comment">//擦除字符串的一部分，并且减少_size</span></span><br><span class="line">            <span class="comment">//&quot;bacdef\0&quot;,pos=1,len=3,&quot;b   ef\0&quot;-&gt;&quot;bef\0&quot;</span></span><br><span class="line">            <span class="built_in">assert</span>(pos &lt;= _size);</span><br><span class="line">            <span class="keyword">if</span> (_size == <span class="number">0</span>)<span class="comment">//如果字符串大小为0就直接返回，没必要清理了</span></span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            <span class="keyword">if</span> (len == npos || pos + len &gt;= _size)<span class="comment">//如果没有指定len就直接删除pos之后的所有字符串（或者超出范围）</span></span><br><span class="line">            &#123;</span><br><span class="line">                _s[pos] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">                _size = pos;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//对于指定pos就如下面处理</span></span><br><span class="line">            <span class="type">size_t</span> begin = pos + len;<span class="comment">//begin=1+3=4,_s[4]=&#x27;e&#x27;</span></span><br><span class="line">            <span class="keyword">while</span> (begin &lt;= _size)<span class="comment">//begin&lt;6</span></span><br><span class="line">            &#123;</span><br><span class="line">                _s[begin - len] = _s[begin];<span class="comment">//_s[1]=_s[4],&#x27;a&#x27;-&gt;&#x27;e&#x27;</span></span><br><span class="line">                begin++;</span><br><span class="line">            &#125;</span><br><span class="line">            _size -= len;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//5.比较（库里的写成全局是因为支持其他的类实例化）</span></span><br><span class="line">        <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> string&amp; str)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> (<span class="built_in">strcmp</span>(_s, str._s) &lt; <span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">bool</span> <span class="keyword">operator</span>==(<span class="type">const</span> string&amp; str)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">return</span> (<span class="built_in">strcmp</span>(_s, str._s) == <span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">bool</span> <span class="keyword">operator</span>&lt;=(<span class="type">const</span> string&amp; str)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> *<span class="keyword">this</span> &lt; str || *<span class="keyword">this</span> == str;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">bool</span> <span class="keyword">operator</span>&gt;(<span class="type">const</span> string&amp; str)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> !(*<span class="keyword">this</span> &lt;= str);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">bool</span> <span class="keyword">operator</span>!=(<span class="type">const</span> string&amp; str)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> !(*<span class="keyword">this</span> == str);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">bool</span> <span class="keyword">operator</span>&gt;=(<span class="type">const</span> string&amp; str)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> !(*<span class="keyword">this</span> &lt; str);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//6.字符串运算</span></span><br><span class="line">        <span class="function"><span class="type">size_t</span> <span class="title">find</span><span class="params">(<span class="type">char</span> ch, <span class="type">size_t</span> pos = <span class="number">0</span>)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="comment">//&quot;abcd\0&quot;,pos=1,pos-&gt;b,ch=d</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">size_t</span> i = pos; i &lt; _size; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (_s[i] == ch)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">return</span> i;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> npos;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="type">size_t</span> <span class="title">find</span><span class="params">(<span class="type">const</span> <span class="type">char</span>* sub, <span class="type">size_t</span> pos = <span class="number">0</span>)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="comment">//这里也可以使用kmp算法，但是对于新手来说比较复杂，并且在实践中的效率一般（哪怕STL中也没有使用这个算法）字符串匹配更好的方法是BM算法</span></span><br><span class="line">            <span class="comment">//这里我们就直接使用C语言提供的接口strstr()</span></span><br><span class="line">            <span class="type">const</span> <span class="type">char</span>* p = <span class="built_in">strstr</span>(_s + pos, sub);</span><br><span class="line">            <span class="keyword">if</span> (p != <span class="literal">NULL</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> p - _s;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> npos;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function">string <span class="title">substr</span><span class="params">(<span class="type">size_t</span> pos, <span class="type">size_t</span> len = npos)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="comment">//&quot;abcdef\0&quot;,pos=1,pos-&gt;b,len=4,substr=&quot;bcde&quot;</span></span><br><span class="line">            <span class="comment">//1.写法1（冗余一些）</span></span><br><span class="line">            <span class="comment">//string str;</span></span><br><span class="line">            <span class="comment">//if (len == npos || pos + len &gt;= _size)</span></span><br><span class="line">            <span class="comment">//&#123;</span></span><br><span class="line">            <span class="comment">//    len = _size - pos;//重新计算长度</span></span><br><span class="line">            <span class="comment">//    str.reserve(len);//提前开好空间</span></span><br><span class="line">            <span class="comment">//    for (size_t i = pos; i &lt; _size; i++)</span></span><br><span class="line">            <span class="comment">//    &#123;</span></span><br><span class="line">            <span class="comment">//        str += _s[i];</span></span><br><span class="line">            <span class="comment">//    &#125;</span></span><br><span class="line">            <span class="comment">//&#125;</span></span><br><span class="line">            <span class="comment">//else</span></span><br><span class="line">            <span class="comment">//&#123;</span></span><br><span class="line">            <span class="comment">//    str.reserve(len);//提前开好空间</span></span><br><span class="line">            <span class="comment">//    for (size_t i = pos; i &lt; pos + len; i++)</span></span><br><span class="line">            <span class="comment">//    &#123;</span></span><br><span class="line">            <span class="comment">//        str += _s[i];</span></span><br><span class="line">            <span class="comment">//    &#125;</span></span><br><span class="line">            <span class="comment">//&#125;</span></span><br><span class="line">            <span class="comment">//return str;</span></span><br><span class="line">            <span class="comment">//2.写法2（精简一些）</span></span><br><span class="line">            string str;</span><br><span class="line">            <span class="type">size_t</span> end = pos + len;</span><br><span class="line">            <span class="keyword">if</span> (len == npos || pos + len &gt;= _size)</span><br><span class="line">            &#123;</span><br><span class="line">                len = _size - pos;<span class="comment">//重新计算长度</span></span><br><span class="line">                end = _size;</span><br><span class="line">            &#125;</span><br><span class="line">            str.<span class="built_in">reserve</span>(len);<span class="comment">//提前开好空间</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">size_t</span> i = pos; i &lt; end; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                str += _s[i];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> str;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">private</span>:</span><br><span class="line">        <span class="type">char</span>* _s;</span><br><span class="line">        <span class="type">size_t</span> _size;</span><br><span class="line">        <span class="type">size_t</span> _capacity;</span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        <span class="type">static</span> <span class="type">const</span> <span class="type">size_t</span> npos = <span class="number">-1</span>;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        吐槽：单纯的静态成员不可以在这里定义（也没有办法传给初始化列表），</span></span><br><span class="line"><span class="comment">        但是C++又搞了一个特例，const static的整形变量可以直接在这里定义。</span></span><br><span class="line"><span class="comment">        这是一个比较离谱的设计，记着就行，一般也不会这么写，容易坑人……因为这个特例会破坏语法规则</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">//const size_t string::npos = -1;</span></span><br><span class="line">    <span class="comment">//7.流重载（并不一定要写成友元）</span></span><br><span class="line">    std::ostream&amp; <span class="keyword">operator</span>&lt;&lt;(std::ostream&amp; out, <span class="type">const</span> string&amp; str)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> ch : str)</span><br><span class="line">            out &lt;&lt; ch;</span><br><span class="line">        <span class="keyword">return</span> out;</span><br><span class="line">    &#125;</span><br><span class="line">    std::istream&amp; <span class="keyword">operator</span>&gt;&gt;(std::istream&amp; in, string&amp; str)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//1.这里注意下面这样的代码是解决不了问题的，因为cin遇到空格就会自动跳过</span></span><br><span class="line">        <span class="comment">//char ch;</span></span><br><span class="line">        <span class="comment">//in &gt;&gt; ch;</span></span><br><span class="line">        <span class="comment">//while (ch != &#x27; &#x27; &amp;&amp; ch != &#x27;\n&#x27;)</span></span><br><span class="line">        <span class="comment">//&#123;</span></span><br><span class="line">        <span class="comment">//    str += ch;</span></span><br><span class="line">        <span class="comment">//    in &gt;&gt; ch;</span></span><br><span class="line">        <span class="comment">//&#125;</span></span><br><span class="line">        <span class="comment">//return in;</span></span><br><span class="line">        <span class="comment">//2.更正写法如下：</span></span><br><span class="line">        <span class="comment">//str.clear();//为了避免变成尾插，还需要清楚原有的数据</span></span><br><span class="line">        <span class="comment">//char ch;</span></span><br><span class="line">        <span class="comment">//ch = in.get();//这是istream类提供的一个函数</span></span><br><span class="line">        <span class="comment">//while (ch != &#x27; &#x27; &amp;&amp; ch != &#x27;\n&#x27;)</span></span><br><span class="line">        <span class="comment">//&#123;</span></span><br><span class="line">        <span class="comment">//    str += ch;</span></span><br><span class="line">        <span class="comment">//    ch = in.get();</span></span><br><span class="line">        <span class="comment">//&#125;</span></span><br><span class="line">        <span class="comment">//return in;</span></span><br><span class="line">        <span class="comment">//3.不过上述扩容有些频繁，还可以在进行改进</span></span><br><span class="line">        str.<span class="built_in">clear</span>();<span class="comment">//为了避免变成尾插，还需要清楚原有的数据</span></span><br><span class="line"></span><br><span class="line">        <span class="type">char</span> buff[<span class="number">128</span> + <span class="number">1</span>];<span class="comment">//缓存区</span></span><br><span class="line">        <span class="type">size_t</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="type">char</span> ch;</span><br><span class="line">        ch = in.<span class="built_in">get</span>();<span class="comment">//这是istream类提供的一个函数</span></span><br><span class="line">        <span class="keyword">while</span> (ch != <span class="string">&#x27; &#x27;</span> &amp;&amp; ch != <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            buff[i++] = ch;</span><br><span class="line">            <span class="keyword">if</span> (i == <span class="number">128</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                buff[i] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">                str += buff;<span class="comment">//加载数据</span></span><br><span class="line">                i = <span class="number">0</span>;<span class="comment">//置空缓存区</span></span><br><span class="line">            &#125;</span><br><span class="line">            ch = in.<span class="built_in">get</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (i != <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            buff[i] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">            str += buff;<span class="comment">//加载数据</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> in;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//8.测试</span></span><br><span class="line">    <span class="comment">//构造测试</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">test_1</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">//1.库中的默认构造实现（测试）</span></span><br><span class="line">        std::string str;</span><br><span class="line">        std::cout &lt;&lt; str.<span class="built_in">c_str</span>() &lt;&lt; std::endl;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;str.size = &quot;</span> &lt;&lt; str.<span class="built_in">size</span>() &lt;&lt; std::endl;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;str.capacity = &quot;</span> &lt;&lt; str.<span class="built_in">capacity</span>() &lt;&lt; std::endl;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;----&quot;</span> &lt;&lt; std::endl &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2.我们自己的构造实现（测试）</span></span><br><span class="line">        <span class="comment">//string()</span></span><br><span class="line">        string str0;</span><br><span class="line">        <span class="type">const</span> <span class="type">char</span>* s0 = str0.<span class="built_in">c_str</span>();</span><br><span class="line">        std::cout &lt;&lt; s0 &lt;&lt; std::endl;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;str0.size = &quot;</span> &lt;&lt; str0.<span class="built_in">size</span>() &lt;&lt; std::endl;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;str0.capacity = &quot;</span> &lt;&lt; str0.<span class="built_in">capacity</span>() &lt;&lt; std::endl;</span><br><span class="line">        <span class="comment">//string(const char* s)</span></span><br><span class="line">        <span class="function">string <span class="title">str1</span><span class="params">(<span class="string">&quot;Hello, My name is Limou3434.&quot;</span>)</span></span>;</span><br><span class="line">        <span class="type">const</span> <span class="type">char</span>* s1 = str1.<span class="built_in">c_str</span>();</span><br><span class="line">        std::cout &lt;&lt; s1 &lt;&lt; std::endl;</span><br><span class="line">        <span class="comment">//string(const string&amp; str)</span></span><br><span class="line">        <span class="function">string <span class="title">str2</span><span class="params">(str1)</span></span>;</span><br><span class="line">        <span class="type">const</span> <span class="type">char</span>* s2 = str2.<span class="built_in">c_str</span>();</span><br><span class="line">        std::cout &lt;&lt; s2 &lt;&lt; std::endl;</span><br><span class="line">        <span class="comment">//string&amp; operator=(const string&amp; str)</span></span><br><span class="line">        <span class="function">string <span class="title">str3</span><span class="params">(<span class="string">&quot;aaaa&quot;</span>)</span></span>;</span><br><span class="line">        <span class="function">string <span class="title">str4</span><span class="params">(<span class="string">&quot;bbbb&quot;</span>)</span></span>;</span><br><span class="line">        string str5;</span><br><span class="line">        str5 = (str4 = str3);</span><br><span class="line">        <span class="type">const</span> <span class="type">char</span>* s3 = str3.<span class="built_in">c_str</span>();</span><br><span class="line">        <span class="type">const</span> <span class="type">char</span>* s4 = str4.<span class="built_in">c_str</span>();</span><br><span class="line">        <span class="type">const</span> <span class="type">char</span>* s5 = str5.<span class="built_in">c_str</span>();</span><br><span class="line">        std::cout &lt;&lt; s3 &lt;&lt; <span class="string">&quot; | &quot;</span> &lt;&lt; s4 &lt;&lt; <span class="string">&quot; | &quot;</span> &lt;&lt; s5 &lt;&lt; std::endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//迭代器测试</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">test_2</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">//1.使用[]遍历访问</span></span><br><span class="line">        <span class="function">string <span class="title">str1</span><span class="params">(<span class="string">&quot;Hello&quot;</span>)</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; str1[i]; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            std::cout &lt;&lt; str1[i]++ &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        std::cout &lt;&lt; std::endl;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; str1.<span class="built_in">size</span>(); i++)</span><br><span class="line">        &#123;</span><br><span class="line">            std::cout &lt;&lt; str1[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        std::cout &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2.使用迭代器遍历</span></span><br><span class="line">        <span class="function">string <span class="title">str2</span><span class="params">(<span class="string">&quot;Iamlimou&quot;</span>)</span></span>;</span><br><span class="line">        limou::string::iterator it = str2.<span class="built_in">begin</span>();</span><br><span class="line">        <span class="keyword">while</span>(it &lt; str2.<span class="built_in">end</span>())</span><br><span class="line">        &#123;</span><br><span class="line">            std::cout &lt;&lt; (*it)++ &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">            it++;</span><br><span class="line">        &#125;</span><br><span class="line">        std::cout &lt;&lt; std::endl;</span><br><span class="line">        it = str2.<span class="built_in">begin</span>();</span><br><span class="line">        <span class="keyword">while</span>(it &lt; str2.<span class="built_in">end</span>())</span><br><span class="line">        &#123;</span><br><span class="line">            std::cout &lt;&lt; *it &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">            it++;</span><br><span class="line">        &#125;</span><br><span class="line">        std::cout &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3.使用范围for，本质为迭代器（测试）</span></span><br><span class="line">        string str3;</span><br><span class="line">        str3 = <span class="string">&quot;WordWordWord&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; ch : str3)</span><br><span class="line">        &#123;</span><br><span class="line">            std::cout &lt;&lt; ch++ &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        std::cout &lt;&lt; std::endl;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; ch : str3)</span><br><span class="line">        &#123;</span><br><span class="line">            std::cout &lt;&lt; ch &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        std::cout &lt;&lt; std::endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//修改器测试</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">test_3</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">//1.push_back()</span></span><br><span class="line">        string str1 = <span class="string">&quot;abcd&quot;</span>;</span><br><span class="line">        str1.<span class="built_in">push_back</span>(<span class="string">&#x27;e&#x27;</span>);</span><br><span class="line">        std::cout &lt;&lt; str1.<span class="built_in">c_str</span>() &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">50</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            str1.<span class="built_in">push_back</span>(<span class="string">&#x27;x&#x27;</span>);</span><br><span class="line">            std::cout &lt;&lt; str1.<span class="built_in">c_str</span>() &lt;&lt; std::endl;</span><br><span class="line">        &#125;</span><br><span class="line">        std::cout &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2.append()</span></span><br><span class="line">        str1.<span class="built_in">append</span>(<span class="string">&quot;________________________________&quot;</span>);</span><br><span class="line">        std::cout &lt;&lt; str1.<span class="built_in">c_str</span>() &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3.operator+=()</span></span><br><span class="line">        string str2;</span><br><span class="line">        str2 += <span class="string">&#x27;#&#x27;</span>;</span><br><span class="line">        str2 += <span class="string">&#x27;#&#x27;</span>;</span><br><span class="line">        str2 += <span class="string">&#x27;#&#x27;</span>;</span><br><span class="line">        str2 += <span class="string">&#x27;#&#x27;</span>;</span><br><span class="line">        str2 += <span class="string">&#x27;#&#x27;</span>;</span><br><span class="line">        str2 += <span class="string">&#x27;#&#x27;</span>;</span><br><span class="line">        str2 += <span class="string">&#x27;#&#x27;</span>;</span><br><span class="line">        str2 += <span class="string">&#x27;#&#x27;</span>;</span><br><span class="line">        str2 += <span class="string">&#x27;#&#x27;</span>;</span><br><span class="line">        str2 += <span class="string">&#x27;#&#x27;</span>;</span><br><span class="line">        str2 += <span class="string">&#x27;#&#x27;</span>;</span><br><span class="line">        str2 += <span class="string">&#x27;#&#x27;</span>;</span><br><span class="line">        str2 += <span class="string">&#x27;#&#x27;</span>;</span><br><span class="line">        str2 += <span class="string">&#x27;#&#x27;</span>;</span><br><span class="line">        std::cout &lt;&lt; str2.<span class="built_in">c_str</span>() &lt;&lt; std::endl;</span><br><span class="line">        str2 += <span class="string">&quot;######################################################&quot;</span>;</span><br><span class="line">        std::cout &lt;&lt; str2.<span class="built_in">c_str</span>() &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4.inster()</span></span><br><span class="line">        string str4;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            str4.<span class="built_in">inster</span>(<span class="number">0</span>, <span class="string">&#x27;#&#x27;</span>);</span><br><span class="line">            std::cout &lt;&lt; str4.<span class="built_in">c_str</span>() &lt;&lt; std::endl;</span><br><span class="line">        &#125;</span><br><span class="line">        str4.<span class="built_in">inster</span>(<span class="number">1</span>, <span class="string">&#x27;%&#x27;</span>);</span><br><span class="line">        std::cout &lt;&lt; str4.<span class="built_in">c_str</span>() &lt;&lt; std::endl;</span><br><span class="line">        str4.<span class="built_in">inster</span>(str4.<span class="built_in">size</span>(), <span class="string">&#x27;%&#x27;</span>);</span><br><span class="line">        std::cout &lt;&lt; str4.<span class="built_in">c_str</span>() &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">        string str5;</span><br><span class="line">        str5.<span class="built_in">inster</span>(<span class="number">0</span>, <span class="string">&quot;xxx&quot;</span>);</span><br><span class="line">        std::cout &lt;&lt; str5.<span class="built_in">c_str</span>() &lt;&lt; std::endl;</span><br><span class="line">        str5.<span class="built_in">inster</span>(<span class="number">3</span>, <span class="string">&quot;aaaaaaaaaaaaaaa&quot;</span>);</span><br><span class="line">        std::cout &lt;&lt; str5.<span class="built_in">c_str</span>() &lt;&lt; std::endl;</span><br><span class="line">        str5.<span class="built_in">inster</span>(<span class="number">5</span>, <span class="string">&quot;*&quot;</span>);</span><br><span class="line">        std::cout &lt;&lt; str5.<span class="built_in">c_str</span>() &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//5.erase()</span></span><br><span class="line">        <span class="function">string <span class="title">str6</span><span class="params">(<span class="string">&quot;abcdef&quot;</span>)</span></span>;</span><br><span class="line">        str6.<span class="built_in">erase</span>(<span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line">        std::cout &lt;&lt; str6.<span class="built_in">c_str</span>() &lt;&lt; std::endl;</span><br><span class="line">        str6.<span class="built_in">erase</span>(<span class="number">0</span>);</span><br><span class="line">        std::cout &lt;&lt; str6.<span class="built_in">c_str</span>() &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">        str6.<span class="built_in">push_back</span>(<span class="string">&#x27;c&#x27;</span>);</span><br><span class="line">        std::cout &lt;&lt; str6.<span class="built_in">c_str</span>() &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">        <span class="function">string <span class="title">str7</span><span class="params">(<span class="string">&quot;xxcdef&quot;</span>)</span></span>;</span><br><span class="line">        str7.<span class="built_in">erase</span>(<span class="number">2</span>, <span class="number">100</span>);</span><br><span class="line">        std::cout &lt;&lt; str7.<span class="built_in">c_str</span>() &lt;&lt; std::endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//比较测试</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">test_4</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        string str1 = <span class="string">&quot;a&quot;</span>;</span><br><span class="line">        string str2 = <span class="string">&quot;a&quot;</span>;</span><br><span class="line">        string str3 = <span class="string">&quot;b&quot;</span>;</span><br><span class="line">        string str4 = <span class="string">&quot;c&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (str1 &lt; str3)</span><br><span class="line">        &#123;</span><br><span class="line">            std::cout &lt;&lt; <span class="string">&quot;true&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">        &#125;        </span><br><span class="line">        <span class="keyword">if</span> (str1 == str2)</span><br><span class="line">        &#123;</span><br><span class="line">            std::cout &lt;&lt; <span class="string">&quot;true&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">        &#125;        </span><br><span class="line">        <span class="keyword">if</span> (str1 &lt;= str3)</span><br><span class="line">        &#123;</span><br><span class="line">            std::cout &lt;&lt; <span class="string">&quot;true&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (str1 &lt;= str2)</span><br><span class="line">        &#123;</span><br><span class="line">            std::cout &lt;&lt; <span class="string">&quot;true&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (str4 &gt; str3)</span><br><span class="line">        &#123;</span><br><span class="line">            std::cout &lt;&lt; <span class="string">&quot;true&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">        &#125;        </span><br><span class="line">        <span class="keyword">if</span> (str1 != str3)</span><br><span class="line">        &#123;</span><br><span class="line">            std::cout &lt;&lt; <span class="string">&quot;true&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">        &#125;        </span><br><span class="line">        <span class="keyword">if</span> (str4 &gt;= str3)</span><br><span class="line">        &#123;</span><br><span class="line">            std::cout &lt;&lt; <span class="string">&quot;true&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (str4 &gt;= str4)</span><br><span class="line">        &#123;</span><br><span class="line">            std::cout &lt;&lt; <span class="string">&quot;true&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//流测试</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">test_5</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="function">string <span class="title">str1</span><span class="params">(<span class="string">&quot;abc&quot;</span>)</span></span>;</span><br><span class="line">        <span class="function">string <span class="title">str2</span><span class="params">(<span class="string">&quot;efg&quot;</span>)</span></span>;</span><br><span class="line">        std::cin &gt;&gt; str1;</span><br><span class="line">        std::cin &gt;&gt; str2;</span><br><span class="line">        std::cout &lt;&lt; str1 &lt;&lt; std::endl;</span><br><span class="line">        std::cout &lt;&lt; str2 &lt;&lt; std::endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//容积测试</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">test_6</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="function">string <span class="title">str1</span><span class="params">(<span class="string">&quot;abcdefehi&quot;</span>)</span></span>;</span><br><span class="line">        str1.<span class="built_in">resize</span>(<span class="number">3</span>);</span><br><span class="line">        std::cout &lt;&lt; str1.<span class="built_in">c_str</span>() &lt;&lt; std::endl;</span><br><span class="line">        str1.<span class="built_in">resize</span>(<span class="number">10</span>, <span class="string">&#x27;x&#x27;</span>);</span><br><span class="line">        std::cout &lt;&lt; str1.<span class="built_in">c_str</span>() &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">        string str2;</span><br><span class="line">        str2.<span class="built_in">resize</span>(<span class="number">10</span>, <span class="string">&#x27;x&#x27;</span>);</span><br><span class="line">        std::cout &lt;&lt; str2.<span class="built_in">c_str</span>() &lt;&lt; std::endl;</span><br><span class="line">        std::cout &lt;&lt; str2.<span class="built_in">size</span>() &lt;&lt; std::endl;</span><br><span class="line">        std::cout &lt;&lt; str2.<span class="built_in">capacity</span>() &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">        str2.<span class="built_in">resize</span>(<span class="number">101</span>, <span class="string">&#x27;?&#x27;</span>);</span><br><span class="line">        std::cout &lt;&lt; str2.<span class="built_in">c_str</span>() &lt;&lt; std::endl;</span><br><span class="line">        std::cout &lt;&lt; str2.<span class="built_in">size</span>() &lt;&lt; std::endl;</span><br><span class="line">        std::cout &lt;&lt; str2.<span class="built_in">capacity</span>() &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">        str2 += <span class="string">&quot;abcd&quot;</span>;</span><br><span class="line">        std::cout &lt;&lt; str2.<span class="built_in">c_str</span>() &lt;&lt; std::endl;</span><br><span class="line">        std::cout &lt;&lt; str2.<span class="built_in">size</span>() &lt;&lt; std::endl;</span><br><span class="line">        std::cout &lt;&lt; str2.<span class="built_in">capacity</span>() &lt;&lt; std::endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//运算测试</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">test_7</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="function">string <span class="title">str</span><span class="params">(<span class="string">&quot;limou3434&quot;</span>)</span></span>;</span><br><span class="line">        std::cout &lt;&lt; str.<span class="built_in">find</span>(<span class="string">&#x27;i&#x27;</span>) &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">        std::cout &lt;&lt; str.<span class="built_in">find</span>(<span class="string">&quot;mou&quot;</span>) &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">        string substr = str.<span class="built_in">substr</span>(<span class="number">1</span>, <span class="number">3</span>);</span><br><span class="line">        std::cout &lt;&lt; substr.<span class="built_in">c_str</span>() &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">        substr = str.<span class="built_in">substr</span>(<span class="number">4</span>);</span><br><span class="line">        std::cout &lt;&lt; substr.<span class="built_in">c_str</span>() &lt;&lt; std::endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//sizeof测试</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">test_8</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        std::string str1;</span><br><span class="line">        std::string str2 = <span class="string">&quot;abcdabcdabcdabcdabcdabcd&quot;</span>;</span><br><span class="line">        std::cout &lt;&lt; <span class="built_in">sizeof</span>(str1) &lt;&lt; std::endl;</span><br><span class="line">        std::cout &lt;&lt; <span class="built_in">sizeof</span>(str2) &lt;&lt; std::endl;</span><br><span class="line">        <span class="comment">//在库里面，会多出一个_buff[16]</span></span><br><span class="line">        <span class="comment">//如果字符数小于16，就会存储到buff里</span></span><br><span class="line">        <span class="comment">//如果字符数大于16，就会存储到_s指向的空间里</span></span><br><span class="line">        <span class="comment">//_buff[16]为16字节</span></span><br><span class="line">        <span class="comment">//_str为8字节  </span></span><br><span class="line">        <span class="comment">//_size为8字节</span></span><br><span class="line">        <span class="comment">//_capacity为8字节</span></span><br><span class="line">        <span class="comment">//因此体现为40字节大小的空间</span></span><br><span class="line">        <span class="comment">//在VS的调试监视窗口中的原始视图里可以找到buff数组</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">注意我们写的只是string类，而不是basic_string类模板</span></span><br><span class="line"><span class="comment">而不是一个类模板，因此有些地方上面的代码对于其他的实例化可能不够适用</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">另外这里再提及一个浅拷贝的知识：</span></span><br><span class="line"><span class="comment">深拷贝的代价太大了，那么也没有其他办法解决浅拷贝的问题呢？</span></span><br><span class="line"><span class="comment">    1.首先浅拷贝的主要问题如下：</span></span><br><span class="line"><span class="comment">        1.1.析构了两次</span></span><br><span class="line"><span class="comment">        1.2.一次修改影响多个对象</span></span><br><span class="line"><span class="comment">    2.针对上述问题有一些解决方案：</span></span><br><span class="line"><span class="comment">        2.1.解决问题一：这个时候我们引入一个方法：“引用计数”，</span></span><br><span class="line"><span class="comment">                    “引用计数”可以记录有多少个对象指向同一块空间，</span></span><br><span class="line"><span class="comment">                    析构的时候就减少一次计数，除非减到0才可以释放。</span></span><br><span class="line"><span class="comment">                    （这里只是简单提及，以后使用智能指针的时候还会再提）</span></span><br><span class="line"><span class="comment">        2.2.解决问题二：上述“引用计数”解决了两次析构的问题，</span></span><br><span class="line"><span class="comment">                    但是没有解决一次修改多次改变的问题，</span></span><br><span class="line"><span class="comment">                    因此又引入了“写时拷贝”，只有写的时候才进行拷贝。</span></span><br><span class="line"><span class="comment">                    当“引用计数”不为1时，在写入空间的时候先进行深度拷贝再写入。</span></span><br><span class="line"><span class="comment">                    当“引用计数”为1就直接写入空间进行修改。</span></span><br><span class="line"><span class="comment">                    也就是说“写时拷贝”是一种‘拖延’的方案，最终还是要进行深拷贝，</span></span><br><span class="line"><span class="comment">                    只不过只在写的时候进行深拷贝而已</span></span><br><span class="line"><span class="comment">    3.在拷贝的时候如果使用了上述方案，如果没有进行“对空间写入”，就会提高一些效率</span></span><br><span class="line"><span class="comment">当然上述只是简单提及一下，为以后的知识进行铺垫罢了。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">另外补充一下：在有些VS版本下没有采用上述的方案，是直接使用深度拷贝的，这点可以通过下面代码来证明。</span></span><br><span class="line"><span class="comment">#include &lt;iostream&gt;</span></span><br><span class="line"><span class="comment">#include &lt;string&gt;</span></span><br><span class="line"><span class="comment">using namespace std;</span></span><br><span class="line"><span class="comment">int main()</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">    string str1(&quot;abcd&quot;);</span></span><br><span class="line"><span class="comment">    string str2(str1);</span></span><br><span class="line"><span class="comment">    cout &lt;&lt; (void*)str1.c_str() &lt;&lt; endl;</span></span><br><span class="line"><span class="comment">    cout &lt;&lt; (void*)str2.c_str() &lt;&lt; endl;</span></span><br><span class="line"><span class="comment">    str2 += &#x27;e&#x27;;</span></span><br><span class="line"><span class="comment">    cout &lt;&lt; (void*)str1.c_str() &lt;&lt; endl;</span></span><br><span class="line"><span class="comment">    cout &lt;&lt; (void*)str2.c_str() &lt;&lt; endl;</span></span><br><span class="line"><span class="comment">    return 0;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">而G++下的string类是通过写时拷贝来实现的，string对象总共占去4个字节（32位），</span></span><br><span class="line"><span class="comment">内部只包含一个指针，该指针指向堆空间，内部包含:</span></span><br><span class="line"><span class="comment">    (1)空间总大小</span></span><br><span class="line"><span class="comment">    (2)字符串有效长度</span></span><br><span class="line"><span class="comment">    (3)引用计数</span></span><br><span class="line"><span class="comment">指向堆空间的指针（用来存储字符串）”</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/12/01/010+limou+2023_8_5+C++%E7%9A%84string%E7%B1%BB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="limou3434">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2023/12/01/010+limou+2023_8_5+C++%E7%9A%84string%E7%B1%BB/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2023-12-01T16:34:49+08:00">
                2023-12-01
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="1-string简介"><a href="#1-string简介" class="headerlink" title="1.string简介"></a>1.string简介</h1><p><code>string</code>不是<code>STL</code>的一部分（<code>STL</code>的诞生较晚），但是和<code>STL</code>一起学习会更加容易融会贯通。</p>
<p>而实际上<code>string</code>是一个类模板<code>basic_string</code>的一个实例化，使用字符的顺序容器实现（也就是字符的顺序表），<code>string</code>整个系列支持<code>char</code>的动态增长（字符编码有几篇文章值得看一下，是耗子哥推荐的）。</p>
<blockquote>
<p>String are objects represent sequences of characters.（字符串是表示字符序列的对象。）</p>
</blockquote>
<p><code>string</code>实际上是由<code>basic_traits</code>类实例化而来</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> basic_string&lt;<span class="type">char</span>&gt; string;</span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>basic_string</code>的实例化除了<code>string（单字节）</code>，还有<code>wstring(宽字符、双字节)</code>、<code>u16string(16位字符，双字节)</code>、<code>u32string(32位字符，四字节)</code>，它们各自维护的类型是<code>char</code>、<code>wchar_t</code>、<code>char16_t</code>、<code>char32_t</code>，这些是属于编码的问题，不过最常用的还是<code>string</code>类。</p>
</blockquote>
<p>在<code>string</code>类中至少有三个成员变量：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">string</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">char</span>* _str;<span class="comment">//指向由new开辟出来的动态空间，该空间存储字符串</span></span><br><span class="line">    <span class="type">size_t</span> _size;<span class="comment">//string对象对应字符串的大小</span></span><br><span class="line">    <span class="type">size_t</span> _capacity;<span class="comment">//string对象的容量，在存储的时候会多存储一个空字符，方便转化为C风格的字符串，在不同的环境扩容机制有些许不同，有的直接2倍，有的1.5倍</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h1 id="2-类构造函数"><a href="#2-类构造函数" class="headerlink" title="2.类构造函数"></a>2.类构造函数</h1><h2 id="2-1-string"><a href="#2-1-string" class="headerlink" title="2.1.string()"></a>2.1.string()</h2><p>调用构造函数后，会构造一个长度为<code>0</code>的空字符串（但是有一定的容量）。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    std::string str;</span><br><span class="line">    <span class="comment">//使用范围for循环遍历字符串中的每个字符</span></span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;大小 = &quot;</span> &lt;&lt; str.<span class="built_in">size</span>() &lt;&lt; std::endl;</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;容量 = &quot;</span> &lt;&lt; str.<span class="built_in">capacity</span>() &lt;&lt; std::endl;</span><br><span class="line">    <span class="comment">//size()是string类内部的成员函数，</span></span><br><span class="line">    <span class="comment">//可以求得string对象内部存储的字符串大小，</span></span><br><span class="line">    <span class="comment">//而capacity()则是求得容量大小</span></span><br><span class="line">    <span class="comment">//后续还会继续讲解</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2-2-string-const-string-str"><a href="#2-2-string-const-string-str" class="headerlink" title="2.2.string (const string&amp; str)"></a>2.2.string (const string&amp; str)</h2><p>构造一个<code>str</code>的副本，也就是复制<code>str</code>构造一个新的<code>string</code>对象。</p>
<h2 id="2-3-string-const-string-str-size-t-pos-size-t-len-npos"><a href="#2-3-string-const-string-str-size-t-pos-size-t-len-npos" class="headerlink" title="2.3.string (const string&amp; str, size_t pos, size_t len &#x3D; npos)"></a>2.3.string (const string&amp; str, size_t pos, size_t len &#x3D; npos)</h2><p>复制<code>string</code>对象的部分的字符（从<code>pos</code>开始到<code>len</code>的部分）来构造一个新的<code>string</code>对象。</p>
<p>或者复制到<code>str</code>结束部分（即：<code>str</code>太短了或者<code>len</code>值为<code>string::pos</code>）。</p>
<blockquote>
<p>补充：什么是<code>string::pos</code>呢？<code>string::pos</code>实际上是<code>string</code>内部的常量成员，下面是其定义：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">size_t</span> npos = <span class="number">-1</span>;</span><br></pre></td></tr></table></figure>

<p>我们知道<code>size_t</code>是无符号整数类型的别名，因此<code>npos</code>取得了有符号的一个最大值，这基本不可能是<code>str</code>的长度，也可能是字符串的索引值。</p>
</blockquote>
<p><code>len</code>默认值为<code>npos</code>的目的是：如果没有给予<code>len</code>的值，将会一直读取到字符串的末尾，这一点细节我们实现一个简易的<code>string</code>类再来细细探究。</p>
<h2 id="2-4-string-const-char-s"><a href="#2-4-string-const-char-s" class="headerlink" title="2.4.string (const char* s)"></a>2.4.string (const char* s)</h2><p>复制<code>s</code>指针指向的字符序列（以空字符<code>\0</code>结尾的<code>C</code>语言风格的字符序列）构造出一个<code>string</code>对象。</p>
<h2 id="2-5-string-const-char-s-size-t-n"><a href="#2-5-string-const-char-s-size-t-n" class="headerlink" title="2.5.string (const char* s, size_t n)"></a>2.5.string (const char* s, size_t n)</h2><p>从<code>s</code>指向的字符数组中复制前<code>n</code>个字符。</p>
<h2 id="2-6-string-size-t-n-char-c"><a href="#2-6-string-size-t-n-char-c" class="headerlink" title="2.6.string (size_t n, char c)"></a>2.6.string (size_t n, char c)</h2><p>用<code>n</code>个相同得<code>c</code>字符连续填充字符串。</p>
<h2 id="2-7-template-string-InputIterator-first-InputIterator-last"><a href="#2-7-template-string-InputIterator-first-InputIterator-last" class="headerlink" title="2.7.template &lt;class InputIterator&gt; string (InputIterator first, InputIterator last)"></a>2.7.template &lt;class InputIterator&gt; string (InputIterator first, InputIterator last)</h2><p>以和原<code>string</code>对象相同的顺序，来复制原<code>string</code>对象中范围为<code>[first,last)</code>（迭代器）的字符序列，构造新的<code>string</code>对象。由于我们还没有学过迭代器，因此我们直接上代码观看迭代器的时候会更加好一下。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//直接初始化一个字符串</span></span><br><span class="line">    <span class="function">std::string <span class="title">str1</span><span class="params">(<span class="string">&quot;Hello World&quot;</span>)</span></span>;</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;str1(\&quot;Hello World\&quot;) = &quot;</span></span><br><span class="line">        &lt;&lt; str1 &lt;&lt; std::endl;</span><br><span class="line">    <span class="comment">//使用迭代器范围构造一个新的字符串</span></span><br><span class="line">    <span class="function">std::string <span class="title">str2</span><span class="params">(str1.begin(), str1.begin() + <span class="number">7</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//输出：Hello</span></span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;str2(str1.begin(), str1.begin() + 7) = &quot;</span> </span><br><span class="line">        &lt;&lt; str2 &lt;&lt; std::endl;  </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里<code>begin()</code>就是迭代器的使用，您可以简单理解为有一个指针，指向了这个<code>string</code>对象的字符串开头位置，迭代器的出现就是为了能是使得一些对象可以类似指针一样使用。</p>
<h2 id="2-8-string-initializer-list-il"><a href="#2-8-string-initializer-list-il" class="headerlink" title="2.8.string (initializer_list&lt;char&gt; il)"></a>2.8.string (initializer_list&lt;char&gt; il)</h2><p>以列表<code>il</code>中的每个字符来构造<code>string</code>对象，这和使用<code>string(const string&amp; str)</code>构造有些许不同。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//使用列表方式初始化字符串</span></span><br><span class="line">    std::string str&#123; <span class="string">&quot;Hello&quot;</span> &#125;;</span><br><span class="line">    <span class="comment">//输出：Hello</span></span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;str: &quot;</span> &lt;&lt; str &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>补充：std::initializer_list 是一个模板类，它允许创建一个包含任意数量元素的列表。它类似于数组，可以通过下标访问其中的元素，但与数组不同的是，std::initializer_list 是不可变的，不能进行元素的添加或删除操作。（但是这不是初始化列表的意思！）</p>
</blockquote>
<h2 id="2-9-string-string-str-noexcept"><a href="#2-9-string-string-str-noexcept" class="headerlink" title="2.9.string (string&amp;&amp; str) noexcept"></a>2.9.string (string&amp;&amp; str) noexcept</h2><p>这个函数被称为“移动构造”，可以将源<code>string</code>对象转移到目标<code>string</code>对象中。</p>
<p>移动构造函数通常是浅拷贝，它将源对象的资源所有权转移给目标对象，而不是创建新的资源副本。这种机制能够提高性能，并确保在源对象析构时不会重复释放资源。</p>
<p>下面代码如果没能看懂可以以后再来查看：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//使用构造函数构造源string对象</span></span><br><span class="line">    std::string source = <span class="string">&quot;Hello World&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//使用移动构造函数转移资源</span></span><br><span class="line">    <span class="function">std::string <span class="title">target</span><span class="params">(std::move(source))</span></span>;</span><br><span class="line"></span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;target = &quot;</span> &lt;&lt; target &lt;&lt; std::endl;<span class="comment">//输出：target = Hello World</span></span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;source = &quot;</span> &lt;&lt; source &lt;&lt; std::endl;<span class="comment">//输出：source = （source的内容已被移动）</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意：源对象的状态会变为有效但未指定的状态，并且应该避免继续使用移动后的对象或访问其值，上述代码在大部分编译器（比如VS2022）中有可能在打印<code>source</code>的时候提示出类似下面的警告：<code>使用已移动的 from 对象: source (lifetime.1)</code>。</p>
</blockquote>
<h2 id="2-10-英文备注"><a href="#2-10-英文备注" class="headerlink" title="2.10.英文备注"></a>2.10.英文备注</h2><blockquote>
<p>以下是参考<a target="_blank" rel="noopener" href="https://c.binjie.fun/#/chat/1690448482357"><code>CPlusPlus</code>网站</a>的英文解释</p>
<p>(1) empty string constructor (default constructor)</p>
<p>Constructs an <a target="_blank" rel="noopener" href="https://legacy.cplusplus.com/string::empty">empty</a> string, with a <a target="_blank" rel="noopener" href="https://legacy.cplusplus.com/string::length">length</a> of zero characters.</p>
<p>(2) copy constructor</p>
<p>Constructs a copy of <em>str</em>.</p>
<p>(3) substring constructor</p>
<p>Copies the portion of <em>str</em> that begins at the character position <em>pos</em> and spans <em>len</em> characters (or until the end of <em>str</em>, if either <em>str</em> is too short or if <em>len</em> is <a target="_blank" rel="noopener" href="https://legacy.cplusplus.com/string::npos">string::npos</a>).</p>
<p>(4) from c-string</p>
<p>Copies the null-terminated character sequence (C-string) pointed by <em>s</em>.</p>
<p>(5) from buffer</p>
<p>Copies the first <em>n</em> characters from the array of characters pointed by <em>s</em>.</p>
<p>(6) fill constructor</p>
<p>Fills the string with <em>n</em> consecutive copies of character <em>c</em>.</p>
<p>(7) range constructor</p>
<p>Copies the sequence of characters in the range [first,last), in the same order.</p>
<p>(8) initializer list</p>
<p>Copies each of the characters in <em>il</em>, in the same order.</p>
<p>(9) move constructor</p>
<p>Acquires the contents of <em>str</em>.  </p>
<p><em>str</em> is left in an unspecified but valid state.</p>
</blockquote>
<h1 id="3-类析构函数"><a href="#3-类析构函数" class="headerlink" title="3.类析构函数"></a>3.类析构函数</h1><p><code>~string()</code>会释放所有存储容量（该存储容量由字符串所使用的分配器分配）。</p>
<p>也就是说<code>string</code>类的析构函数<code>~string()</code>主要是释放掉<code>string</code>类产生的<code>string</code>对象的资源，因为<code>string</code>的本质是一个顺序表。</p>
<h1 id="4-赋值符号重载函数"><a href="#4-赋值符号重载函数" class="headerlink" title="4.赋值符号重载函数"></a>4.赋值符号重载函数</h1><table>
<thead>
<tr>
<th>类别</th>
<th>函数声明</th>
</tr>
</thead>
<tbody><tr>
<td>string (1)</td>
<td><code>string&amp; operator= (const string&amp; str);</code></td>
</tr>
<tr>
<td>c-string (2)</td>
<td><code>string&amp; operator= (const char* s);</code></td>
</tr>
<tr>
<td>character (3)</td>
<td><code>string&amp; operator= (char c);</code></td>
</tr>
<tr>
<td>initializer list (4)</td>
<td><code>string&amp; operator= (initializer_list&lt;char&gt; il);</code></td>
</tr>
<tr>
<td>move (5)</td>
<td><code>string&amp; operator= (string&amp;&amp; str) noexcept;</code></td>
</tr>
</tbody></table>
<p>上述的作用基本都是将一个新值赋给已定义后的<code>string</code>对象，来替换其当前<code>string</code>对象的内容。下面是测试例子：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//创建多个string对象</span></span><br><span class="line">    std::string str1, str2, str3, str4;</span><br><span class="line">    str1 = <span class="string">&quot;hello&quot;</span>;                        <span class="comment">//赋值C风格的字符串(2)</span></span><br><span class="line">    std::cout &lt;&lt; str1 &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">    str2 = <span class="string">&#x27;x&#x27;</span>;                            <span class="comment">//赋值单字符(3)</span></span><br><span class="line">    std::cout &lt;&lt; str2 &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">    str3 = str1 + str2;                    <span class="comment">//赋值string对象(1)</span></span><br><span class="line">    std::cout &lt;&lt; str3 &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">    str3 = &#123; <span class="string">&#x27;H&#x27;</span>, <span class="string">&#x27;E&#x27;</span>, <span class="string">&#x27;L&#x27;</span>, <span class="string">&#x27;L&#x27;</span>, <span class="string">&#x27;O&#x27;</span> &#125;;    <span class="comment">//初始化列表(4)</span></span><br><span class="line">    std::cout &lt;&lt; str3 &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">    str4 = std::<span class="built_in">move</span>(str3);                <span class="comment">//移动构造(5)</span></span><br><span class="line">    std::cout &lt;&lt; str3 &lt;&lt; std::endl;</span><br><span class="line">    std::cout &lt;&lt; str4 &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>其中初始化列表函数和普通的赋值只是内部实现细节有点区别，其他地方都很类似。</p>
<p>最后一个函数您若是没有看懂，暂且先用着，我们以后再来解释……</p>
<h1 id="5-迭代器（Iterators）"><a href="#5-迭代器（Iterators）" class="headerlink" title="5.迭代器（Iterators）"></a>5.迭代器（Iterators）</h1><p>如果需要遍历一个<code>string</code>对象需要怎么做呢？目前我们有多种方法可以遍历。</p>
<table>
<thead>
<tr>
<th>类别</th>
<th>可读可修改</th>
<th>可读不可修改</th>
</tr>
</thead>
<tbody><tr>
<td>正向迭代器</td>
<td><code>iterator begin() noexcept;</code><br><code>iterator end() noexcept;</code></td>
<td><code>const_iterator begin() const noexcept;</code><br><code>const_iterator end() const noexcept;</code></td>
</tr>
<tr>
<td>反向迭代器</td>
<td><code>reverse_iterator rbegin() noexcept; </code><br><code>reverse_iterator rend() noexcept;</code></td>
<td><code>const_reverse_iterator rbegin() const noexcept;</code><br><code>const_reverse_iterator rend() const noexcept;</code></td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>类别</th>
<th>函数声明</th>
</tr>
</thead>
<tbody><tr>
<td>普通对象的常量迭代器</td>
<td><code>const_iterator cbegin() const noexcept;</code><br><code>const_iterator cend() const noexcept;</code></td>
</tr>
<tr>
<td>常量对象的常量迭代器</td>
<td><code>const_reverse_iterator crbegin() const noexcept;</code><br><code>const_reverse_iterator crend() const noexcept;</code></td>
</tr>
</tbody></table>
<p>其中<code>iterator</code>是一个类模板：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">T</span>&gt;<span class="comment">//这里假设T实例化为string </span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">iterator</span> </span><br><span class="line">&#123; </span><br><span class="line">    <span class="comment">//1.正向迭代器</span></span><br><span class="line">    <span class="comment">//迭代器的成员函数和操作符重载定义</span></span><br><span class="line">    <span class="function">iterator <span class="title">begin</span><span class="params">()</span> <span class="keyword">noexcept</span></span>;<span class="comment">//可以找到string对象的头</span></span><br><span class="line">    <span class="function">const_iterator <span class="title">begin</span><span class="params">()</span> <span class="type">const</span> <span class="keyword">noexcept</span></span>;<span class="comment">//可以找到const string对象的头</span></span><br><span class="line">    <span class="function">iterator <span class="title">end</span><span class="params">()</span> <span class="keyword">noexcept</span></span>;<span class="comment">//可以找到string对象的尾</span></span><br><span class="line">    <span class="function">const_iterator <span class="title">end</span><span class="params">()</span> <span class="type">const</span> <span class="keyword">noexcept</span></span>;<span class="comment">//可以找到const string对象的尾</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//2.反向迭代器</span></span><br><span class="line">    <span class="function">reverse_iterator <span class="title">rbegin</span><span class="params">()</span> <span class="keyword">noexcept</span></span>;</span><br><span class="line">    <span class="function">const_reverse_iterator <span class="title">rbegin</span><span class="params">()</span> <span class="type">const</span> <span class="keyword">noexcept</span></span>;</span><br><span class="line">    <span class="function">reverse_iterator <span class="title">rend</span><span class="params">()</span> <span class="keyword">noexcept</span></span>;</span><br><span class="line">    <span class="function">const_reverse_iterator <span class="title">rend</span><span class="params">()</span> <span class="type">const</span> <span class="keyword">noexcept</span></span>;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="5-1-正向迭代器：begin-和end"><a href="#5-1-正向迭代器：begin-和end" class="headerlink" title="5.1.正向迭代器：begin()和end()"></a>5.1.正向迭代器：begin()和end()</h2><h3 id="5-1-1-for遍历"><a href="#5-1-1-for遍历" class="headerlink" title="5.1.1.for遍历"></a>5.1.1.for遍历</h3><p>这里会使用<code>string</code>类的成员函数<code>size()</code>，这个函数专门计算<code>string</code>对象的大小，这在后面讲解<code>string</code>类的成员函数时，还会进行讲解。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">std::string <span class="title">str</span><span class="params">(<span class="string">&quot;abcd&quot;</span>)</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; str.<span class="built_in">size</span>(); i++)</span><br><span class="line">    &#123;</span><br><span class="line">        std::cout &lt;&lt; str[i] &lt;&lt; <span class="string">&quot; &quot;</span>;<span class="comment">//[]运算符重载</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>还需要注意的是，<code>[]</code>运算符重载使得<code>string</code>对象能够像数组一样遍历，我们之后还会再提一次。</p>
<h3 id="5-1-2-迭代器"><a href="#5-1-2-迭代器" class="headerlink" title="5.1.2.迭代器"></a>5.1.2.迭代器</h3><p>迭代器的行为十分类似指针（但是不是指针）使得<code>string</code>对象可以像数组一样被使用：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">std::string <span class="title">str</span><span class="params">(<span class="string">&quot;abcd&quot;</span>)</span></span>;</span><br><span class="line">    std::string::iterator it = str.<span class="built_in">begin</span>();<span class="comment">//这里如果类型名字太长，可以使用auto来自动推导</span></span><br><span class="line">    <span class="keyword">while</span> (it != str.<span class="built_in">end</span>())<span class="comment">//这里不推荐使用&#x27;&lt;&#x27;符号</span></span><br><span class="line">    &#123;</span><br><span class="line">        std::cout &lt;&lt; *it &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        (*it)++;</span><br><span class="line">        it++;</span><br><span class="line">    &#125;</span><br><span class="line">    std::cout &lt;&lt; std::endl &lt;&lt; str &lt;&lt; std::endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在<code>while (it != str.end())</code>这里不推荐使用<code>&lt;</code>符号，尽管在<code>string</code>对象里使用或许不会出错，但是在其他类里可能就不满足了。（之前说过迭代器的行为类似指针，因此<code>string</code>的底层很有可能就是指针，因此使用<code>&lt;</code>不会出太多错）</p>
<p>但是迭代器不仅仅是<code>string</code>类使用，基本所有库里的类都可以使用迭代器遍历，迭代器有几种便利之处：</p>
<ol>
<li><p>通用，在一些不支持<code>[]</code>重载的结构也可使用迭代器</p>
</li>
<li><p>是无需考虑差<code>1</code>问题</p>
</li>
<li><p>屏蔽底层实现细节，可以直接使用</p>
</li>
</ol>
<p>而其他类底层的迭代器是靠纯指针实现的，例如：链表，因此使用<code>&lt;</code>会有风险。</p>
<p>实际上迭代器就是<code>C++</code>封装的一种体现。</p>
<h3 id="5-1-3-范围for"><a href="#5-1-3-范围for" class="headerlink" title="5.1.3.范围for"></a>5.1.3.范围for</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    std::string str = <span class="string">&quot;Hello&quot;</span>;</span><br><span class="line">    <span class="comment">//使用范围for循环遍历字符串中的每个字符</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> ch : str) </span><br><span class="line">    &#123;</span><br><span class="line">        std::cout &lt;&lt; ch &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>实际上范围<code>for</code>的底层代码就是迭代器，只不过范围<code>for</code>封装得更加厉害罢了（在一些编译器内部调试的时候可以切到范围<code>for</code>的汇编语句来检验两者关系）。</p>
<h2 id="5-2-反向迭代器：rbegin-和rend"><a href="#5-2-反向迭代器：rbegin-和rend" class="headerlink" title="5.2.反向迭代器：rbegin()和rend()"></a>5.2.反向迭代器：rbegin()和rend()</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">std::string <span class="title">str</span><span class="params">(<span class="string">&quot;abcd&quot;</span>)</span></span>;</span><br><span class="line">    std::string::reverse_iterator rit = str.<span class="built_in">rbegin</span>();</span><br><span class="line">    <span class="keyword">while</span> (rit != str.<span class="built_in">rend</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        std::cout &lt;&lt; *rit &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        (*rit)++;</span><br><span class="line">        rit++;<span class="comment">//注意依旧是++，而不是--</span></span><br><span class="line">    &#125;</span><br><span class="line">    std::cout &lt;&lt; std::endl &lt;&lt; str &lt;&lt; std::endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="5-3-常量迭代器"><a href="#5-3-常量迭代器" class="headerlink" title="5.3.常量迭代器"></a>5.3.常量迭代器</h2><p>常量迭代器也没有什么声明的，只是将上述两种迭代器从“可读可写”设置为“只可读不可写”，这点我们就不再深入讲解了。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//const string str1 = &quot;abcdef&quot;;</span></span><br><span class="line">    <span class="comment">//auto it = str1.begin();</span></span><br><span class="line">    <span class="comment">//while (it != str1.end())</span></span><br><span class="line">    <span class="comment">//&#123;</span></span><br><span class="line">    <span class="comment">//    cout &lt;&lt; (*it)++ &lt;&lt; &quot; &quot;;</span></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="comment">//    it++;</span></span><br><span class="line">    <span class="comment">//&#125;</span></span><br><span class="line">    <span class="comment">//cout &lt;&lt; endl;</span></span><br><span class="line">    string str2 = <span class="string">&quot;abcdef&quot;</span>;</span><br><span class="line">    <span class="keyword">auto</span> cit = str2.<span class="built_in">cbegin</span>();</span><br><span class="line">    <span class="keyword">while</span> (cit != str2.<span class="built_in">cend</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; *cit &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        cit++;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="6-容积（Capacity）"><a href="#6-容积（Capacity）" class="headerlink" title="6.容积（Capacity）"></a>6.容积（Capacity）</h1><table>
<thead>
<tr>
<th align="left">类别</th>
<th>函数声明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">获取长度和容量</td>
<td><code>size_t size() const noexcept;</code><br><code>size_t length() const noexcept;</code><br><code>size_t capacity() const noexcept;</code></td>
</tr>
<tr>
<td align="left">改变长度和容量</td>
<td><code>void resize (size_t n);</code><br><code>void resize (size_t n, char c);</code><br><code>void reserve (size_t n = 0);</code></td>
</tr>
<tr>
<td align="left">获取环境最大容量数值</td>
<td><code>size_t max_size() const noexcept;</code></td>
</tr>
<tr>
<td align="left">清理对象内容</td>
<td><code>void clear() noexcept;</code></td>
</tr>
<tr>
<td align="left">判空</td>
<td><code>bool empty() const noexcept;</code></td>
</tr>
</tbody></table>
<h2 id="6-1-size-和length-和capacity"><a href="#6-1-size-和length-和capacity" class="headerlink" title="6.1.size()和length()和capacity()"></a>6.1.size()和length()和capacity()</h2><p>首先我们有一个问题，为什么会有两个计算长度的成员函数呢？这是因为<code>string</code>类得诞生比<code>STL</code>早，最开始设计的是<code>length()</code>，后来出现了<code>STL</code>才开始使用了（并且建议使用）<code>size()</code>。两个都可以计算<code>string</code>对象内部字符串长度，在功能上是等效的。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">string <span class="title">str</span><span class="params">(<span class="string">&quot;abcdefghijklmn&quot;</span>)</span></span>;</span><br><span class="line">    cout &lt;&lt; str.<span class="built_in">size</span>() &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; str.<span class="built_in">length</span>() &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>补充：如果查看其他的结构会发现都是使用<code>size()</code>，而没有<code>length()</code></p>
</blockquote>
<p>而另外一个函数<code>capacity()</code>则可以求得当前<code>string</code>对象的容量。</p>
<h2 id="6-2-clear"><a href="#6-2-clear" class="headerlink" title="6.2.clear()"></a>6.2.clear()</h2><p>这个成员函数会对string对象的字符串作清理，但是不会释放空间，同时原<code>string</code>的容量不变，对象的<code>siez()</code>值置为空。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">string <span class="title">str</span><span class="params">(<span class="string">&quot;abcdefghijklmn&quot;</span>)</span></span>;</span><br><span class="line">    cout &lt;&lt; str &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; str.<span class="built_in">size</span>() &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; str.<span class="built_in">capacity</span>() &lt;&lt; endl;</span><br><span class="line">    str.<span class="built_in">clear</span>();</span><br><span class="line">    cout &lt;&lt; str &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; str.<span class="built_in">size</span>() &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; str.<span class="built_in">length</span>() &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="6-3-max-size"><a href="#6-3-max-size" class="headerlink" title="6.3.max_size()"></a>6.3.max_size()</h2><p>这个成员函数用于告知用户该环境下的<code>string</code>对象最多可以申请到多少字节的空间。</p>
<p>但是这个值是写死的，只是在不同环境下会不同罢了，因此基本没怎么用到这个。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">string <span class="title">str1</span><span class="params">(<span class="string">&quot;abcdefghijklmn&quot;</span>)</span></span>;</span><br><span class="line">    cout &lt;&lt; str1.<span class="built_in">max_size</span>() &lt;&lt; endl;</span><br><span class="line">    <span class="function">string <span class="title">str2</span><span class="params">(<span class="string">&quot;abcdefghijklmn&quot;</span>)</span></span>;</span><br><span class="line">    cout &lt;&lt; str2.<span class="built_in">max_size</span>() &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="6-4-resize"><a href="#6-4-resize" class="headerlink" title="6.4.resize()"></a>6.4.resize()</h2><p><code>resize()</code>可以将<code>string</code>对象的大小（即：<code>size()</code>的值），有以下集几种情况：</p>
<ol>
<li><p>如果<code>n</code>小于<code>string</code>对象原有的大小，则删除<code>n</code>个字符以外的字符（这个操作比较危险）</p>
</li>
<li><p>如果<code>n</code>大于<code>string</code>对象原有的大小，则尾插任意字符（默认表现为空字符<code>\0</code>）扩充到当前的内容，使得大小达到<code>n</code>。因此如果有填充某个字符串的需求，也是可以用这个函数的</p>
</li>
<li><p>如果指定了字符<code>c</code>，则多开辟的空间初始化为字符<code>c</code></p>
</li>
</ol>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//1.创建一个&quot;abcde&quot;为内容的string对象，size()值为5，capacity()默认值为15</span></span><br><span class="line">    <span class="function">string <span class="title">str</span><span class="params">(<span class="string">&quot;abcde&quot;</span>)</span></span>;</span><br><span class="line">    cout &lt;&lt; str &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; str.<span class="built_in">size</span>() &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; str.<span class="built_in">capacity</span>() &lt;&lt; endl &lt;&lt; endl;</span><br><span class="line">    <span class="comment">//2.调整size()值为20的string对象，而在VS2022中表现为填充15个空字符&#x27;\0&#x27;，而空字符是没有打印出来的</span></span><br><span class="line">    str.<span class="built_in">resize</span>(<span class="number">20</span>);</span><br><span class="line">    cout &lt;&lt; str &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; str.<span class="built_in">size</span>() &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; str.<span class="built_in">capacity</span>() &lt;&lt; endl &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//3.调整size()值为30的string对象，因此：前5个字符为&quot;abcde&quot;，后面有15个&#x27;\0&#x27;，并且还有10个&#x27;c&#x27;字符，整体打印出&quot;abcdecccccccccc&quot;</span></span><br><span class="line">    str.<span class="built_in">resize</span>(<span class="number">30</span>, <span class="string">&#x27;c&#x27;</span>);</span><br><span class="line">    cout &lt;&lt; str &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; str.<span class="built_in">size</span>() &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; str.<span class="built_in">capacity</span>() &lt;&lt; endl &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//4.缩小size()值，并且可以看到，扩容的空间依旧有效</span></span><br><span class="line">    str.<span class="built_in">resize</span>(<span class="number">5</span>);</span><br><span class="line">    cout &lt;&lt; str &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; str.<span class="built_in">size</span>() &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; str.<span class="built_in">capacity</span>() &lt;&lt; endl &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="6-5-reserve"><a href="#6-5-reserve" class="headerlink" title="6.5.reserve()"></a>6.5.reserve()</h2><p>这个函数请求改变容量，要求将<code>string</code>对象调整到大小为<code>n</code>的容量（或者比<code>n</code>更大）这个函数对字符串的长度没有影响，也不能改变它的内容。</p>
<p>如果使用者做了缩小容量的操作，并且影响到原有<code>string</code>对象字符串的存储时，该函数会拒绝请求（即：<code>non-binding</code>无约束力的）。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//1.创建一个&quot;abcde&quot;为内容的string对象，size()值为5，capacity()默认值为15</span></span><br><span class="line">    <span class="function">string <span class="title">str</span><span class="params">(<span class="string">&quot;abcde&quot;</span>)</span></span>;</span><br><span class="line">    cout &lt;&lt; str &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; str.<span class="built_in">size</span>() &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; str.<span class="built_in">capacity</span>() &lt;&lt; endl &lt;&lt; endl;</span><br><span class="line">    <span class="comment">//2.调整capacity()值为20的string对象</span></span><br><span class="line">    str.<span class="built_in">reserve</span>(<span class="number">20</span>);</span><br><span class="line">    cout &lt;&lt; str &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; str.<span class="built_in">size</span>() &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; str.<span class="built_in">capacity</span>() &lt;&lt; endl &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//3.调整capacity()值为30的string对象</span></span><br><span class="line">    str.<span class="built_in">reserve</span>(<span class="number">30</span>);</span><br><span class="line">    cout &lt;&lt; str &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; str.<span class="built_in">size</span>() &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; str.<span class="built_in">capacity</span>() &lt;&lt; endl &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//4.减小capacity()值为4的string对象（失败请求）</span></span><br><span class="line">    str.<span class="built_in">reserve</span>(<span class="number">4</span>);</span><br><span class="line">    cout &lt;&lt; str &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; str.<span class="built_in">size</span>() &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; str.<span class="built_in">capacity</span>() &lt;&lt; endl &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//4.增大capacity()值为10的string对象</span></span><br><span class="line">    str.<span class="built_in">reserve</span>(<span class="number">10</span>);</span><br><span class="line">    cout &lt;&lt; str &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; str.<span class="built_in">size</span>() &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; str.<span class="built_in">capacity</span>() &lt;&lt; endl &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意：函数名<code>reserve</code>有时候会和单词<code>reversal</code>（反转）搞混，这个注意一下就行……</p>
</blockquote>
<h2 id="6-6-empty"><a href="#6-6-empty" class="headerlink" title="6.6.empty()"></a>6.6.empty()</h2><p>该函数返回字符串是否为空（即：<code>size()</code>是否为0)，这个函数不会以任何方式修改字符串的值。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">string <span class="title">str</span><span class="params">(<span class="string">&quot;abcdef&quot;</span>)</span></span>;</span><br><span class="line">    cout &lt;&lt; str.<span class="built_in">empty</span>() &lt;&lt; endl;</span><br><span class="line">    str.<span class="built_in">resize</span>(<span class="number">0</span>);<span class="comment">//为空返回true</span></span><br><span class="line">    cout &lt;&lt; str.<span class="built_in">empty</span>() &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="6-7-shrink-to-fit"><a href="#6-7-shrink-to-fit" class="headerlink" title="6.7.shrink_to_fit()"></a>6.7.shrink_to_fit()</h2><p><code>shrink to fit</code>这个词的意思就是“缩小以适应”，该函数请求减少容量<code>capacity</code>来适应大小<code>size</code>，当然这只是一种请求（即：<code>non-binding</code>无约束力的）。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">string <span class="title">str</span><span class="params">(<span class="string">&quot;abcde&quot;</span>)</span></span>;</span><br><span class="line">    cout &lt;&lt; str &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; str.<span class="built_in">size</span>() &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; str.<span class="built_in">capacity</span>() &lt;&lt; endl &lt;&lt; endl;</span><br><span class="line">    str.<span class="built_in">reserve</span>(<span class="number">1000</span>);<span class="comment">//明明大小只有5，容量确高达1000多，浪费资源</span></span><br><span class="line">    cout &lt;&lt; str &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; str.<span class="built_in">size</span>() &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; str.<span class="built_in">capacity</span>() &lt;&lt; endl &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    str.<span class="built_in">shrink_to_fit</span>();<span class="comment">//使用该函数请求缩小容量（非强制）</span></span><br><span class="line">    cout &lt;&lt; str &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; str.<span class="built_in">size</span>() &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; str.<span class="built_in">capacity</span>() &lt;&lt; endl &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="7-访问元素（Element-access）"><a href="#7-访问元素（Element-access）" class="headerlink" title="7.访问元素（Element access）"></a>7.访问元素（Element access）</h1><h2 id="7-1-operator"><a href="#7-1-operator" class="headerlink" title="7.1.operator[]"></a>7.1.operator[]</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//重载形式</span></span><br><span class="line"><span class="type">char</span>&amp; <span class="keyword">operator</span>[] (<span class="type">size_t</span> pos);</span><br><span class="line"><span class="type">const</span> <span class="type">char</span>&amp; <span class="keyword">operator</span>[] (<span class="type">size_t</span> pos) <span class="type">const</span>;</span><br></pre></td></tr></table></figure>

<p><code>pos</code>的起始位置为<code>0</code>，这意味这和数组的使用形式类似。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">string <span class="title">str</span><span class="params">(<span class="string">&quot;abcdef&quot;</span>)</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; str[i]; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; str[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果<code>pos</code>等于<code>string</code>对象的<code>size</code>值，这个符号重载函数就会返回一个指向空字符的引用，该字符位于<code>string</code>对象最后一个字符之后（这个字符不可被修改，只所以可以被允许访问的其中一个原因就是方便写循环终止条件，就像上面的循环例子）。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">string <span class="title">str</span><span class="params">(<span class="string">&quot;abcdef&quot;</span>)</span></span>;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;空字符-&gt;[&quot;</span> &lt;&lt; str[str.<span class="built_in">size</span>()] &lt;&lt; <span class="string">&quot;]&quot;</span> &lt;&lt; endl;<span class="comment">//可以看到空字符没有办法打印出来</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="7-2-at"><a href="#7-2-at" class="headerlink" title="7.2.at()"></a>7.2.at()</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//重载声明</span></span><br><span class="line"><span class="function"><span class="type">char</span>&amp; <span class="title">at</span> <span class="params">(<span class="type">size_t</span> pos)</span></span>;</span><br><span class="line"><span class="function"><span class="type">const</span> <span class="type">char</span>&amp; <span class="title">at</span> <span class="params">(<span class="type">size_t</span> pos)</span> <span class="type">const</span></span>;</span><br></pre></td></tr></table></figure>

<p>该函数可以获取字符串中的字符，返回一个<code>pos</code>指向字符的引用，该函数自动检查<code>pos</code>是否是<code>string</code>对象中合法的字符索引，非法则抛出异常。</p>
<p>那么<code>at()</code>和<code>[]</code>有什么区别呢？答案在于自动检查出现非法时，例如下面的代码：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function">string <span class="title">str</span><span class="params">(<span class="string">&quot;abcdef&quot;</span>)</span></span>;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;str = &quot;</span> &lt;&lt; str &lt;&lt; endl;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;str.size() = &quot;</span> &lt;&lt; str.<span class="built_in">size</span>() &lt;&lt; endl;</span><br><span class="line">        <span class="comment">//cout &lt;&lt; &quot;str[7] = &quot; &lt;&lt; str[7] &lt;&lt; endl;//第一情况</span></span><br><span class="line">        <span class="comment">//cout &lt;&lt; &quot;at(7) = &quot; &lt;&lt; str.at(7) &lt;&lt; endl;//第二情况</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">catch</span> (<span class="type">const</span> std::out_of_range&amp; e)<span class="comment">//出现异常时执行下面代码</span></span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;error&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用<code>[]</code>的报错和使用<code>at</code>的报错不一样。总的来说，抛异常会更加安全（并且抛异常是面向对象语言的一个显著特征）具体的抛异常细节我们以后再来学习……</p>
<h2 id="7-3-back"><a href="#7-3-back" class="headerlink" title="7.3.back()"></a>7.3.back()</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//重载声明</span></span><br><span class="line"><span class="function"><span class="type">char</span>&amp; <span class="title">back</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="type">const</span> <span class="type">char</span>&amp; <span class="title">back</span><span class="params">()</span> <span class="type">const</span></span>;</span><br></pre></td></tr></table></figure>

<p>该函数返回最后一个有效字符的引用（不是指空字符），此函数不能再空<code>string</code>对象上调用。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">string <span class="title">str1</span><span class="params">(<span class="string">&quot;abcdef&quot;</span>)</span></span>;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;str1 = &quot;</span> &lt;&lt; str1 &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;str1.size() = &quot;</span> &lt;&lt; str1.<span class="built_in">size</span>() &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;str1.back() = &quot;</span> &lt;&lt; str1.<span class="built_in">back</span>() &lt;&lt; endl;</span><br><span class="line">    <span class="function">string <span class="title">str2</span><span class="params">(<span class="string">&quot;&quot;</span>)</span></span>;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;str2 = &quot;</span> &lt;&lt; str2 &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;str2.size() = &quot;</span> &lt;&lt; str2.<span class="built_in">size</span>() &lt;&lt; endl;</span><br><span class="line">    <span class="comment">//cout &lt;&lt; &quot;str2.back() = &quot; &lt;&lt; str2.back() &lt;&lt; endl;//会出现报错</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="7-4-front"><a href="#7-4-front" class="headerlink" title="7.4.front()"></a>7.4.front()</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">char</span>&amp; <span class="title">front</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="type">const</span> <span class="type">char</span>&amp; <span class="title">front</span><span class="params">()</span> <span class="type">const</span></span>;</span><br></pre></td></tr></table></figure>

<p>类似<code>end()</code>的使用，不过获取到字符是开头的字符。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">string <span class="title">str1</span><span class="params">(<span class="string">&quot;abcdef&quot;</span>)</span></span>;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;str1 = &quot;</span> &lt;&lt; str1 &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;str1.size() = &quot;</span> &lt;&lt; str1.<span class="built_in">size</span>() &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;str1.front() = &quot;</span> &lt;&lt; str1.<span class="built_in">front</span>() &lt;&lt; endl;</span><br><span class="line">    <span class="function">string <span class="title">str2</span><span class="params">(<span class="string">&quot;&quot;</span>)</span></span>;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;str2 = &quot;</span> &lt;&lt; str2 &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;str2.size() = &quot;</span> &lt;&lt; str2.<span class="built_in">size</span>() &lt;&lt; endl;</span><br><span class="line">    <span class="comment">//cout &lt;&lt; &quot;str2.front() = &quot; &lt;&lt; str2.front() &lt;&lt; endl;//直接会出现报错</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="8-修改器（Modifiers）"><a href="#8-修改器（Modifiers）" class="headerlink" title="8.修改器（Modifiers）"></a>8.修改器（Modifiers）</h1><h2 id="8-1-operator"><a href="#8-1-operator" class="headerlink" title="8.1.operator+&#x3D;()"></a>8.1.operator+&#x3D;()</h2><p>用得比较多。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//重载声明</span></span><br><span class="line">string&amp; <span class="keyword">operator</span>+= (<span class="type">const</span> string&amp; str);</span><br><span class="line">string&amp; <span class="keyword">operator</span>+= (<span class="type">const</span> <span class="type">char</span>* s);</span><br><span class="line">string&amp; <span class="keyword">operator</span>+= (<span class="type">char</span> c);</span><br></pre></td></tr></table></figure>

<h2 id="8-2-append"><a href="#8-2-append" class="headerlink" title="8.2.append()"></a>8.2.append()</h2><p>尾插，即便有很多重载，但是用的比较少，这里只给出声明，您可以自己玩玩看。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//重载声明</span></span><br><span class="line"><span class="function">string&amp; <span class="title">append</span> <span class="params">(<span class="type">const</span> string&amp; str)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function">string&amp; <span class="title">append</span> <span class="params">(<span class="type">const</span> string&amp; str, <span class="type">size_t</span> subpos, <span class="type">size_t</span> sublen)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function">string&amp; <span class="title">append</span> <span class="params">(<span class="type">const</span> <span class="type">char</span>* s)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function">string&amp; <span class="title">append</span> <span class="params">(<span class="type">const</span> <span class="type">char</span>* s, <span class="type">size_t</span> n)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function">string&amp; <span class="title">append</span> <span class="params">(<span class="type">size_t</span> n, <span class="type">char</span> c)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">InputIterator</span>&gt;  </span><br><span class="line"><span class="function">string&amp; <span class="title">append</span> <span class="params">(InputIterator first, InputIterator last)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function">string&amp; <span class="title">append</span> <span class="params">(initializer_list&lt;<span class="type">char</span>&gt; il)</span></span>;</span><br></pre></td></tr></table></figure>

<h2 id="8-3-push-back"><a href="#8-3-push-back" class="headerlink" title="8.3.push_back ()"></a>8.3.push_back ()</h2><p>尾插单字符，爷用的比较少，您也可以自己玩玩。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//函数声明</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">push_back</span> <span class="params">(<span class="type">char</span> c)</span></span>;</span><br></pre></td></tr></table></figure>

<p>添加字符<code>c</code>到<code>string</code>对象的末尾，并且<code>size()</code>长度<code>+1</code>。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">string <span class="title">str</span><span class="params">(<span class="string">&quot;abcdef&quot;</span>)</span></span>;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;str = &quot;</span> &lt;&lt; str &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;str.size() = &quot;</span> &lt;&lt; str.<span class="built_in">size</span>() &lt;&lt; endl;</span><br><span class="line">    str.<span class="built_in">push_back</span>(<span class="string">&#x27;x&#x27;</span>);</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;str = &quot;</span> &lt;&lt; str &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;str.size() = &quot;</span> &lt;&lt; str.<span class="built_in">size</span>() &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以拿尾插类的函数来测试环境的扩容机制：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> NUMBER 100</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    string str;</span><br><span class="line">    <span class="type">size_t</span> old = str.<span class="built_in">capacity</span>();</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Init:&quot;</span> &lt;&lt; old &lt;&lt; endl;</span><br><span class="line">    <span class="type">size_t</span> newValue = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; NUMBER; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        str.<span class="built_in">push_back</span>(<span class="string">&#x27;x&#x27;</span>);<span class="comment">//推送</span></span><br><span class="line">        newValue = str.<span class="built_in">capacity</span>();<span class="comment">//记录新值</span></span><br><span class="line">        <span class="keyword">if</span> (newValue != old)<span class="comment">//新值和旧值对比</span></span><br><span class="line">        &#123;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;dilatation = &quot;</span> &lt;&lt; newValue &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">            old = newValue;</span><br><span class="line">            cout &lt;&lt; endl;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">test</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="8-4-instert"><a href="#8-4-instert" class="headerlink" title="8.4.instert()"></a>8.4.instert()</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//重载声明</span></span><br><span class="line"><span class="function">string&amp; <span class="title">insert</span> <span class="params">(<span class="type">size_t</span> pos, <span class="type">const</span> string&amp; str)</span></span>;<span class="comment">//插入string对象内的字符串</span></span><br><span class="line"></span><br><span class="line"><span class="function">string&amp; <span class="title">insert</span> <span class="params">(<span class="type">size_t</span> pos, <span class="type">const</span> string&amp; str, <span class="type">size_t</span> subpos, <span class="type">size_t</span> sublen)</span></span>;<span class="comment">//插入子串，注意这里后两个参数不是输入子串的首尾索引，而是输入子串的起始索引和子串长度</span></span><br><span class="line"></span><br><span class="line"><span class="function">string&amp; <span class="title">insert</span> <span class="params">(<span class="type">size_t</span> pos, <span class="type">const</span> <span class="type">char</span>* s)</span></span>;<span class="comment">//插入C风格的字符串</span></span><br><span class="line"></span><br><span class="line"><span class="function">string&amp; <span class="title">insert</span> <span class="params">(<span class="type">size_t</span> pos, <span class="type">const</span> <span class="type">char</span>* s, <span class="type">size_t</span> n)</span></span>;<span class="comment">////插入C风格的字符串，并且限定长度</span></span><br><span class="line"></span><br><span class="line"><span class="function">string&amp; <span class="title">insert</span> <span class="params">(<span class="type">size_t</span> pos, <span class="type">size_t</span> n, <span class="type">char</span> c)</span></span>;<span class="comment">//重复插入n个c字符</span></span><br><span class="line"></span><br><span class="line"><span class="function">iterator <span class="title">insert</span> <span class="params">(const_iterator p, <span class="type">size_t</span> n, <span class="type">char</span> c)</span></span>;<span class="comment">//使用迭代器来，插入重复的字符，并返回指向第一个插入元素的迭代器</span></span><br><span class="line"></span><br><span class="line"><span class="function">iterator <span class="title">insert</span> <span class="params">(const_iterator p, <span class="type">char</span> c)</span></span>;<span class="comment">//使用迭代定位，插入一个字符，并返回指向第一个插入元素的迭代器</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">InputIterator</span>&gt;</span><br><span class="line"><span class="function">iterator <span class="title">insert</span> <span class="params">(iterator p, InputIterator first, InputIterator last)</span></span>;<span class="comment">//将迭代器[first, last)的字符插入到目标string对象的迭代器定位处</span></span><br><span class="line"></span><br><span class="line"><span class="function">string&amp; <span class="title">insert</span> <span class="params">(const_iterator p, initializer_list&lt;<span class="type">char</span>&gt; il)</span></span>;<span class="comment">//在迭代器定位处插入字符序列</span></span><br></pre></td></tr></table></figure>

<p>可以看到这个函数有很多重载版本，让我们来用一个测试例子研究一下，不过这个函数能不用就最好别用，效率不高。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;1.string&amp; insert (size_t pos, const string&amp; str);&quot;</span> &lt;&lt; endl;</span><br><span class="line">    <span class="function">string <span class="title">str1</span><span class="params">(<span class="string">&quot;abcdef&quot;</span>)</span></span>;</span><br><span class="line">    cout &lt;&lt; str1 &lt;&lt; endl;</span><br><span class="line">    string sstr1 = <span class="string">&quot;xxxxx&quot;</span>;</span><br><span class="line">    str1.<span class="built_in">insert</span>(<span class="number">0</span>, sstr1);</span><br><span class="line">    cout &lt;&lt; str1 &lt;&lt; endl &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;2.string&amp; insert (size_t pos, const string&amp; str, size_t subpos, size_t sublen);&quot;</span> &lt;&lt; endl;</span><br><span class="line">    <span class="function">string <span class="title">str2</span><span class="params">(<span class="string">&quot;abcdef&quot;</span>)</span></span>;</span><br><span class="line">    cout &lt;&lt; str2 &lt;&lt; endl;</span><br><span class="line">    string sstr2 = <span class="string">&quot;ABCDEEEEFGHIJK&quot;</span>;</span><br><span class="line">    str2.<span class="built_in">insert</span>(str2.<span class="built_in">size</span>(), sstr2, <span class="number">4</span>, <span class="number">4</span>);</span><br><span class="line">    cout &lt;&lt; str2 &lt;&lt; endl &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;3.string&amp; insert (size_t pos, const char* s);&quot;</span> &lt;&lt; endl;</span><br><span class="line">    string str3 = <span class="string">&quot;abcdef&quot;</span>;<span class="comment">//这是一个C风格的字符串</span></span><br><span class="line">    cout &lt;&lt; str3 &lt;&lt; endl;</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span>* sstr3 = <span class="string">&quot;__________&quot;</span>;</span><br><span class="line">    str3.<span class="built_in">insert</span>(str3.<span class="built_in">size</span>(), sstr3);</span><br><span class="line">    cout &lt;&lt; str3 &lt;&lt; endl &lt;&lt; endl;;</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;4.string&amp; insert (size_t pos, const char* s, size_t n);&quot;</span> &lt;&lt; endl;</span><br><span class="line">    <span class="function">string <span class="title">str4</span><span class="params">(<span class="string">&quot;abcdef&quot;</span>)</span></span>;</span><br><span class="line">    cout &lt;&lt; str4 &lt;&lt; endl;</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span>* sstr4 = <span class="string">&quot;bbbbbxxxxxxxxxxxxxx&quot;</span>;<span class="comment">//只想截取长度为前5个字符的字符</span></span><br><span class="line">    str4.<span class="built_in">insert</span>(<span class="number">1</span>, sstr4, <span class="number">5</span>);</span><br><span class="line">    cout &lt;&lt; str4 &lt;&lt; endl &lt;&lt; endl;;</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;5.string&amp; insert (size_t pos, size_t n, char c);&quot;</span> &lt;&lt; endl;</span><br><span class="line">    <span class="function">string <span class="title">str5</span><span class="params">(<span class="string">&quot;ABCDEFG&quot;</span>)</span></span>;</span><br><span class="line">    cout &lt;&lt; str5 &lt;&lt; endl;</span><br><span class="line">    str5.<span class="built_in">insert</span>(<span class="number">1</span>, <span class="number">20</span>, <span class="string">&#x27;+&#x27;</span>);</span><br><span class="line">    cout &lt;&lt; str5 &lt;&lt; endl &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;6.iterator insert(const_iterator p, size_t n, char c);&quot;</span> &lt;&lt; endl;</span><br><span class="line">    string str6  = <span class="string">&quot;QWERT&quot;</span>;</span><br><span class="line">    str6.<span class="built_in">insert</span>(str6.<span class="built_in">begin</span>() + <span class="number">3</span>, <span class="number">10</span>, <span class="string">&#x27;c&#x27;</span>);</span><br><span class="line">    cout &lt;&lt; str6 &lt;&lt; endl &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;7.iterator insert (const_iterator p, char c);&quot;</span> &lt;&lt; endl;</span><br><span class="line">    string str7 = <span class="string">&quot;AAAAAAAAA&quot;</span>;</span><br><span class="line">    str7.<span class="built_in">insert</span>(str7.<span class="built_in">end</span>(), <span class="string">&#x27;c&#x27;</span>);</span><br><span class="line">    cout &lt;&lt; str7 &lt;&lt; endl &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;8.template &lt;class InputIterator&gt; &quot;</span> &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;  iterator insert(iterator p, InputIterator first, InputIterator last);&quot;</span> &lt;&lt; endl;</span><br><span class="line">    string str8 = <span class="string">&quot;XXXX&quot;</span>;</span><br><span class="line">    string sstr8 = <span class="string">&quot;|bcde|&quot;</span>;</span><br><span class="line">    str8.<span class="built_in">insert</span>(str8.<span class="built_in">begin</span>(), sstr8.<span class="built_in">begin</span>() + <span class="number">1</span>, sstr8.<span class="built_in">end</span>() - <span class="number">1</span>);</span><br><span class="line">    cout &lt;&lt; str8 &lt;&lt; endl &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;9. string&amp; insert (const_iterator p, initializer_list&lt;char&gt; il);&quot;</span> &lt;&lt; endl;</span><br><span class="line">    string str9 = <span class="string">&quot;XXXX&quot;</span>;</span><br><span class="line">    str9.<span class="built_in">insert</span>(str9.<span class="built_in">begin</span>() + <span class="number">2</span>, &#123; <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span> &#125;);</span><br><span class="line">    cout &lt;&lt; str9 &lt;&lt; endl &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="8-5-erase"><a href="#8-5-erase" class="headerlink" title="8.5.erase()"></a>8.5.erase()</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">string&amp; <span class="title">erase</span> <span class="params">(<span class="type">size_t</span> pos = <span class="number">0</span>, <span class="type">size_t</span> len = npos)</span></span>;<span class="comment">//全部删除（默认）</span></span><br><span class="line"></span><br><span class="line"><span class="function">iterator <span class="title">erase</span> <span class="params">(const_iterator p)</span></span>;<span class="comment">//使用迭代器删除指定位置</span></span><br><span class="line"></span><br><span class="line"><span class="function">iterator <span class="title">erase</span> <span class="params">(const_iterator first, const_iterator last)</span></span>;<span class="comment">//</span></span><br></pre></td></tr></table></figure>

<p>这个函数主要是用来擦除字符串的一部分，并减小<code>size()</code>的值，直接使用则默认为全部删除，这个函数能不用就最好别用，也是效率不太高。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">string str = <span class="string">&quot;abcdef&quot;</span>;</span><br><span class="line">cout &lt;&lt; str &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">str.<span class="built_in">erase</span>(str.<span class="built_in">begin</span>() + <span class="number">3</span>);</span><br><span class="line">cout &lt;&lt; str &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">str.<span class="built_in">erase</span>(str.<span class="built_in">begin</span>(), str.<span class="built_in">end</span>() - <span class="number">2</span>);</span><br><span class="line">cout &lt;&lt; str &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">str.<span class="built_in">erase</span>();</span><br><span class="line">cout &lt;&lt; str &lt;&lt; endl;</span><br></pre></td></tr></table></figure>

<h2 id="8-6-replace"><a href="#8-6-replace" class="headerlink" title="8.6.replace()"></a>8.6.replace()</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//string (1)    </span></span><br><span class="line"><span class="function">string&amp; <span class="title">replace</span> <span class="params">(<span class="type">size_t</span> pos,        <span class="type">size_t</span> len,        <span class="type">const</span> string&amp; str)</span></span>;</span><br><span class="line"><span class="function">string&amp; <span class="title">replace</span> <span class="params">(const_iterator i1, const_iterator i2, <span class="type">const</span> string&amp; str)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//substring (2)    </span></span><br><span class="line"><span class="function">string&amp; <span class="title">replace</span> <span class="params">(<span class="type">size_t</span> pos, <span class="type">size_t</span> len,        <span class="type">const</span> string&amp; str, <span class="type">size_t</span> subpos, <span class="type">size_t</span> sublen)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//c-string (3)    </span></span><br><span class="line"><span class="function">string&amp; <span class="title">replace</span> <span class="params">(<span class="type">size_t</span> pos, <span class="type">size_t</span> len, <span class="type">const</span> <span class="type">char</span>* s)</span></span>;</span><br><span class="line"><span class="function">string&amp; <span class="title">replace</span> <span class="params">(const_iterator i1, const_iterator i2, <span class="type">const</span> <span class="type">char</span>* s)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//buffer (4)    </span></span><br><span class="line"><span class="function">string&amp; <span class="title">replace</span> <span class="params">(<span class="type">size_t</span> pos, <span class="type">size_t</span> len,        <span class="type">const</span> <span class="type">char</span>* s, <span class="type">size_t</span> n)</span></span>;</span><br><span class="line"><span class="function">string&amp; <span class="title">replace</span> <span class="params">(const_iterator i1, const_iterator i2, <span class="type">const</span> <span class="type">char</span>* s, <span class="type">size_t</span> n)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//fill (5)    </span></span><br><span class="line"><span class="function">string&amp; <span class="title">replace</span> <span class="params">(<span class="type">size_t</span> pos, <span class="type">size_t</span> len,        <span class="type">size_t</span> n, <span class="type">char</span> c)</span></span>;</span><br><span class="line"><span class="function">string&amp; <span class="title">replace</span> <span class="params">(const_iterator i1, const_iterator i2, <span class="type">size_t</span> n, <span class="type">char</span> c)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//range (6)    </span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">InputIterator</span>&gt;</span><br><span class="line">  <span class="function">string&amp; <span class="title">replace</span> <span class="params">(const_iterator i1, const_iterator i2, InputIterator first, InputIterator last)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//initializer list (7)    </span></span><br><span class="line"><span class="function">string&amp; <span class="title">replace</span> <span class="params">(const_iterator i1, const_iterator i2, initializer_list&lt;<span class="type">char</span>&gt; il)</span></span>;</span><br></pre></td></tr></table></figure>

<p>该函数主要用于替换，参数也很多，您可以稍微玩一下：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">string str = <span class="string">&quot;abc def&quot;</span>;</span><br><span class="line">cout &lt;&lt; str &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">str.<span class="built_in">replace</span>(<span class="number">3</span>, <span class="number">2</span>, <span class="string">&quot;&amp;%#&quot;</span>);<span class="comment">//将str索引为3起始的长度为2的子串替换成&quot;&amp;%#&quot;</span></span><br><span class="line">cout &lt;&lt; str &lt;&lt; endl;</span><br></pre></td></tr></table></figure>

<p>也不太建议使用，效率比较低下，需要的时候可以使用一下。当然我们也可以自己设计一个算法解决：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//设计一个算法让下面string对象的空格改为20%</span></span><br><span class="line">    string str = <span class="string">&quot;abc def&quot;</span>;</span><br><span class="line">    string strx;</span><br><span class="line">    cout &lt;&lt; str &lt;&lt; endl;</span><br><span class="line">    <span class="comment">//空间换时间</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> ch : str)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch != <span class="string">&#x27; &#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            strx += ch;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            strx += <span class="string">&quot;20%&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//str = strx;</span></span><br><span class="line">    <span class="comment">//或者使用全局的swap()，但是使用这个会效率很低，内部有一次拷贝构造两次赋值，很糟糕</span></span><br><span class="line">    str.<span class="built_in">swap</span>(strx);<span class="comment">//string的swap()效率就会高很多，这个成员函数只是交换了指针指向，效率很高</span></span><br><span class="line">    cout &lt;&lt; str &lt;&lt; endl;</span><br><span class="line">    <span class="comment">//这样的效率都会比较高</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//不过需要注意的是，就算我们直接使用全局的swap()也不会真的调用到最麻烦的哪一个，因为库已经针对全局的swap()进行了重载，内部调用的也是成员的swap()</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="8-7-swap"><a href="#8-7-swap" class="headerlink" title="8.7.swap()"></a>8.7.swap()</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">swap</span> <span class="params">(string&amp; str)</span></span>;</span><br></pre></td></tr></table></figure>

<p>成员交换函数，效率比全局的要高，就是前面代码使用的那一个函数。后面介绍的全局<code>swap()</code>调用的就是这个成员函数。</p>
<h1 id="9-字符串运算（String-operations）"><a href="#9-字符串运算（String-operations）" class="headerlink" title="9.字符串运算（String operations）"></a>9.字符串运算（String operations）</h1><h2 id="9-1-c-str-和data"><a href="#9-1-c-str-和data" class="headerlink" title="9.1.c_str()和data()"></a>9.1.c_str()和data()</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//函数声明</span></span><br><span class="line"><span class="function"><span class="type">const</span> <span class="type">char</span>* <span class="title">c_str</span><span class="params">()</span> <span class="type">const</span> <span class="keyword">noexcept</span></span>;</span><br><span class="line"><span class="function"><span class="type">const</span> <span class="type">char</span>* <span class="title">data</span><span class="params">()</span> <span class="type">const</span> <span class="keyword">noexcept</span></span>;</span><br></pre></td></tr></table></figure>

<p>有时候为了和<code>C</code>兼容，需要使用<code>C</code>风格的字符串（以<code>\0</code>）。而<code>c_str()</code>可以使得<code>string</code>对象返回底层的<code>C</code>风格的字符串成员变量，从这里我们也可以看到，虽然<code>string</code>不以<code>\0</code>作为结尾标志，但是依旧会在构造<code>string</code>对象的时候存储<code>\0</code>，以保证能与<code>C</code>兼容。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">string <span class="title">str</span><span class="params">(<span class="string">&quot;abcdef&quot;</span>)</span></span>;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;str&quot;</span> &lt;&lt; <span class="string">&quot; = &quot;</span> &lt;&lt; str &lt;&lt; <span class="string">&quot; 类型：&quot;</span> &lt;&lt; <span class="built_in">typeid</span>(str).<span class="built_in">name</span>() &lt;&lt; endl &lt;&lt; endl;</span><br><span class="line">    <span class="type">char</span>* ch;</span><br><span class="line">    cout &lt;&lt; <span class="built_in">typeid</span>(ch).<span class="built_in">name</span>() &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;str.c_str()&quot;</span> &lt;&lt; <span class="string">&quot; = &quot;</span> &lt;&lt; str.<span class="built_in">c_str</span>() &lt;&lt; <span class="string">&quot; 类型：&quot;</span> &lt;&lt; <span class="built_in">typeid</span>(str.<span class="built_in">c_str</span>()).<span class="built_in">name</span>() &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;str.data()&quot;</span> &lt;&lt; <span class="string">&quot; = &quot;</span> &lt;&lt; str.<span class="built_in">data</span>() &lt;&lt; <span class="string">&quot; 类型：&quot;</span> &lt;&lt; <span class="built_in">typeid</span>(str.<span class="built_in">data</span>()).<span class="built_in">name</span>() &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>而<code>data()</code>和<code>s_str()</code>的使用是等价的，没有太大区别。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> length;</span><br><span class="line">    string str = <span class="string">&quot;Test string&quot;</span>;</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span>* cstr = <span class="string">&quot;Test string&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (str.<span class="built_in">length</span>() == <span class="built_in">strlen</span>(cstr))</span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;1&quot;</span> &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">memcmp</span>(cstr, str.<span class="built_in">data</span>(), str.<span class="built_in">length</span>()) == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;1&quot;</span> &lt;&lt; endl;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="9-2-cpoy"><a href="#9-2-cpoy" class="headerlink" title="9.2.cpoy()"></a>9.2.cpoy()</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//函数声明</span></span><br><span class="line"><span class="function"><span class="type">size_t</span> <span class="title">copy</span> <span class="params">(<span class="type">char</span>* s, <span class="type">size_t</span> len, <span class="type">size_t</span> pos = <span class="number">0</span>)</span> <span class="type">const</span></span>;</span><br></pre></td></tr></table></figure>

<p>将<code>string</code>对象当前值，从<code>pos</code>位置开始的长度为<code>len</code>子串拷贝到<code>s</code>指向的数组中。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">std::string <span class="title">str</span><span class="params">(<span class="string">&quot;abcd&quot;</span>)</span></span>;</span><br><span class="line">    <span class="type">char</span> s[<span class="number">3</span>] = &#123; <span class="number">0</span> &#125;;<span class="comment">//如果这里没有加入初始化&#123; 0 &#125;，那么后续打印s数组就会出现乱码，原因就是找不到空字符</span></span><br><span class="line">    str.<span class="built_in">copy</span>(s, <span class="number">2</span>);</span><br><span class="line">    std::cout &lt;&lt; s &lt;&lt; std::endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="9-3-find-和rfind"><a href="#9-3-find-和rfind" class="headerlink" title="9.3.find()和rfind()"></a>9.3.find()和rfind()</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">size_t</span> <span class="title">find</span> <span class="params">(<span class="type">const</span> string&amp; str, <span class="type">size_t</span> pos = <span class="number">0</span>)</span> <span class="type">const</span> <span class="keyword">noexcept</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">size_t</span> <span class="title">find</span> <span class="params">(<span class="type">const</span> <span class="type">char</span>* s, <span class="type">size_t</span> pos = <span class="number">0</span>)</span> <span class="type">const</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">size_t</span> <span class="title">find</span> <span class="params">(<span class="type">const</span> <span class="type">char</span>* s, <span class="type">size_t</span> pos, size_type n)</span> <span class="type">const</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">size_t</span> <span class="title">find</span> <span class="params">(<span class="type">char</span> c, <span class="type">size_t</span> pos = <span class="number">0</span>)</span> <span class="type">const</span> <span class="keyword">noexcept</span></span>;</span><br></pre></td></tr></table></figure>

<p>该函数可以寻找字符串或者<code>string</code>对象中的内容，。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//1.寻找string子串</span></span><br><span class="line">    <span class="function">string <span class="title">str1</span><span class="params">(<span class="string">&quot;abcd-abcd-abcd&quot;</span>)</span></span>;</span><br><span class="line">    <span class="function">string <span class="title">str2</span><span class="params">(<span class="string">&quot;abcd&quot;</span>)</span></span>;</span><br><span class="line">    cout &lt;&lt; str1.<span class="built_in">find</span>(str2, <span class="number">0</span>) &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; str1.<span class="built_in">find</span>(str2, <span class="number">1</span>) &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; str1.<span class="built_in">find</span>(str2, <span class="number">6</span>) &lt;&lt; endl &lt;&lt; endl;</span><br><span class="line">    <span class="comment">//2.寻找C风格子串</span></span><br><span class="line">    <span class="function">string <span class="title">str3</span><span class="params">(<span class="string">&quot;ABCD-ABCD-ABCD&quot;</span>)</span></span>;</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span>* str4 = <span class="string">&quot;ABCD&quot;</span>;</span><br><span class="line">    cout &lt;&lt; str3.<span class="built_in">find</span>(str4, <span class="number">0</span>) &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; str3.<span class="built_in">find</span>(str4, <span class="number">1</span>) &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; str3.<span class="built_in">find</span>(str4, <span class="number">6</span>) &lt;&lt; endl &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//3.在范围内寻找C风格子串</span></span><br><span class="line">    <span class="function">string <span class="title">str5</span><span class="params">(<span class="string">&quot;ABCD-AB-ABCD-AB-ABCD&quot;</span>)</span></span>;</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span>* str6 = <span class="string">&quot;ABCD&quot;</span>;</span><br><span class="line">    cout &lt;&lt; str5.<span class="built_in">find</span>(str6, <span class="number">0</span>, <span class="number">2</span>) &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; str5.<span class="built_in">find</span>(str6, <span class="number">1</span>, <span class="number">2</span>) &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; str5.<span class="built_in">find</span>(str6, <span class="number">6</span>, <span class="number">2</span>) &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; str5.<span class="built_in">find</span>(str6, <span class="number">9</span>, <span class="number">2</span>) &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; str5.<span class="built_in">find</span>(str6, <span class="number">14</span>, <span class="number">2</span>) &lt;&lt; endl &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//4.寻找字符</span></span><br><span class="line">    <span class="function">string <span class="title">str7</span><span class="params">(<span class="string">&quot;xxxxxxx_xxxx_xxxxxxxxxx_&quot;</span>)</span></span>;</span><br><span class="line">    <span class="type">char</span> ch = <span class="string">&#x27;_&#x27;</span>;</span><br><span class="line">    <span class="type">int</span> j = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; str7.<span class="built_in">size</span>(); i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> z = str7.<span class="built_in">find</span>(ch, i);</span><br><span class="line">        <span class="keyword">if</span> (j != z)</span><br><span class="line">        &#123;</span><br><span class="line">            cout &lt;&lt; z &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">            j = z;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>而<code>rfind()</code>就是逆向查找，具体定义看下文档就行，使用和<code>find()</code>类似。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//重载声明</span></span><br><span class="line"><span class="function"><span class="type">size_t</span> <span class="title">rfind</span> <span class="params">(<span class="type">const</span> string&amp; str, <span class="type">size_t</span> pos = npos)</span> <span class="type">const</span> <span class="keyword">noexcept</span></span>; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">size_t</span> <span class="title">rfind</span> <span class="params">(<span class="type">const</span> <span class="type">char</span>* s, <span class="type">size_t</span> pos = npos)</span> <span class="type">const</span></span>; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">size_t</span> <span class="title">rfind</span> <span class="params">(<span class="type">const</span> <span class="type">char</span>* s, <span class="type">size_t</span> pos, <span class="type">size_t</span> n)</span> <span class="type">const</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">size_t</span> <span class="title">rfind</span> <span class="params">(<span class="type">char</span> c, <span class="type">size_t</span> pos = npos)</span> <span class="type">const</span> <span class="keyword">noexcept</span></span>;</span><br></pre></td></tr></table></figure>

<h2 id="9-4-substr"><a href="#9-4-substr" class="headerlink" title="9.4.substr()"></a>9.4.substr()</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//函数声明</span></span><br><span class="line"><span class="function">string <span class="title">substr</span> <span class="params">(<span class="type">size_t</span> pos = <span class="number">0</span>, <span class="type">size_t</span> len = npos)</span> <span class="type">const</span></span>;</span><br></pre></td></tr></table></figure>

<p>这个函数可以用来生成一个新的子串对象（从源string对象的pos开始的长度为len的子字符串）。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">string <span class="title">str</span><span class="params">(<span class="string">&quot;awwwwf&quot;</span>)</span></span>;</span><br><span class="line">    cout &lt;&lt; str.<span class="built_in">substr</span>(<span class="number">1</span>, <span class="number">4</span>) &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="9-5-compare"><a href="#9-5-compare" class="headerlink" title="9.5.compare()"></a>9.5.compare()</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//重载函数</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">compare</span> <span class="params">(<span class="type">const</span> string&amp; str)</span> <span class="type">const</span> <span class="keyword">noexcept</span></span>;<span class="comment">//比较两个string对象</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">compare</span> <span class="params">(<span class="type">size_t</span> pos, <span class="type">size_t</span> len, <span class="type">const</span> string&amp; str)</span> <span class="type">const</span></span>;<span class="comment">//在源string对象的子串和str对象比较</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">compare</span> <span class="params">(<span class="type">size_t</span> pos, <span class="type">size_t</span> len, <span class="type">const</span> string&amp; str, <span class="type">size_t</span> subpos, <span class="type">size_t</span> sublen)</span> <span class="type">const</span></span>;<span class="comment">//在源string对象的子串内和str对象的子串比较</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">compare</span> <span class="params">(<span class="type">const</span> <span class="type">char</span>* s)</span> <span class="type">const</span></span>;<span class="comment">//和C风格的字符串比较</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">compare</span> <span class="params">(<span class="type">size_t</span> pos, <span class="type">size_t</span> len, <span class="type">const</span> <span class="type">char</span>* s)</span> <span class="type">const</span></span>;<span class="comment">//string对象的子串和C风格的字符串比较</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">compare</span> <span class="params">(<span class="type">size_t</span> pos, <span class="type">size_t</span> len, <span class="type">const</span> <span class="type">char</span>* s, <span class="type">size_t</span> n)</span> <span class="type">const</span></span>;<span class="comment">//string对象的子串和C风格的字符串的子串比较</span></span><br></pre></td></tr></table></figure>

<p>该函数主要是比较字符大小，和<code>C</code>语言的<code>strcmp()</code>类似返回指定的字符序列。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="comment">// comparing apples with apples</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">string <span class="title">str1</span><span class="params">(<span class="string">&quot;green apple&quot;</span>)</span></span>;</span><br><span class="line">    <span class="function">string <span class="title">str2</span><span class="params">(<span class="string">&quot;red apple&quot;</span>)</span></span>;</span><br><span class="line">    <span class="comment">//g &lt; r &lt;=&gt; g - r &lt; 0</span></span><br><span class="line">    <span class="comment">//&quot;green apple&quot; &lt; &quot;red apple&quot;</span></span><br><span class="line">    <span class="keyword">if</span> (str1.<span class="built_in">compare</span>(str2) &lt; <span class="number">0</span>)</span><br><span class="line">        cout &lt;&lt; str1 &lt;&lt; <span class="string">&quot; is not &quot;</span> &lt;&lt; str2 &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//&quot;apple&quot; == &quot;apple&quot;</span></span><br><span class="line">    <span class="keyword">if</span> (str1.<span class="built_in">compare</span>(<span class="number">6</span>, <span class="number">5</span>, <span class="string">&quot;apple&quot;</span>) == <span class="number">0</span>)</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;still, &quot;</span> &lt;&lt; str1 &lt;&lt; <span class="string">&quot; is an apple&quot;</span> &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//&quot;apple&quot; == &quot;apple&quot;</span></span><br><span class="line">    <span class="keyword">if</span> (str2.<span class="built_in">compare</span>(str2.<span class="built_in">size</span>() - <span class="number">5</span>, <span class="number">5</span>, <span class="string">&quot;apple&quot;</span>) == <span class="number">0</span>)</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;and &quot;</span> &lt;&lt; str2 &lt;&lt; <span class="string">&quot; is also an apple&quot;</span> &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//&quot;apple&quot; == &quot;apple&quot; </span></span><br><span class="line">    <span class="keyword">if</span> (str1.<span class="built_in">compare</span>(<span class="number">6</span>, <span class="number">5</span>, str2, <span class="number">4</span>, <span class="number">5</span>) == <span class="number">0</span>)</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;therefore, both are apples&quot;</span> &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    <span class="type">const</span> <span class="type">char</span>* str3 = <span class="string">&quot;green apple&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span> (str1.<span class="built_in">compare</span>(str3) == <span class="number">0</span>)</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;one and the same&quot;</span> &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>不过这个函数不怎么使用，原因是后面有很多的判断符号重载，这些重载更加方便。</p>
<h2 id="9-6-find-first-of"><a href="#9-6-find-first-of" class="headerlink" title="9.6.find_first_of()"></a>9.6.find_first_of()</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//重载函数</span></span><br><span class="line"><span class="function"><span class="type">size_t</span> <span class="title">find_first_of</span> <span class="params">(<span class="type">const</span> string&amp; str, <span class="type">size_t</span> pos = <span class="number">0</span>)</span> <span class="type">const</span> <span class="keyword">noexcept</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">size_t</span> <span class="title">find_first_of</span> <span class="params">(<span class="type">const</span> <span class="type">char</span>* s, <span class="type">size_t</span> pos = <span class="number">0</span>)</span> <span class="type">const</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">size_t</span> <span class="title">find_first_of</span> <span class="params">(<span class="type">const</span> <span class="type">char</span>* s, <span class="type">size_t</span> pos, <span class="type">size_t</span> n)</span> <span class="type">const</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">size_t</span> <span class="title">find_first_of</span> <span class="params">(<span class="type">char</span> c, <span class="type">size_t</span> pos = <span class="number">0</span>)</span> <span class="type">const</span> <span class="keyword">noexcept</span></span>;</span><br></pre></td></tr></table></figure>

<p>在字符串中查找第一次出现指定字符集合中任何一个字符的位置。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    string str1 = <span class="string">&quot;xxx_big_apple_xxx&quot;</span>;</span><br><span class="line">    string str2 = <span class="string">&quot;be&quot;</span>;</span><br><span class="line">    cout &lt;&lt; str1.<span class="built_in">find_first_of</span>(str2, <span class="number">0</span>) &lt;&lt; endl;<span class="comment">//输出4</span></span><br><span class="line">    cout &lt;&lt; str1.<span class="built_in">find_first_of</span>(str2, <span class="number">5</span>) &lt;&lt; endl;<span class="comment">//输出12</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>吐槽：这个函数的名字真不好理解……</p>
</blockquote>
<h2 id="9-7-find-last-of"><a href="#9-7-find-last-of" class="headerlink" title="9.7.find_last_of()"></a>9.7.find_last_of()</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//重载函数</span></span><br><span class="line"><span class="function"><span class="type">size_t</span> <span class="title">find_last_of</span> <span class="params">(<span class="type">const</span> string&amp; str, <span class="type">size_t</span> pos = npos)</span> <span class="type">const</span> <span class="keyword">noexcept</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">size_t</span> <span class="title">find_last_of</span> <span class="params">(<span class="type">const</span> <span class="type">char</span>* s, <span class="type">size_t</span> pos = npos)</span> <span class="type">const</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">size_t</span> <span class="title">find_last_of</span> <span class="params">(<span class="type">const</span> <span class="type">char</span>* s, <span class="type">size_t</span> pos, <span class="type">size_t</span> n)</span> <span class="type">const</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">size_t</span> <span class="title">find_last_of</span> <span class="params">(<span class="type">char</span> c, <span class="type">size_t</span> pos = npos)</span> <span class="type">const</span> <span class="keyword">noexcept</span></span>;</span><br></pre></td></tr></table></figure>

<p>在字符串中查找最后一次出现指定字符集合中任何一个字符的位置。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    string str1 = <span class="string">&quot;xxx_big_apple_xxx&quot;</span>;</span><br><span class="line">    string str2 = <span class="string">&quot;be&quot;</span>;</span><br><span class="line">    cout &lt;&lt; str1.<span class="built_in">find_last_of</span>(str2, str1.<span class="built_in">size</span>() - <span class="number">1</span>) &lt;&lt; endl;<span class="comment">//输出12</span></span><br><span class="line">    cout &lt;&lt; str1.<span class="built_in">find_last_of</span>(str2, <span class="number">11</span>) &lt;&lt; endl;<span class="comment">//输出4</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="9-8-find-first-not-of"><a href="#9-8-find-first-not-of" class="headerlink" title="9.8.find_first_not_of()"></a>9.8.find_first_not_of()</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//重载函数</span></span><br><span class="line"><span class="function"><span class="type">size_t</span> <span class="title">find_first_not_of</span> <span class="params">(<span class="type">const</span> string&amp; str, <span class="type">size_t</span> pos = <span class="number">0</span>)</span> <span class="type">const</span> <span class="keyword">noexcept</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">size_t</span> <span class="title">find_first_not_of</span> <span class="params">(<span class="type">const</span> <span class="type">char</span>* s, <span class="type">size_t</span> pos = <span class="number">0</span>)</span> <span class="type">const</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">size_t</span> <span class="title">find_first_not_of</span> <span class="params">(<span class="type">const</span> <span class="type">char</span>* s, <span class="type">size_t</span> pos, <span class="type">size_t</span> n)</span> <span class="type">const</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">size_t</span> <span class="title">find_first_not_of</span> <span class="params">(<span class="type">char</span> c, <span class="type">size_t</span> pos = <span class="number">0</span>)</span> <span class="type">const</span> <span class="keyword">noexcept</span></span>;</span><br></pre></td></tr></table></figure>

<p>这个函数可以查找不是指定字符集合中的任何一个字符的位置。</p>
<p>下面是一个例子（制作屏蔽词语）：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">string <span class="title">str</span><span class="params">(<span class="string">&quot;saldgcaslucdgleakjslaejcsfkajsasducgiasfg&quot;</span>)</span></span>;</span><br><span class="line">    <span class="type">size_t</span> index = str.<span class="built_in">find_first_not_of</span>(<span class="string">&quot;abcdef&quot;</span>, <span class="number">0</span>);</span><br><span class="line">    cout &lt;&lt; str &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">while</span> (index != string::npos)</span><br><span class="line">    &#123;</span><br><span class="line">        str[index] = <span class="string">&#x27;*&#x27;</span>;</span><br><span class="line">        index = str.<span class="built_in">find_first_not_of</span>(<span class="string">&quot;abcdef&quot;</span>, index + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; str &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="9-9-find-last-not-of"><a href="#9-9-find-last-not-of" class="headerlink" title="9.9.find_last_not_of()"></a>9.9.find_last_not_of()</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//重载函数</span></span><br><span class="line"><span class="function"><span class="type">size_t</span> <span class="title">find_last_not_of</span> <span class="params">(<span class="type">const</span> string&amp; str, <span class="type">size_t</span> pos = npos)</span> <span class="type">const</span> <span class="keyword">noexcept</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">size_t</span> <span class="title">find_last_not_of</span> <span class="params">(<span class="type">const</span> <span class="type">char</span>* s, <span class="type">size_t</span> pos = npos)</span> <span class="type">const</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">size_t</span> <span class="title">find_last_not_of</span> <span class="params">(<span class="type">const</span> <span class="type">char</span>* s, <span class="type">size_t</span> pos, <span class="type">size_t</span> n)</span> <span class="type">const</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">size_t</span> <span class="title">find_last_not_of</span> <span class="params">(<span class="type">char</span> c, <span class="type">size_t</span> pos = npos)</span> <span class="type">const</span> <span class="keyword">noexcept</span></span>;</span><br></pre></td></tr></table></figure>

<p>上面这个函数就是从后面开始查找，这里就不再举例了……</p>
<h2 id="9-10-get-allocator"><a href="#9-10-get-allocator" class="headerlink" title="9.10.get_allocator()"></a>9.10.get_allocator()</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//函数声明</span></span><br><span class="line"><span class="function">allocator_type <span class="title">get_allocator</span><span class="params">()</span> <span class="type">const</span> <span class="keyword">noexcept</span></span>;</span><br></pre></td></tr></table></figure>

<p>这个函数就比较复杂了，您可以先去查看一下文档，或者以后我们有机会再来详谈……</p>
<h2 id="9-11-assign"><a href="#9-11-assign" class="headerlink" title="9.11.assign()"></a>9.11.assign()</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//重载函数</span></span><br><span class="line"><span class="function">string&amp; <span class="title">assign</span> <span class="params">(<span class="type">const</span> string&amp; str)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function">string&amp; <span class="title">assign</span> <span class="params">(<span class="type">const</span> string&amp; str, <span class="type">size_t</span> subpos, <span class="type">size_t</span> sublen)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function">string&amp; <span class="title">assign</span> <span class="params">(<span class="type">const</span> <span class="type">char</span>* s)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function">string&amp; <span class="title">assign</span> <span class="params">(<span class="type">const</span> <span class="type">char</span>* s, <span class="type">size_t</span> n)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function">string&amp; <span class="title">assign</span> <span class="params">(<span class="type">size_t</span> n, <span class="type">char</span> c)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">InputIterator</span>&gt;</span><br><span class="line">   <span class="function">string&amp; <span class="title">assign</span> <span class="params">(InputIterator first, InputIterator last)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function">string&amp; <span class="title">assign</span> <span class="params">(initializer_list&lt;<span class="type">char</span>&gt; il)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function">string&amp; <span class="title">assign</span> <span class="params">(string&amp;&amp; str)</span> <span class="keyword">noexcept</span></span>;</span><br></pre></td></tr></table></figure>

<p>这个函数也不经常使用，实际在一种赋值的工作：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    string str1 = <span class="string">&quot;abcdef&quot;</span>;</span><br><span class="line">    string str2 = <span class="string">&quot;xxxxxx&quot;</span>;</span><br><span class="line">    str1.<span class="built_in">assign</span>(str2);</span><br><span class="line">    cout &lt;&lt; str1 &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; str2 &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="10-常量成员（Member-constants）"><a href="#10-常量成员（Member-constants）" class="headerlink" title="10.常量成员（Member constants）"></a>10.常量成员（Member constants）</h1><p>string类的常量成员，也就是前面介绍的<code>npos</code>，之前已经简单提到过，这里就放一下<code>npos</code>的定义使得本文章足够完整：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//常量定义</span></span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">size_t</span> npos = <span class="number">-1</span>;</span><br></pre></td></tr></table></figure>

<h1 id="11-非成员函数重载（Non-member-function-overloads）"><a href="#11-非成员函数重载（Non-member-function-overloads）" class="headerlink" title="11.非成员函数重载（Non-member function overloads）"></a>11.非成员函数重载（Non-member function overloads）</h1><h2 id="11-1-operator"><a href="#11-1-operator" class="headerlink" title="11.1.operator+()"></a>11.1.operator+()</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">string <span class="keyword">operator</span>+ (<span class="type">const</span> string&amp; lhs, <span class="type">const</span> string&amp; rhs);</span><br><span class="line"></span><br><span class="line">string <span class="keyword">operator</span>+ (<span class="type">const</span> string&amp; lhs, <span class="type">const</span> <span class="type">char</span>* rhs);</span><br><span class="line">string <span class="keyword">operator</span>+ (<span class="type">const</span> <span class="type">char</span>* lhs, <span class="type">const</span> string&amp; rhs);</span><br><span class="line"></span><br><span class="line">string <span class="keyword">operator</span>+ (<span class="type">const</span> string&amp; lhs, <span class="type">char</span>          rhs);</span><br><span class="line">string <span class="keyword">operator</span>+ (<span class="type">char</span> lhs, <span class="type">const</span> string&amp; rhs);</span><br></pre></td></tr></table></figure>

<p><code>+</code>的代价要比<code>+=</code>大，因此非必要不要轻易使用<code>+</code>，这里就不演示<code>+</code>的使用了，您玩一下就行。</p>
<h2 id="11-2-relational-operators"><a href="#11-2-relational-operators" class="headerlink" title="11.2.relational operators"></a>11.2.relational operators</h2><p>一些比较运算符重载：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">//(1)</span><br><span class="line">bool operator== (const string&amp; lhs, const string&amp; rhs);</span><br><span class="line">bool operator== (const char*   lhs, const string&amp; rhs);</span><br><span class="line">bool operator== (const string&amp; lhs, const char*   rhs);</span><br><span class="line"></span><br><span class="line">//(2)    </span><br><span class="line">bool operator!= (const string&amp; lhs, const string&amp; rhs);</span><br><span class="line">bool operator!= (const char*   lhs, const string&amp; rhs);</span><br><span class="line">bool operator!= (const string&amp; lhs, const char*   rhs);</span><br><span class="line"></span><br><span class="line">//(3)    </span><br><span class="line">bool operator&lt;  (const string&amp; lhs, const string&amp; rhs);</span><br><span class="line">bool operator&lt;  (const char*   lhs, const string&amp; rhs);</span><br><span class="line">bool operator&lt;  (const string&amp; lhs, const char*   rhs);</span><br><span class="line"></span><br><span class="line">//(4)    </span><br><span class="line">bool operator&lt;= (const string&amp; lhs, const string&amp; rhs);</span><br><span class="line">bool operator&lt;= (const char*   lhs, const string&amp; rhs);</span><br><span class="line">bool operator&lt;= (const string&amp; lhs, const char*   rhs);</span><br><span class="line"></span><br><span class="line">//(5)    </span><br><span class="line">bool operator&gt;  (const string&amp; lhs, const string&amp; rhs);</span><br><span class="line">bool operator&gt;  (const char*   lhs, const string&amp; rhs);</span><br><span class="line">bool operator&gt;  (const string&amp; lhs, const char*   rhs);</span><br><span class="line"></span><br><span class="line">//(6)    </span><br><span class="line">bool operator&gt;= (const string&amp; lhs, const string&amp; rhs);</span><br><span class="line">bool operator&gt;= (const char*   lhs, const string&amp; rhs);</span><br><span class="line">bool operator&gt;= (const string&amp; lhs, const char*   rhs);</span><br></pre></td></tr></table></figure>

<p>内部使用<code>string::compare()</code>函数来进行比较。</p>
<h2 id="11-3-swap"><a href="#11-3-swap" class="headerlink" title="11.3.swap()"></a>11.3.swap()</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//重载声明</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">swap</span> <span class="params">(string&amp; str)</span></span>;</span><br></pre></td></tr></table></figure>

<p>全局交换函数，内部调用了成员函数<code>swap()</code>，这个重载是为了防止调用到低效的全局交换函数。</p>
<h2 id="11-4-operator-和operator"><a href="#11-4-operator-和operator" class="headerlink" title="11.4.operator&gt;&gt;()和operator&lt;&lt;()"></a>11.4.operator&gt;&gt;()和operator&lt;&lt;()</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">istream&amp; <span class="keyword">operator</span>&gt;&gt; (istream&amp; is, string&amp; str);</span><br><span class="line">ostream&amp; <span class="keyword">operator</span>&lt;&lt; (ostream&amp; os, <span class="type">const</span> string&amp; str);</span><br></pre></td></tr></table></figure>

<p>这个就是辅助<code>string</code>进行流插入和流输出的重载，也是看下就行，<code>IO</code>类的函数我们以后还会深入讲解。</p>
<h2 id="11-5-getline"><a href="#11-5-getline" class="headerlink" title="11.5.getline()"></a>11.5.getline()</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">istream&amp; <span class="title">getline</span> <span class="params">(istream&amp; is, string&amp; str, <span class="type">char</span> delim)</span></span>;</span><br><span class="line"><span class="function">istream&amp; <span class="title">getline</span> <span class="params">(istream&amp; is, string&amp; str)</span></span>;</span><br></pre></td></tr></table></figure>

<p>这个函数使用的频率也比较高，主要是从流<code>is</code>中获取一行输入<code>string</code>对象，直到遇到文件结束符<code>EOF</code>分隔符，由于返回的是流<code>is</code>的引用，因此可以重复读取。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//方式1</span></span><br><span class="line">string str1;</span><br><span class="line">cin &gt;&gt; str1;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;str1:&quot;</span> &lt;&lt; str1 &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"><span class="comment">//方式2</span></span><br><span class="line">string str2;</span><br><span class="line"><span class="built_in">getline</span>(cin, str2);</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;str2:&quot;</span> &lt;&lt; str2 &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"><span class="comment">//方式3</span></span><br><span class="line">string str3;</span><br><span class="line"><span class="built_in">getline</span>(cin, str3, <span class="string">&#x27;$&#x27;</span>);<span class="comment">//遇到$就停止读取，抛弃掉$，不再进入后续的输入</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;str3:&quot;</span> &lt;&lt; str3 &lt;&lt; endl;</span><br></pre></td></tr></table></figure>

<p>方式<code>1</code>不可以输入带有空格的 ，方式<code>2</code>可以，方式<code>3</code>可以指定结束符号。</p>
<h1 id="12-string相关题目练习"><a href="#12-string相关题目练习" class="headerlink" title="12.string相关题目练习"></a>12.string相关题目练习</h1><h2 id="12-1-字符串中的第一个唯一字符"><a href="#12-1-字符串中的第一个唯一字符" class="headerlink" title="12.1.字符串中的第一个唯一字符"></a>12.1.<a target="_blank" rel="noopener" href="https://leetcode.cn/problems/first-unique-character-in-a-string/">字符串中的第一个唯一字符</a></h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">firstUniqChar</span><span class="params">(string s)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">//1.开始计数，生成计数表</span></span><br><span class="line">        <span class="type">int</span> arr[<span class="number">26</span>] = &#123; <span class="number">0</span> &#125;;<span class="comment">//先定义一个数组存储每个字符的出现个数</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> ch : s)</span><br><span class="line">        &#123;</span><br><span class="line">            arr[ch - <span class="string">&#x27;a&#x27;</span>]++;<span class="comment">//开始计数</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2.根据string对象和计数表寻找索引</span></span><br><span class="line">        <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; s.<span class="built_in">size</span>(); i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (arr[s[i] - <span class="string">&#x27;a&#x27;</span>] == <span class="number">1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="12-2-将网址分割为：协议、域名、资源名"><a href="#12-2-将网址分割为：协议、域名、资源名" class="headerlink" title="12.2.将网址分割为：协议、域名、资源名"></a>12.2.将网址分割为：协议、域名、资源名</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">mian</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//1.输入网址url</span></span><br><span class="line">    string url;<span class="comment">//https-&gt;://baidu.com-&gt;/limou/file/text</span></span><br><span class="line">    cin &gt;&gt; url;</span><br><span class="line">    <span class="comment">//2.寻找并且拆解url</span></span><br><span class="line">    string protocol;<span class="comment">//协议</span></span><br><span class="line">    string domain;<span class="comment">//域名</span></span><br><span class="line">    string resource;<span class="comment">//资源</span></span><br><span class="line">    <span class="comment">//2.1.寻找协议</span></span><br><span class="line">    <span class="type">int</span> index1 = url.<span class="built_in">find</span>(<span class="string">&quot;:&quot;</span>);<span class="comment">//5</span></span><br><span class="line">    <span class="keyword">if</span> (index1 == string::npos)</span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;没有协议，退出程序&quot;</span> &lt;&lt; endl;</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//2.2.寻找域名</span></span><br><span class="line">    <span class="type">int</span> index2 = url.<span class="built_in">find</span>(<span class="string">&quot;/&quot;</span>, index1 + <span class="number">3</span>);<span class="comment">//17</span></span><br><span class="line">    <span class="keyword">if</span> (index2 == string::npos)</span><br><span class="line">    &#123;</span><br><span class="line">        index2 = url.<span class="built_in">size</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//2.3.赋值三个对象</span></span><br><span class="line">    protocol = url.<span class="built_in">substr</span>(<span class="number">0</span>, index1);</span><br><span class="line">    domain = url.<span class="built_in">substr</span>(index1 + <span class="number">3</span>, index2 - (index1 + <span class="number">3</span>));<span class="comment">//17-5-3 = 12-3 = 9</span></span><br><span class="line">    <span class="keyword">if</span> (index2 != url.<span class="built_in">size</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        resource = url.<span class="built_in">substr</span>(index2 + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//3.输出结果</span></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;protocol = &quot;</span> &lt;&lt; protocol &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">if</span> (domain.<span class="built_in">size</span>() != <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;domain = &quot;</span> &lt;&lt; domain &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;没有域名&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(resource.<span class="built_in">size</span>() != <span class="number">0</span>)</span><br><span class="line">    &#123; </span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;resource = &quot;</span> &lt;&lt; resource &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;没有资源&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="12-3-仅仅反转字母"><a href="#12-3-仅仅反转字母" class="headerlink" title="12.3.仅仅反转字母"></a>12.3.<a target="_blank" rel="noopener" href="https://leetcode.cn/problems/reverse-only-letters/">仅仅反转字母</a></h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">IsLetter</span><span class="params">(<span class="type">const</span> <span class="type">char</span>&amp; ch)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> ((ch &gt;= <span class="string">&#x27;a&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;z&#x27;</span>)</span><br><span class="line">            || (ch &gt;= <span class="string">&#x27;A&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;Z&#x27;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">string <span class="title">reverseOnlyLetters</span><span class="params">(string str)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">auto</span> begin = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">auto</span> end = str.<span class="built_in">size</span>() - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (begin &lt; end)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">while</span> (!<span class="built_in">IsLetter</span>(str[begin]) &amp;&amp; begin &lt; end)</span><br><span class="line">            &#123;</span><br><span class="line">                begin++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">while</span> (!<span class="built_in">IsLetter</span>(str[end]) &amp;&amp; begin &lt; end)</span><br><span class="line">            &#123;</span><br><span class="line">                end--;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">swap</span>(str[begin], str[end]);</span><br><span class="line">            begin++;</span><br><span class="line">            end--;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> str;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="12-4-字符串最后一个单词的长度"><a href="#12-4-字符串最后一个单词的长度" class="headerlink" title="12.4.字符串最后一个单词的长度"></a>12.4.<a target="_blank" rel="noopener" href="https://www.nowcoder.com/practice/8c949ea5f36f422594b306a2300315da?tpId=37&tqId=21224&ru=/exam/oj">字符串最后一个单词的长度</a></h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//1.输入字符句子</span></span><br><span class="line">    string str;</span><br><span class="line">    <span class="built_in">getline</span>(cin, str);<span class="comment">//hello nowcode</span></span><br><span class="line">    <span class="comment">//2.逆向寻找</span></span><br><span class="line">    <span class="type">size_t</span> index = str.<span class="built_in">rfind</span>(<span class="string">&quot; &quot;</span>);<span class="comment">//得到5</span></span><br><span class="line">    cout &lt;&lt; str.<span class="built_in">size</span>() - index - <span class="number">1</span> &lt;&lt; endl;<span class="comment">//13-5 = 8  </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>但是这么做有些不严谨，再严谨点就是下面代码：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//1.输入字符句子</span></span><br><span class="line">    string str;</span><br><span class="line">    <span class="built_in">getline</span>(cin, str);<span class="comment">//hello nowcode</span></span><br><span class="line">    <span class="comment">//2.逆向寻找</span></span><br><span class="line">    <span class="type">size_t</span> index = str.<span class="built_in">rfind</span>(<span class="string">&quot; &quot;</span>);<span class="comment">//得到5</span></span><br><span class="line">    <span class="keyword">if</span> (index != string::npos)</span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; str.<span class="built_in">size</span>() - index - <span class="number">1</span> &lt;&lt; endl;<span class="comment">//13-5 = 8   </span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; str.<span class="built_in">size</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="12-5-验证回文串"><a href="#12-5-验证回文串" class="headerlink" title="12.5.验证回文串"></a>12.5.<a target="_blank" rel="noopener" href="https://leetcode.cn/problems/valid-palindrome/description/">验证回文串</a></h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">IsLetterAndNumber</span><span class="params">(<span class="type">const</span> <span class="type">char</span>&amp; ch)</span><span class="comment">//判断是否为字符或者数字</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span>((ch &gt;= <span class="string">&#x27;a&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;z&#x27;</span>)</span><br><span class="line">            || (ch &gt;= <span class="string">&#x27;A&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;Z&#x27;</span>)</span><br><span class="line">            || (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">IsOk</span><span class="params">(<span class="type">char</span> x, <span class="type">char</span> y)</span><span class="comment">//判断是否构成回文的特征</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (x == y)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ((x &gt;= <span class="string">&#x27;a&#x27;</span> &amp;&amp; x &lt;= <span class="string">&#x27;z&#x27;</span>) &amp;&amp; (y &gt;= <span class="string">&#x27;A&#x27;</span> &amp;&amp; y &lt;= <span class="string">&#x27;Z&#x27;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (x - <span class="string">&#x27;a&#x27;</span> + <span class="string">&#x27;A&#x27;</span> == y)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ((y &gt;= <span class="string">&#x27;a&#x27;</span> &amp;&amp; x &lt;= <span class="string">&#x27;z&#x27;</span>) &amp;&amp; (x &gt;= <span class="string">&#x27;A&#x27;</span> &amp;&amp; x &lt;= <span class="string">&#x27;Z&#x27;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (y - <span class="string">&#x27;a&#x27;</span> + <span class="string">&#x27;A&#x27;</span> == x)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">isPalindrome</span><span class="params">(string str)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">//1.取得首尾索引</span></span><br><span class="line">        <span class="comment">//str = &quot;A man, a plan, a canal: Panama&quot;</span></span><br><span class="line">        <span class="type">int</span> begin = <span class="number">0</span>;<span class="comment">//s[begin] = &#x27;A&#x27; </span></span><br><span class="line">        <span class="type">int</span> end = str.<span class="built_in">size</span>() - <span class="number">1</span>;<span class="comment">//str[end] = &#x27;a&#x27;</span></span><br><span class="line">        <span class="comment">//2.循环判断回文</span></span><br><span class="line">        <span class="keyword">while</span> (begin &lt; end)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">while</span> (begin &lt; end &amp;&amp; !<span class="built_in">IsLetterAndNumber</span>(str[begin]))</span><br><span class="line">            &#123;</span><br><span class="line">                begin++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">while</span> (begin &lt; end &amp;&amp; !<span class="built_in">IsLetterAndNumber</span>(str[end]))</span><br><span class="line">            &#123;</span><br><span class="line">                end--;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="built_in">IsOk</span>(str[begin], str[end]))<span class="comment">//如果判断出是相同的就返回true</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            begin++;</span><br><span class="line">            end--;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">&lt;i class&#x3D;&quot;fa fa-angle-right&quot;&gt;&lt;&#x2F;i&gt;</a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name"></p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/%20%7C%7C%20archive">
              
                  <span class="site-state-item-count">13</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">limou</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
